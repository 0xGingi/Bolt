var Ft=Object.defineProperty;var Wt=(t,e,n)=>e in t?Ft(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ve=(t,e,n)=>(Wt(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();function O(){}function Vt(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function It(t){return t()}function ft(){return Object.create(null)}function re(t){t.forEach(It)}function jt(t){return typeof t=="function"}function oe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let qe;function Zt(t,e){return t===e?!0:(qe||(qe=document.createElement("a")),qe.href=e,t===qe.href)}function Yt(t){return Object.keys(t).length===0}function Ht(t,...e){if(t==null){for(const r of e)r(void 0);return O}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function K(t){let e;return Ht(t,n=>e=n)(),e}function F(t,e,n){t.$$.on_destroy.push(Ht(e,n))}function I(t,e,n){return t.set(n),e}function h(t,e){t.appendChild(e)}function L(t,e,n){t.insertBefore(e,n||null)}function S(t){t.parentNode&&t.parentNode.removeChild(t)}function He(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function m(t){return document.createElement(t)}function G(t){return document.createTextNode(t)}function M(){return G(" ")}function _e(){return G("")}function j(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function _(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Kt(t){return Array.from(t.childNodes)}function ae(t,e){e=""+e,t.data!==e&&(t.data=e)}function be(t,e){t.value=e??""}function pt(t,e,n){for(let r=0;r<t.options.length;r+=1){const o=t.options[r];if(o.__value===e){o.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Qt(t){const e=t.querySelector(":checked");return e&&e.__value}function en(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}let Ne;function he(t){Ne=t}function Ae(){if(!Ne)throw new Error("Function called outside component initialization");return Ne}function De(t){Ae().$$.on_mount.push(t)}function tn(t){Ae().$$.after_update.push(t)}function rt(t){Ae().$$.on_destroy.push(t)}function nn(){const t=Ae();return(e,n,{cancelable:r=!1}={})=>{const o=t.$$.callbacks[e];if(o){const l=en(e,n,{cancelable:r});return o.slice().forEach(c=>{c.call(t,l)}),!l.defaultPrevented}return!0}}const Pe=[],z=[];let Re=[];const Ke=[],sn=Promise.resolve();let Qe=!1;function rn(){Qe||(Qe=!0,sn.then(ot))}function $e(t){Re.push(t)}function Oe(t){Ke.push(t)}const Ze=new Set;let Ce=0;function ot(){if(Ce!==0)return;const t=Ne;do{try{for(;Ce<Pe.length;){const e=Pe[Ce];Ce++,he(e),on(e.$$)}}catch(e){throw Pe.length=0,Ce=0,e}for(he(null),Pe.length=0,Ce=0;z.length;)z.pop()();for(let e=0;e<Re.length;e+=1){const n=Re[e];Ze.has(n)||(Ze.add(n),n())}Re.length=0}while(Pe.length);for(;Ke.length;)Ke.pop()();Qe=!1,Ze.clear(),he(t)}function on(t){if(t.fragment!==null){t.update(),re(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach($e)}}function ln(t){const e=[],n=[];Re.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Re=e}const Be=new Set;let we;function ve(){we={r:0,c:[],p:we}}function Se(){we.r||re(we.c),we=we.p}function A(t,e){t&&t.i&&(Be.delete(t),t.i(e))}function B(t,e,n,r){if(t&&t.o){if(Be.has(t))return;Be.add(t),we.c.push(()=>{Be.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function Ee(t,e){const n=e.token={};function r(o,l,c,i){if(e.token!==n)return;e.resolved=i;let u=e.ctx;c!==void 0&&(u=u.slice(),u[c]=i);const a=o&&(e.current=o)(u);let d=!1;e.block&&(e.blocks?e.blocks.forEach((f,p)=>{p!==l&&f&&(ve(),B(f,1,1,()=>{e.blocks[p]===f&&(e.blocks[p]=null)}),Se())}):e.block.d(1),a.c(),A(a,1),a.m(e.mount(),e.anchor),d=!0),e.block=a,e.blocks&&(e.blocks[l]=a),d&&ot()}if(Vt(t)){const o=Ae();if(t.then(l=>{he(o),r(e.then,1,e.value,l),he(null)},l=>{if(he(o),r(e.catch,2,e.error,l),he(null),!e.hasCatch)throw l}),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}}function lt(t,e,n){const r=e.slice(),{resolved:o}=t;t.current===t.then&&(r[t.value]=o),t.current===t.catch&&(r[t.error]=o),t.block.p(r,n)}function pe(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Ie(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function ne(t){t&&t.c()}function ee(t,e,n){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,n),$e(()=>{const l=t.$$.on_mount.map(It).filter(jt);t.$$.on_destroy?t.$$.on_destroy.push(...l):re(l),t.$$.on_mount=[]}),o.forEach($e)}function te(t,e){const n=t.$$;n.fragment!==null&&(ln(n.after_update),re(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function cn(t,e){t.$$.dirty[0]===-1&&(Pe.push(t),rn(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function le(t,e,n,r,o,l,c=null,i=[-1]){const u=Ne;he(t);const a=t.$$={fragment:null,ctx:[],props:l,update:O,not_equal:o,bound:ft(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:ft(),dirty:i,skip_bound:!1,root:e.target||u.$$.root};c&&c(a.root);let d=!1;if(a.ctx=n?n(t,e.props||{},(f,p,...k)=>{const b=k.length?k[0]:p;return a.ctx&&o(a.ctx[f],a.ctx[f]=b)&&(!a.skip_bound&&a.bound[f]&&a.bound[f](b),d&&cn(t,f)),p}):[],a.update(),d=!0,re(a.before_update),a.fragment=r?r(a.ctx):!1,e.target){if(e.hydrate){const f=Kt(e.target);a.fragment&&a.fragment.l(f),f.forEach(S)}else a.fragment&&a.fragment.c();e.intro&&A(t.$$.fragment),ee(t,e.target,e.anchor),ot()}he(u)}class ce{constructor(){Ve(this,"$$");Ve(this,"$$set")}$destroy(){te(this,1),this.$destroy=O}$on(e,n){if(!jt(n))return O;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(e){this.$$set&&!Yt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const an="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(an);const Te=[];function At(t,e){return{subscribe:Y(t,e).subscribe}}function Y(t,e=O){let n;const r=new Set;function o(i){if(oe(t,i)&&(t=i,n)){const u=!Te.length;for(const a of r)a[1](),Te.push(a,t);if(u){for(let a=0;a<Te.length;a+=2)Te[a][0](Te[a+1]);Te.length=0}}}function l(i){o(i(t))}function c(i,u=O){const a=[i,u];return r.add(a),r.size===1&&(n=e(o,l)||O),i(t),()=>{r.delete(a),r.size===0&&n&&(n(),n=null)}}return{set:o,update:l,subscribe:c}}function Dt(t){if(t.ok)return t.value;throw t.error}var Q=(t=>(t[t.rs3=0]="rs3",t[t.osrs=1]="osrs",t))(Q||{}),ie=(t=>(t[t.osrs=0]="osrs",t[t.runeLite=1]="runeLite",t[t.hdos=2]="hdos",t[t.rs3=3]="rs3",t))(ie||{});const un={use_dark_theme:!0,flatpak_rich_presence:!1,rs_config_uri:"",runelite_custom_jar:"",runelite_use_custom_jar:!1,selected_account:"",selected_characters:new Map,selected_game_accounts:new Map,selected_game_index:1,selected_client_index:1},Ut=At("https://bolt-internal"),dn=At("1fddee4e-b100-4f4e-b2b0-097f9088f9d2"),ct=Y(),Fe=Y(""),J=Y({...un}),ye=Y(new Map),ge=Y(!1),fe=Y(),et=Y(),Le=Y([]),We=Y({}),it=Y([]),tt=Y(""),nt=Y(""),st=Y(""),Z=Y(!1),Ge=Y(new Map),V=Y({game:Q.osrs,client:ie.runeLite}),Xe=Y(!1);function fn(){se.use_dark_theme==!1&&document.documentElement.classList.remove("dark")}function pn(t,e){e&&t.win.close(),it.update(n=>(n.splice(ut.indexOf(t),1),n))}function qt(){if(de&&de.win&&!de.win.closed)de.win.focus();else if(de&&de.win&&de.win.closed||de){const t=$t(),e=bn();hn({origin:atob(W.origin),redirect:atob(W.redirect),authMethod:"",loginType:"",clientid:atob(W.clientid),flow:"launcher",pkceState:t,pkceCodeVerifier:e}).then(n=>{const r=window.open(n,"","width=480,height=720");We.set({state:t,verifier:e,win:r})})}}function _n(){const t=new URLSearchParams(window.location.search);Fe.set(t.get("platform")),tt.set(t.get("rs3_linux_installed_hash")),nt.set(t.get("runelite_installed_id")),st.set(t.get("hdos_installed_version"));const e=t.get("plugins");e!==null?(ge.set(!0),fe.set(JSON.parse(e))):ge.set(!1);const n=t.get("credentials");if(n)try{JSON.parse(n).forEach(l=>{ye.update(c=>(c.set(l.sub,l),c))})}catch(o){q(`Couldn't parse credentials file: ${o}`,!1)}const r=t.get("config");if(r)try{const o=JSON.parse(r);J.set(o),J.update(l=>(l.selected_game_accounts?(l.selected_characters=new Map(Object.entries(l.selected_game_accounts)),delete l.selected_game_accounts):l.selected_characters&&(l.selected_characters=new Map(Object.entries(l.selected_characters))),l))}catch(o){q(`Couldn't parse config file: ${o}`,!1)}}async function Bt(t,e,n){return new Promise(r=>{if(t.expiry-Date.now()<3e4){const o=new URLSearchParams({grant_type:"refresh_token",client_id:n,refresh_token:t.refresh_token}),l=new XMLHttpRequest;l.onreadystatechange=()=>{if(l.readyState==4)if(l.status==200){const c=Jt(l.response),i=Dt(c);i?(t.access_token=i.access_token,t.expiry=i.expiry,t.id_token=i.id_token,t.login_provider=i.login_provider,t.refresh_token=i.refresh_token,i.session_id&&(t.session_id=i.session_id),t.sub=i.sub,r(null)):r(0)}else r(l.status)},l.onerror=()=>{r(0)},l.open("POST",e,!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.setRequestHeader("Accept","application/json"),l.send(o)}else r(null)})}function Jt(t){const e=JSON.parse(t),n=e.id_token.split(".");if(n.length!==3){const l=`Malformed id_token: ${n.length} sections, expected 3`;return q(l,!1),{ok:!1,error:new Error(l)}}const r=JSON.parse(atob(n[0]));if(r.typ!=="JWT"){const l=`Bad id_token header: typ ${r.typ}, expected JWT`;return q(l,!1),{ok:!1,error:new Error(l)}}const o=JSON.parse(atob(n[1]));return{ok:!0,value:{access_token:e.access_token,id_token:e.id_token,refresh_token:e.refresh_token,sub:o.sub,login_provider:o.login_provider||null,expiry:Date.now()+e.expires_in*1e3,session_id:e.session_id}}}async function hn(t){const e=new TextEncoder().encode(t.pkceCodeVerifier),n=await crypto.subtle.digest("SHA-256",e);let r="";const o=new Uint8Array(n);for(let c=0;c<o.byteLength;c++)r+=String.fromCharCode(o[c]);const l=btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return t.origin.concat("/oauth2/auth?").concat(new URLSearchParams({auth_method:t.authMethod,login_type:t.loginType,flow:t.flow,response_type:"code",client_id:t.clientid,redirect_uri:t.redirect,code_challenge:l,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:t.pkceState}).toString())}function bn(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",e=new Uint32Array(43);return crypto.getRandomValues(e),Array.from(e,function(n){return t[n%t.length]}).join("")}function $t(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",n=e.length-1,r=crypto.getRandomValues(new Uint8Array(12));return Array.from(r).map(o=>Math.round(o*(n-0)/255+0)).map(o=>e[o]).join("")}async function Gt(t,e,n){return new Promise(r=>{const o=new XMLHttpRequest;o.onreadystatechange=()=>{o.readyState==4&&(o.status==200?n.then(l=>{if(typeof l!="number"){const c={id:l.id,userId:l.userId,displayName:l.displayName,suffix:l.suffix,characters:new Map};$(`Successfully added login for ${c.displayName}`),JSON.parse(o.response).forEach(i=>{c.characters.set(i.accountId,{accountId:i.accountId,displayName:i.displayName,userHash:i.userHash})}),kn(c),r(!0)}else q(`Error getting account info: ${l}`,!1),r(!1)}):(q(`Error: from ${e}: ${o.status}: ${o.response}`,!1),r(!1)))},o.open("GET",e,!0),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Authorization","Bearer ".concat(t.session_id)),o.send()})}async function _t(t,e){return await gn(t,e)}async function gn(t,e){const n=$t(),r=crypto.randomUUID(),o=atob(W.origin).concat("/oauth2/auth?").concat(new URLSearchParams({id_token_hint:e.id_token,nonce:btoa(r),prompt:"consent",redirect_uri:"http://localhost",response_type:"id_token code",state:n,client_id:K(dn),scope:"openid offline"}).toString()),l=mn(e);return t?(t.location.href=o,it.update(c=>(c.push({state:n,nonce:r,creds:e,win:t,account_info_promise:l}),c)),!1):e.session_id?await Gt(e,atob(W.auth_api).concat("/accounts"),l):(q("Rejecting stored credentials with missing session_id",!1),!1)}function mn(t){return new Promise(e=>{const n=`${atob(W.api)}/users/${t.sub}/displayName`,r=new XMLHttpRequest;r.onreadystatechange=()=>{r.readyState==4&&(r.status==200?e(JSON.parse(r.response)):e(r.status))},r.open("GET",n,!0),r.setRequestHeader("Authorization","Bearer ".concat(t.access_token)),r.send()})}function kn(t){const e=()=>{V.update(n=>{n.account=t;const[r]=t.characters.keys();return n.character=t.characters.get(r),ke.size>0&&(n.credentials=ke.get(t.userId)),n})};Ge.update(n=>(n.set(t.userId,t),n)),ze.account&&se.selected_account?t.userId==se.selected_account&&e():ze.account||e(),We.set({})}function wn(t,e,n){return new Promise(r=>{const o=new XMLHttpRequest;o.open("POST",e,!0),o.onreadystatechange=()=>{o.readyState==4&&r(o.status)},o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(new URLSearchParams({token:t,client_id:n}))})}async function Me(){const t=new XMLHttpRequest;t.open("POST","/save-credentials",!0),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=()=>{t.readyState==4&&$(`Save-credentials status: ${t.responseText.trim()}`)},V.update(n=>{var r;return n.credentials=ke.get((r=ze.account)==null?void 0:r.userId),n});const e=[];ke.forEach(n=>{e.push(n)}),t.send(JSON.stringify(e))}function yn(t,e,n){Ue();const r=(i,u)=>{const a=new XMLHttpRequest,d={};i&&(d.hash=i),t&&(d.jx_session_id=t),e&&(d.jx_character_id=e),n&&(d.jx_display_name=n),se.rs_plugin_loader&&(d.plugin_loader="1"),se.rs_config_uri?d.config_uri=se.rs_config_uri:d.config_uri=atob(W.default_config_uri),a.open("POST","/launch-rs3-deb?".concat(new URLSearchParams(d).toString()),!0),a.onreadystatechange=()=>{a.readyState==4&&($(`Game launch status: '${a.responseText.trim()}'`),a.status==200&&i&&tt.set(i))},a.send(u)},o=new XMLHttpRequest,l=atob(W.content_url),c=l.concat("dists/trusty/non-free/binary-amd64/Packages");o.open("GET",c,!0),o.onreadystatechange=()=>{if(o.readyState==4&&o.status==200){const i=Object.fromEntries(o.response.split(`
`).map(u=>u.split(": ")));if(!i.Filename||!i.Size){q(`Could not parse package data from URL: ${c}`,!1),r();return}if(i.SHA256!==K(tt)){$("Downloading RS3 client...");const u=new XMLHttpRequest;u.open("GET",l.concat(i.Filename),!0),u.responseType="arraybuffer",u.onprogress=a=>{a.loaded&&Le.update(d=>(d[0].text=`Downloading RS3 client... ${(Math.round(1e3*a.loaded/a.total)/10).toFixed(1)}%`,d))},u.onreadystatechange=()=>{u.readyState==4&&u.status==200&&r(i.SHA256,u.response)},u.onerror=()=>{q(`Error downloading game client: from ${c}: non-http error`,!1),r()},u.send()}else $("Latest client is already installed"),r()}},o.onerror=()=>{q(`Error: from ${c}: non-http error`,!1),r()},o.send()}function Xt(t,e,n,r){Ue();const o=r?"/launch-runelite-jar-configure?":"/launch-runelite-jar?",l=(u,a,d)=>{const f=new XMLHttpRequest,p={};u&&(p.id=u),d&&(p.jar_path=d),t&&(p.jx_session_id=t),e&&(p.jx_character_id=e),n&&(p.jx_display_name=n),se.flatpak_rich_presence&&(p.flatpak_rich_presence=""),f.open(a?"POST":"GET",o.concat(new URLSearchParams(p).toString()),!0),f.onreadystatechange=()=>{f.readyState==4&&($(`Game launch status: '${f.responseText.trim()}'`),f.status==200&&u&&nt.set(u))},f.send(a)};if(se.runelite_use_custom_jar){l(null,null,se.runelite_custom_jar);return}const c=new XMLHttpRequest,i="https://api.github.com/repos/runelite/launcher/releases";c.open("GET",i,!0),c.onreadystatechange=()=>{if(c.readyState==4)if(c.status==200){const u=JSON.parse(c.responseText).map(a=>a.assets).flat().find(a=>a.name.toLowerCase()=="runelite.jar");if(u.id!=K(nt)){$("Downloading RuneLite...");const a=new XMLHttpRequest;a.open("GET",u.browser_download_url,!0),a.responseType="arraybuffer",a.onreadystatechange=()=>{a.readyState==4&&(a.status==200?l(u.id,a.response):q(`Error downloading from ${u.url}: ${a.status}: ${a.responseText}`,!1))},a.onprogress=d=>{d.loaded&&d.lengthComputable&&Le.update(f=>(f[0].text=`Downloading RuneLite... ${(Math.round(1e3*d.loaded/d.total)/10).toFixed(1)}%`,f))},a.send()}else $("Latest JAR is already installed"),l()}else q(`Error from ${i}: ${c.status}: ${c.responseText}`,!1)},c.send()}function vn(t,e,n){return Xt(t,e,n,!1)}function Sn(t,e,n){return Xt(t,e,n,!0)}function Ln(t,e,n){Ue();const r=(c,i)=>{const u=new XMLHttpRequest,a={};c&&(a.version=c),t&&(a.jx_session_id=t),e&&(a.jx_character_id=e),n&&(a.jx_display_name=n),u.open("POST","/launch-hdos-jar?".concat(new URLSearchParams(a).toString()),!0),u.onreadystatechange=()=>{u.readyState==4&&($(`Game launch status: '${u.responseText.trim()}'`),u.status==200&&c&&st.set(c))},u.send(i)},o=new XMLHttpRequest,l="https://cdn.hdos.dev/client/getdown.txt";o.open("GET",l,!0),o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const c=o.responseText.match(/^launcher\.version *= *(.*?)$/m);if(c&&c.length>=2){const i=c[1];if(i!==K(st)){const u=`https://cdn.hdos.dev/launcher/v${i}/hdos-launcher.jar`;$("Downloading HDOS...");const a=new XMLHttpRequest;a.open("GET",u,!0),a.responseType="arraybuffer",a.onreadystatechange=()=>{if(a.readyState==4)if(a.status==200)r(i,a.response);else{const d=JSON.parse(o.responseText).map(f=>f.assets).flat().find(f=>f.name.toLowerCase()=="runelite.jar");q(`Error downloading from ${d.url}: ${a.status}: ${a.responseText}`,!1)}},a.onprogress=d=>{d.loaded&&d.lengthComputable&&Le.update(f=>(f[0].text=`Downloading HDOS... ${(Math.round(1e3*d.loaded/d.total)/10).toFixed(1)}%`,f))},a.send()}else $("Latest JAR is already installed"),r()}else $("Couldn't parse latest launcher version"),r()}else q(`Error from ${l}: ${o.status}: ${o.responseText}`,!1)},o.send()}let Ye=!1;function Ue(){var t;if(K(Z)&&!Ye){Ye=!0;const e=new XMLHttpRequest;e.open("POST","/save-config",!0),e.onreadystatechange=()=>{e.readyState==4&&($(`Save config status: '${e.responseText.trim()}'`),e.status==200&&Z.set(!1),Ye=!1)},e.setRequestHeader("Content-Type","application/json");const n={};(t=se.selected_characters)==null||t.forEach((l,c)=>{n[c]=l});const r={};Object.assign(r,se),r.selected_characters=n;const o=JSON.stringify(r,null,4);e.send(o)}}function zt(){return new Promise((t,e)=>{const n=new XMLHttpRequest,r=K(Ut).concat("/list-game-clients");n.open("GET",r,!0),n.onreadystatechange=()=>{if(n.readyState==4)if(n.status==200&&n.getResponseHeader("content-type")==="application/json"){const o=JSON.parse(n.responseText);t(Object.keys(o).map(l=>({uid:l,identity:o[l].identity||null})))}else e(`error (${n.responseText})`)},n.send()})}function xn(){const t=new XMLHttpRequest;t.open("POST","/save-plugin-config",!0),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=()=>{t.readyState==4&&$(`Save-plugin-config status: ${t.responseText.trim()}`)},t.send(JSON.stringify(K(fe)))}async function ht(t,e,n,r,o){Ue();const l=`${e?"osrs":atob(W.provider)}-${t?"win":"mac"}`,c=async(T,D)=>{const C={};T&&(C.hash=T),n&&(C.jx_session_id=n),r&&(C.jx_character_id=r),o&&(C.jx_display_name=o);const g=await fetch(`/launch-${e?"osrs":"rs3"}-${t?"exe":"app"}?${new URLSearchParams(C).toString()}`,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:D});g.text().then(P=>$(`Game launch status: '${P.trim()}'`)),g.status==200},i=`${atob(W.direct6_url)}${l}/${l}.json`,u=await fetch(i,{method:"GET"}),a=await u.text();if(u.status!==200){q(`Error from ${i}: ${u.status}: ${a}`,!1);return}const d=JSON.parse(atob(a.split(".")[1])).environments.production,f=`${atob(W.direct6_url)}${l}/catalog/${d.id}/catalog.json`,p=await fetch(f,{method:"GET"}),k=await p.text();if(p.status!==200){q(`Error from ${f}: ${p.status}: ${k}`,!1);return}const b=JSON.parse(atob(k.split(".")[1])),E=b.metafile.replace(/^http:/i,"https:"),N=await fetch(E,{method:"GET"}),v=await N.text();if(N.status!==200){q(`Error from ${E}: ${N.status}: ${v}`,!1);return}const y=JSON.parse(atob(v.split(".")[1])),w=y.pieces.digests.map(T=>{const D=atob(T).split("").map(g=>g.charCodeAt(0).toString(16).padStart(2,"0")).join(""),C=b.config.remote.baseUrl.replace(/^http:/i,"https:").concat(b.config.remote.pieceFormat.replace("{SubString:0,2,{TargetDigest}}",D.substring(0,2)).replace("{TargetDigest}",D));return fetch(C,{method:"GET"}).then(g=>g.blob().then(P=>{const U=new DecompressionStream("gzip");return new Response(P.slice(6).stream().pipeThrough(U)).blob()}))});let x=0,R=null;for(let T=0;T<y.files.length;T+=1)if(t?y.files[T].name.endsWith(".exe"):y.files[T].name.includes(".app/Contents/MacOS/"))if(R!==null){q(`Error parsing ${E}: file list has multiple possibilities for main exe`,!1);return}else R=y.files[T].size;else R===null&&(x+=y.files[T].size);if(R===null){q(`Error parsing ${E}: file list has no possibilities for main exe`,!1);return}Promise.all(w).then(T=>{const D=new Blob(T).slice(x,x+R);c(y.id,D)})}function bt(t,e,n){const r=t.slice();return r[22]=e[n],r}function gt(t){let e,n=t[22][1].displayName+"",r,o,l;return{c(){e=m("option"),r=G(n),_(e,"data-id",o=t[22][1].userId),_(e,"class","dark:bg-slate-900"),e.__value=l=t[22][1].displayName,be(e,e.__value)},m(c,i){L(c,e,i),h(e,r)},p(c,i){i&4&&n!==(n=c[22][1].displayName+"")&&ae(r,n),i&4&&o!==(o=c[22][1].userId)&&_(e,"data-id",o),i&4&&l!==(l=c[22][1].displayName)&&(e.__value=l,be(e,e.__value))},d(c){c&&S(e)}}}function Cn(t){let e,n,r,o,l,c,i,u,a,d=pe(t[2]),f=[];for(let p=0;p<d.length;p+=1)f[p]=gt(bt(t,d,p));return{c(){e=m("div"),n=m("select");for(let p=0;p<f.length;p+=1)f[p].c();r=M(),o=m("div"),l=m("button"),l.textContent="Log In",c=M(),i=m("button"),i.textContent="Log Out",_(n,"name","account_select"),_(n,"id","account_select"),_(n,"class","w-full cursor-pointer rounded-lg border-2 border-inherit bg-inherit p-2 text-center"),_(l,"class","mx-auto mr-2 rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),_(i,"class","mx-auto rounded-lg border-2 border-blue-500 p-2 font-bold duration-200 hover:opacity-75"),_(o,"class","mt-5 flex"),_(e,"class","z-10 w-48 rounded-lg border-2 border-slate-300 bg-slate-100 p-3 shadow dark:border-slate-800 dark:bg-slate-900"),_(e,"role","none")},m(p,k){L(p,e,k),h(e,n);for(let b=0;b<f.length;b+=1)f[b]&&f[b].m(n,null);t[7](n),h(e,r),h(e,o),h(o,l),h(o,c),h(o,i),u||(a=[j(n,"change",t[8]),j(l,"click",t[9]),j(i,"click",t[10]),j(e,"mouseenter",t[11]),j(e,"mouseleave",t[12])],u=!0)},p(p,[k]){if(k&4){d=pe(p[2]);let b;for(b=0;b<d.length;b+=1){const E=bt(p,d,b);f[b]?f[b].p(E,k):(f[b]=gt(E),f[b].c(),f[b].m(n,null))}for(;b<f.length;b+=1)f[b].d(1);f.length=d.length}},i:O,o:O,d(p){p&&S(e),He(f,p),t[7](null),u=!1,re(a)}}}function Tn(t,e,n){let r,o,l,c;F(t,V,g=>n(13,r=g)),F(t,ye,g=>n(14,o=g)),F(t,Ge,g=>n(2,l=g)),F(t,J,g=>n(15,c=g));let{showAccountDropdown:i}=e,{hoverAccountButton:u}=e;const a=atob(W.origin),d=atob(W.clientid),f=a.concat("/oauth2/token"),p=a.concat("/oauth2/revoke");let k=!1,b;function E(g){u||g.button===0&&i&&!k&&n(5,i=!1)}function N(){var U;if(b.options.length==0){$("Logout unsuccessful: no account selected");return}let g=r.credentials;r.account&&(l.delete((U=r.account)==null?void 0:U.userId),Ge.set(l));const P=b.selectedIndex;P>0?n(1,b.selectedIndex=P-1,b):P==0&&l.size>0?n(1,b.selectedIndex=P+1,b):(delete r.account,delete r.character,delete r.credentials),y(),g&&Bt(g,f,d).then(H=>{H===null?wn(g.access_token,p,d).then(X=>{X===200?($("Successful logout"),v(g)):q(`Logout unsuccessful: status ${X}`,!1)}):H===400||H===401?($("Logout unsuccessful: credentials are invalid, so discarding them anyway"),g&&v(g)):q("Logout unsuccessful: unable to verify credentials due to a network error",!1)})}function v(g){o.delete(g.sub),Me()}function y(){var P;Z.set(!0);const g=b[b.selectedIndex].getAttribute("data-id");if(I(V,r.account=l.get(g),r),I(J,c.selected_account=g,c),I(V,r.credentials=o.get((P=r.account)==null?void 0:P.userId),r),r.account&&r.account.characters){const U=document.getElementById("character_select");U.selectedIndex=0;const[H]=r.account.characters.keys();I(V,r.character=r.account.characters.get(H),r)}}addEventListener("mousedown",E),De(()=>{var P;let g=0;l.forEach(U=>{var H;U.displayName==((H=r.account)==null?void 0:H.displayName)&&n(1,b.selectedIndex=g,b),g++}),I(V,r.credentials=o.get((P=r.account)==null?void 0:P.userId),r)}),rt(()=>{removeEventListener("mousedown",E)});function w(g){z[g?"unshift":"push"](()=>{b=g,n(1,b)})}const x=()=>{y()},R=()=>{qt()},T=()=>{N()},D=()=>{n(0,k=!0)},C=()=>{n(0,k=!1)};return t.$$set=g=>{"showAccountDropdown"in g&&n(5,i=g.showAccountDropdown),"hoverAccountButton"in g&&n(6,u=g.hoverAccountButton)},[k,b,l,N,y,i,u,w,x,R,T,D,C]}class Pn extends ce{constructor(e){super(),le(this,e,Tn,Cn,oe,{showAccountDropdown:5,hoverAccountButton:6})}}function Rn(t){let e;return{c(){e=G("Log In")},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function En(t){var r;let e=((r=t[6].account)==null?void 0:r.displayName)+"",n;return{c(){n=G(e)},m(o,l){L(o,n,l)},p(o,l){var c;l&64&&e!==(e=((c=o[6].account)==null?void 0:c.displayName)+"")&&ae(n,e)},d(o){o&&S(n)}}}function mt(t){let e,n,r,o;function l(i){t[20](i)}let c={hoverAccountButton:t[2]};return t[1]!==void 0&&(c.showAccountDropdown=t[1]),n=new Pn({props:c}),z.push(()=>Ie(n,"showAccountDropdown",l)),{c(){e=m("div"),ne(n.$$.fragment),_(e,"class","absolute right-2 top-[72px]")},m(i,u){L(i,e,u),ee(n,e,null),o=!0},p(i,u){const a={};u&4&&(a.hoverAccountButton=i[2]),!r&&u&2&&(r=!0,a.showAccountDropdown=i[1],Oe(()=>r=!1)),n.$set(a)},i(i){o||(A(n.$$.fragment,i),o=!0)},o(i){B(n.$$.fragment,i),o=!1},d(i){i&&S(e),te(n)}}}function Mn(t){let e,n,r,o,l,c,i,u,a,d,f,p,k,b,E,N;function v(R,T){return R[6].account?En:Rn}let y=v(t),w=y(t),x=t[1]&&mt(t);return{c(){e=m("div"),n=m("div"),r=m("button"),r.textContent="RS3",o=M(),l=m("button"),l.textContent="OSRS",c=M(),i=m("div"),u=m("button"),u.innerHTML='<img src="svgs/lightbulb-solid.svg" class="h-6 w-6" alt="Change Theme"/>',a=M(),d=m("button"),d.innerHTML='<img src="svgs/gear-solid.svg" class="h-6 w-6" alt="Settings"/>',f=M(),p=m("button"),w.c(),k=M(),x&&x.c(),_(r,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75"),_(l,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 bg-blue-500 p-2 text-black duration-200 hover:opacity-75"),_(n,"class","m-3 ml-9 font-bold"),_(u,"class","my-3 h-10 w-10 rounded-full bg-blue-500 p-2 duration-200 hover:rotate-45 hover:opacity-75"),_(d,"class","m-3 h-10 w-10 rounded-full bg-blue-500 p-2 duration-200 hover:rotate-45 hover:opacity-75"),_(p,"class","m-2 w-48 rounded-lg border-2 border-slate-300 bg-inherit p-2 text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50"),_(i,"class","ml-auto flex"),_(e,"class","fixed top-0 flex h-16 w-screen border-b-2 border-slate-300 bg-slate-100 duration-200 dark:border-slate-800 dark:bg-slate-900")},m(R,T){L(R,e,T),h(e,n),h(n,r),t[10](r),h(n,o),h(n,l),t[12](l),h(e,c),h(e,i),h(i,u),h(i,a),h(i,d),h(i,f),h(i,p),w.m(p,null),t[16](p),h(e,k),x&&x.m(e,null),b=!0,E||(N=[j(r,"click",t[11]),j(l,"click",t[13]),j(u,"click",t[14]),j(d,"click",t[15]),j(p,"mouseenter",t[17]),j(p,"mouseleave",t[18]),j(p,"click",t[19])],E=!0)},p(R,[T]){y===(y=v(R))&&w?w.p(R,T):(w.d(1),w=y(R),w&&(w.c(),w.m(p,null))),R[1]?x?(x.p(R,T),T&2&&A(x,1)):(x=mt(R),x.c(),A(x,1),x.m(e,null)):x&&(ve(),B(x,1,1,()=>{x=null}),Se())},i(R){b||(A(x),b=!0)},o(R){B(x),b=!1},d(R){R&&S(e),t[10](null),t[12](null),w.d(),t[16](null),x&&x.d(),E=!1,re(N)}}}function Nn(t,e,n){let r,o,l;F(t,J,P=>n(21,r=P)),F(t,Z,P=>n(22,o=P)),F(t,V,P=>n(6,l=P));let{showSettings:c}=e,i=!1,u=!1,a,d,f;function p(){let P=document.documentElement;P.classList.contains("dark")?P.classList.remove("dark"):P.classList.add("dark"),I(J,r.use_dark_theme=!r.use_dark_theme,r),I(Z,o=!0,o)}function k(P){switch(P){case Q.osrs:I(V,l.game=Q.osrs,l),I(V,l.client=r.selected_client_index,l),I(J,r.selected_game_index=Q.osrs,r),I(Z,o=!0,o),d.classList.add("bg-blue-500","text-black"),a.classList.remove("bg-blue-500","text-black");break;case Q.rs3:I(V,l.game=Q.rs3,l),I(J,r.selected_game_index=Q.rs3,r),I(Z,o=!0,o),d.classList.remove("bg-blue-500","text-black"),a.classList.add("bg-blue-500","text-black");break}}function b(){if(f.innerHTML=="Log In"){qt();return}n(1,i=!i)}De(()=>{k(r.selected_game_index)});function E(P){z[P?"unshift":"push"](()=>{a=P,n(3,a)})}const N=()=>{k(Q.rs3)};function v(P){z[P?"unshift":"push"](()=>{d=P,n(4,d)})}const y=()=>{k(Q.osrs)},w=()=>p(),x=()=>{n(0,c=!0)};function R(P){z[P?"unshift":"push"](()=>{f=P,n(5,f)})}const T=()=>{n(2,u=!0)},D=()=>{n(2,u=!1)},C=()=>b();function g(P){i=P,n(1,i)}return t.$$set=P=>{"showSettings"in P&&n(0,c=P.showSettings)},[c,i,u,a,d,f,l,p,k,b,E,N,v,y,w,x,R,T,D,C,g]}class On extends ce{constructor(e){super(),le(this,e,Nn,Mn,oe,{showSettings:0})}}function In(t){let e,n,r,o,l,c;return{c(){e=m("div"),n=m("div"),r=M(),o=m("div"),_(n,"class","absolute left-0 top-0 z-10 h-screen w-screen backdrop-blur-sm backdrop-filter"),_(o,"class","absolute left-0 top-0 z-10 h-screen w-screen bg-black opacity-75"),_(o,"role","none")},m(i,u){L(i,e,u),h(e,n),h(e,r),h(e,o),l||(c=j(o,"click",t[1]),l=!0)},p:O,i:O,o:O,d(i){i&&S(e),l=!1,c()}}}function jn(t){const e=nn();return[e,r=>{e("click",r)}]}class at extends ce{constructor(e){super(),le(this,e,jn,In,oe,{})}}function Hn(t){let e,n,r,o,l,c,i,u,a,d,f,p;return n=new at({}),{c(){e=m("div"),ne(n.$$.fragment),r=M(),o=m("div"),l=m("p"),l.textContent=`${t[1]}`,c=M(),i=m("p"),i.textContent=`${t[2]}`,u=M(),a=m("button"),a.textContent="I Understand",_(l,"class","p-2"),_(i,"class","p-2"),_(a,"class","m-5 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75"),_(o,"class","absolute left-1/4 top-1/4 z-20 w-1/2 rounded-lg bg-slate-100 p-5 text-center shadow-lg dark:bg-slate-900"),_(e,"id","disclaimer")},m(k,b){L(k,e,b),ee(n,e,null),h(e,r),h(e,o),h(o,l),h(o,c),h(o,i),h(o,u),h(o,a),d=!0,f||(p=j(a,"click",t[3]),f=!0)},p:O,i(k){d||(A(n.$$.fragment,k),d=!0)},o(k){B(n.$$.fragment,k),d=!1},d(k){k&&S(e),te(n),f=!1,p()}}}function An(t,e,n){let r;F(t,Xe,i=>n(0,r=i));const o=atob("Qm9sdCBpcyBhbiB1bm9mZmljaWFsIHRoaXJkLXBhcnR5IGxhdW5jaGVyLiBJdCdzIGZyZWUgYW5kIG9wZW4tc291cmNlIHNvZnR3YXJlIGxpY2Vuc2VkIHVuZGVyIEFHUEwgMy4wLg=="),l=atob("SmFnZXggaXMgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgcHJvYmxlbXMgb3IgZGFtYWdlIGNhdXNlZCBieSB1c2luZyB0aGlzIHByb2R1Y3Qu");return[r,o,l,()=>{I(Xe,r=!1,r)}]}class Dn extends ce{constructor(e){super(),le(this,e,An,Hn,oe,{})}}function Un(t){let e,n,r,o;return{c(){e=m("div"),n=m("button"),n.innerHTML=`<div class="flex"><img src="svgs/database-solid.svg" alt="Browse app data" class="mr-2 h-7 w-7 rounded-lg bg-violet-500 p-1"/>
			Browse App Data</div>`,_(n,"id","data_dir_button"),_(n,"class","p-2 hover:opacity-75"),_(e,"id","general_options"),_(e,"class","col-span-3 p-5 pt-10")},m(l,c){L(l,e,c),h(e,n),r||(o=j(n,"click",t[1]),r=!0)},p:O,i:O,o:O,d(l){l&&S(e),r=!1,o()}}}function qn(t){function e(){var r=new XMLHttpRequest;r.open("GET","/browse-data"),r.onreadystatechange=()=>{r.readyState==4&&$(`Browse status: '${r.responseText.trim()}'`)},r.send()}return[e,()=>{e()}]}class Bn extends ce{constructor(e){super(),le(this,e,qn,Un,oe,{})}}function Jn(t){let e,n,r,o,l,c,i,u,a,d,f,p,k,b,E,N;return{c(){e=m("div"),n=m("button"),n.innerHTML=`<div class="flex"><img src="svgs/wrench-solid.svg" alt="Configure RuneLite" class="mr-2 h-7 w-7 rounded-lg bg-pink-500 p-1"/>
			Configure RuneLite</div>`,r=M(),o=m("div"),l=m("label"),l.textContent="Use custom RuneLite JAR:",c=M(),i=m("input"),u=M(),a=m("div"),d=m("textarea"),f=M(),p=m("br"),k=M(),b=m("button"),b.textContent="Select File",_(n,"id","rl_configure"),_(n,"class","p-2 pb-5 hover:opacity-75"),_(l,"for","use_custom_jar"),_(i,"type","checkbox"),_(i,"name","use_custom_jar"),_(i,"id","use_custom_jar"),_(i,"class","ml-2"),_(o,"class","mx-auto border-t-2 border-slate-300 p-2 pt-5 dark:border-slate-800"),d.disabled=!0,_(d,"name","custom_jar_file"),_(d,"id","custom_jar_file"),_(d,"class","h-10 rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),b.disabled=!0,_(b,"id","custom_jar_file_button"),_(b,"class","mt-1 rounded-lg border-2 border-blue-500 p-1 duration-200 hover:opacity-75"),_(a,"id","custom_jar_div"),_(a,"class","mx-auto p-2 opacity-25"),_(e,"id","osrs_options"),_(e,"class","col-span-3 p-5 pt-10")},m(v,y){L(v,e,y),h(e,n),h(e,r),h(e,o),h(o,l),h(o,c),h(o,i),t[9](i),h(e,u),h(e,a),h(a,d),t[11](d),h(a,f),h(a,p),h(a,k),h(a,b),t[13](b),t[15](a),E||(N=[j(n,"click",t[8]),j(i,"change",t[10]),j(d,"change",t[12]),j(b,"click",t[14])],E=!0)},p:O,i:O,o:O,d(v){v&&S(e),t[9](null),t[11](null),t[13](null),t[15](null),E=!1,re(N)}}}function $n(t,e,n){let r,o,l;F(t,J,T=>n(16,r=T)),F(t,V,T=>n(17,o=T)),F(t,Z,T=>n(18,l=T));let c,i,u,a;function d(){c.classList.toggle("opacity-25"),n(1,i.disabled=!i.disabled,i),n(2,u.disabled=!u.disabled,u),I(J,r.runelite_use_custom_jar=a.checked,r),r.runelite_use_custom_jar?i.value&&I(J,r.runelite_custom_jar=i.value,r):(n(1,i.value="",i),I(J,r.runelite_custom_jar="",r),I(J,r.runelite_use_custom_jar=!1,r)),I(Z,l=!0,l)}function f(){I(J,r.runelite_custom_jar=i.value,r),I(Z,l=!0,l)}function p(){n(3,a.disabled=!0,a),n(2,u.disabled=!0,u);var T=new XMLHttpRequest;T.onreadystatechange=()=>{T.readyState==4&&(T.status==200&&(n(1,i.value=T.responseText,i),I(J,r.runelite_custom_jar=T.responseText,r),I(Z,l=!0,l)),n(2,u.disabled=!1,u),n(3,a.disabled=!1,a))},T.open("GET","/jar-file-picker",!0),T.send()}function k(){var T,D,C;if(!o.account||!o.character){$("Please log in to configure RuneLite");return}Sn((T=o.credentials)==null?void 0:T.session_id,(D=o.character)==null?void 0:D.accountId,(C=o.character)==null?void 0:C.displayName)}De(()=>{n(3,a.checked=r.runelite_use_custom_jar,a),a.checked&&r.runelite_custom_jar?(c.classList.remove("opacity-25"),n(1,i.disabled=!1,i),n(2,u.disabled=!1,u),n(1,i.value=r.runelite_custom_jar,i)):(n(3,a.checked=!1,a),I(J,r.runelite_use_custom_jar=!1,r))});const b=()=>k();function E(T){z[T?"unshift":"push"](()=>{a=T,n(3,a)})}const N=()=>{d()};function v(T){z[T?"unshift":"push"](()=>{i=T,n(1,i)})}const y=()=>{f()};function w(T){z[T?"unshift":"push"](()=>{u=T,n(2,u)})}const x=()=>{p()};function R(T){z[T?"unshift":"push"](()=>{c=T,n(0,c)})}return[c,i,u,a,d,f,p,k,b,E,N,v,y,w,x,R]}class Gn extends ce{constructor(e){super(),le(this,e,$n,Jn,oe,{})}}function Xn(t){let e,n,r,o,l,c;return{c(){e=m("div"),n=m("label"),n.textContent="Enable Bolt plugin loader:",r=M(),o=m("input"),_(n,"for","enable_plugins"),_(o,"type","checkbox"),_(o,"name","enable_plugins"),_(o,"id","enable_plugins"),_(o,"class","ml-2"),_(e,"class","mx-auto p-2")},m(i,u){L(i,e,u),h(e,n),h(e,r),h(e,o),o.checked=t[3].rs_plugin_loader,l||(c=[j(o,"change",t[6]),j(o,"change",t[7])],l=!0)},p(i,u){u&8&&(o.checked=i[3].rs_plugin_loader)},d(i){i&&S(e),l=!1,re(c)}}}function zn(t){let e,n,r,o,l,c,i,u,a,d,f,p=ge&&Xn(t);return{c(){e=m("div"),p&&p.c(),n=M(),r=m("div"),o=m("label"),o.textContent="Use custom config URI:",l=M(),c=m("input"),i=M(),u=m("div"),a=m("textarea"),_(o,"for","use_custom_uri"),_(c,"type","checkbox"),_(c,"name","use_custom_uri"),_(c,"id","use_custom_uri"),_(c,"class","ml-2"),_(r,"class","mx-auto p-2"),a.disabled=!0,_(a,"name","config_uri_address"),_(a,"id","config_uri_address"),_(a,"rows","4"),_(a,"class","rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),a.value="		",_(u,"id","config_uri_div"),_(u,"class","mx-auto p-2 opacity-25"),_(e,"id","rs3_options"),_(e,"class","col-span-3 p-5 pt-10")},m(k,b){L(k,e,b),p&&p.m(e,null),h(e,n),h(e,r),h(r,o),h(r,l),h(r,c),t[8](c),h(e,i),h(e,u),h(u,a),t[11](a),t[12](u),d||(f=[j(c,"change",t[9]),j(a,"change",t[10])],d=!0)},p(k,[b]){ge&&p.p(k,b)},i:O,o:O,d(k){k&&S(e),p&&p.d(),t[8](null),t[11](null),t[12](null),d=!1,re(f)}}}function Fn(t,e,n){let r,o,l;F(t,ct,y=>n(13,r=y)),F(t,J,y=>n(3,o=y)),F(t,Z,y=>n(14,l=y));let c,i,u;function a(){c.classList.toggle("opacity-25"),n(1,i.disabled=!i.disabled,i),I(Z,l=!0,l),u.checked||(n(1,i.value=atob(r.default_config_uri),i),I(J,o.rs_config_uri="",o))}function d(){I(J,o.rs_config_uri=i.value,o),I(Z,l=!0,l)}De(()=>{o.rs_config_uri?(n(1,i.value=o.rs_config_uri,i),n(2,u.checked=!0,u),a()):n(1,i.value=atob(r.default_config_uri),i)});function f(){o.rs_plugin_loader=this.checked,J.set(o)}const p=()=>Z.set(!0);function k(y){z[y?"unshift":"push"](()=>{u=y,n(2,u)})}const b=()=>{a()},E=()=>{d()};function N(y){z[y?"unshift":"push"](()=>{i=y,n(1,i)})}function v(y){z[y?"unshift":"push"](()=>{c=y,n(0,c)})}return[c,i,u,o,a,d,f,p,k,b,E,N,v]}class Wn extends ce{constructor(e){super(),le(this,e,Fn,zn,oe,{})}}function Vn(t){let e,n;return e=new Wn({}),{c(){ne(e.$$.fragment)},m(r,o){ee(e,r,o),n=!0},i(r){n||(A(e.$$.fragment,r),n=!0)},o(r){B(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function Zn(t){let e,n;return e=new Gn({}),{c(){ne(e.$$.fragment)},m(r,o){ee(e,r,o),n=!0},i(r){n||(A(e.$$.fragment,r),n=!0)},o(r){B(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function Yn(t){let e,n;return e=new Bn({}),{c(){ne(e.$$.fragment)},m(r,o){ee(e,r,o),n=!0},i(r){n||(A(e.$$.fragment,r),n=!0)},o(r){B(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function Kn(t){let e,n,r,o,l,c,i,u,a,d,f,p,k,b,E,N,v,y,w,x,R,T,D,C;n=new at({}),n.$on("click",t[7]);const g=[Yn,Zn,Vn],P=[];function U(H,X){return H[1]==H[5].general?0:H[1]==H[5].osrs?1:H[1]==H[5].rs3?2:-1}return~(x=U(t))&&(R=P[x]=g[x](t)),{c(){e=m("div"),ne(n.$$.fragment),r=M(),o=m("div"),l=m("button"),l.innerHTML='<img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/>',c=M(),i=m("div"),u=m("div"),a=m("button"),d=G("General"),f=m("br"),p=M(),k=m("button"),b=G("OSRS"),E=m("br"),N=M(),v=m("button"),y=G("RS3"),w=M(),R&&R.c(),_(l,"class","absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75"),_(a,"id","general_button"),_(a,"class",me),_(k,"id","osrs_button"),_(k,"class",Je),_(v,"id","rs3_button"),_(v,"class",me),_(u,"class","relative h-full border-r-2 border-slate-300 pt-10 dark:border-slate-800"),_(i,"class","grid h-full grid-cols-4"),_(o,"class","absolute left-[13%] top-[13%] z-20 h-3/4 w-3/4 rounded-lg bg-slate-100 text-center shadow-lg dark:bg-slate-900"),_(e,"id","settings")},m(H,X){L(H,e,X),ee(n,e,null),h(e,r),h(e,o),h(o,l),h(o,c),h(o,i),h(i,u),h(u,a),h(a,d),t[9](a),h(u,f),h(u,p),h(u,k),h(k,b),t[11](k),h(u,E),h(u,N),h(u,v),h(v,y),t[13](v),h(i,w),~x&&P[x].m(i,null),T=!0,D||(C=[j(l,"click",t[8]),j(a,"click",t[10]),j(k,"click",t[12]),j(v,"click",t[14])],D=!0)},p(H,[X]){let xe=x;x=U(H),x!==xe&&(R&&(ve(),B(P[xe],1,1,()=>{P[xe]=null}),Se()),~x?(R=P[x],R||(R=P[x]=g[x](H),R.c()),A(R,1),R.m(i,null)):R=null)},i(H){T||(A(n.$$.fragment,H),A(R),T=!0)},o(H){B(n.$$.fragment,H),B(R),T=!1},d(H){H&&S(e),te(n),t[9](null),t[11](null),t[13](null),~x&&P[x].d(),D=!1,re(C)}}}let Je="border-2 border-blue-500 bg-blue-500 hover:opacity-75 font-bold text-black duration-200 rounded-lg p-1 mx-auto my-1 w-3/4",me="border-2 border-blue-500 hover:opacity-75 duration-200 rounded-lg p-1 mx-auto my-1 w-3/4";function Qn(t,e,n){let{showSettings:r}=e;var o=(w=>(w[w.general=0]="general",w[w.osrs=1]="osrs",w[w.rs3=2]="rs3",w))(o||{});let l=1,c,i,u;function a(w){switch(w){case 0:n(1,l=0),n(2,c.classList.value=Je,c),n(3,i.classList.value=me,i),n(4,u.classList.value=me,u);break;case 1:n(1,l=1),n(2,c.classList.value=me,c),n(3,i.classList.value=Je,i),n(4,u.classList.value=me,u);break;case 2:n(1,l=2),n(2,c.classList.value=me,c),n(3,i.classList.value=me,i),n(4,u.classList.value=Je,u);break}}function d(w){w.key==="Escape"&&n(0,r=!1)}addEventListener("keydown",d),rt(()=>{removeEventListener("keydown",d)});const f=()=>{n(0,r=!1)},p=()=>{n(0,r=!1)};function k(w){z[w?"unshift":"push"](()=>{c=w,n(2,c)})}const b=()=>{a(o.general)};function E(w){z[w?"unshift":"push"](()=>{i=w,n(3,i)})}const N=()=>{a(o.osrs)};function v(w){z[w?"unshift":"push"](()=>{u=w,n(4,u)})}const y=()=>{a(o.rs3)};return t.$$set=w=>{"showSettings"in w&&n(0,r=w.showSettings)},[r,l,c,i,u,o,a,f,p,k,b,E,N,v,y]}class es extends ce{constructor(e){super(),le(this,e,Qn,Kn,oe,{showSettings:0})}}function kt(t,e,n){const r=t.slice();return r[1]=e[n],r}function ts(t){var u;let e,n=((u=t[1].time)==null?void 0:u.toLocaleTimeString())+"",r,o,l=t[1].text+"",c,i;return{c(){e=m("li"),r=G(n),o=G(`
					- `),c=G(l),i=M()},m(a,d){L(a,e,d),h(e,r),h(e,o),h(e,c),h(e,i)},p(a,d){var f;d&1&&n!==(n=((f=a[1].time)==null?void 0:f.toLocaleTimeString())+"")&&ae(r,n),d&1&&l!==(l=a[1].text+"")&&ae(c,l)},d(a){a&&S(e)}}}function ns(t){var u;let e,n=((u=t[1].time)==null?void 0:u.toLocaleTimeString())+"",r,o,l=t[1].text+"",c,i;return{c(){e=m("li"),r=G(n),o=G(`
					- `),c=G(l),i=M(),_(e,"class","text-rose-500")},m(a,d){L(a,e,d),h(e,r),h(e,o),h(e,c),h(e,i)},p(a,d){var f;d&1&&n!==(n=((f=a[1].time)==null?void 0:f.toLocaleTimeString())+"")&&ae(r,n),d&1&&l!==(l=a[1].text+"")&&ae(c,l)},d(a){a&&S(e)}}}function wt(t){let e;function n(l,c){return l[1].isError?ns:ts}let r=n(t),o=r(t);return{c(){o.c(),e=_e()},m(l,c){o.m(l,c),L(l,e,c)},p(l,c){r===(r=n(l))&&o?o.p(l,c):(o.d(1),o=r(l),o&&(o.c(),o.m(e.parentNode,e)))},d(l){l&&S(e),o.d(l)}}}function ss(t){let e,n,r,o,l=pe(t[0]),c=[];for(let i=0;i<l.length;i+=1)c[i]=wt(kt(t,l,i));return{c(){e=m("div"),n=m("div"),n.innerHTML='<img src="svgs/circle-info-solid.svg" alt="Message list icon" class="h-7 w-7 rounded-full bg-blue-500 p-[3px] duration-200"/>',r=M(),o=m("ol");for(let i=0;i<c.length;i+=1)c[i].c();_(n,"class","absolute right-2 top-2"),_(o,"id","message_list"),_(o,"class","h-full w-[105%] list-inside list-disc overflow-y-auto pl-5 pt-1 marker:text-blue-500"),_(e,"class","fixed bottom-0 h-1/4 w-screen border-t-2 border-t-slate-300 bg-slate-100 duration-200 dark:border-t-slate-800 dark:bg-slate-900")},m(i,u){L(i,e,u),h(e,n),h(e,r),h(e,o);for(let a=0;a<c.length;a+=1)c[a]&&c[a].m(o,null)},p(i,[u]){if(u&1){l=pe(i[0]);let a;for(a=0;a<l.length;a+=1){const d=kt(i,l,a);c[a]?c[a].p(d,u):(c[a]=wt(d),c[a].c(),c[a].m(o,null))}for(;a<c.length;a+=1)c[a].d(1);c.length=l.length}},i:O,o:O,d(i){i&&S(e),He(c,i)}}}function rs(t,e,n){let r;return F(t,Le,o=>n(0,r=o)),[r]}class os extends ce{constructor(e){super(),le(this,e,rs,ss,oe,{})}}function yt(t,e,n){const r=t.slice();return r[14]=e[n],r}function ls(t){let e,n,r;return{c(){e=m("button"),e.textContent="Plugin menu",e.disabled=!K(ge),_(e,"title",K(ge)?null:"Coming soon..."),_(e,"class","mx-auto mb-2 w-52 rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(o,l){L(o,e,l),n||(r=j(e,"click",t[9]),n=!0)},p:O,d(o){o&&S(e),n=!1,r()}}}function cs(t){let e,n,r,o,l,c,i,u,a,d=t[5]!=="linux"&&vt();return{c(){e=m("label"),e.textContent="Game Client",n=M(),r=m("br"),o=M(),l=m("select"),d&&d.c(),c=m("option"),c.textContent="RuneLite",i=m("option"),i.textContent="HDOS",_(e,"for","game_client_select"),_(e,"class","text-sm"),_(c,"data-id",ie.runeLite),_(c,"class","dark:bg-slate-900"),c.__value="RuneLite",be(c,c.__value),_(i,"data-id",ie.hdos),_(i,"class","dark:bg-slate-900"),i.__value="HDOS",be(i,i.__value),_(l,"id","game_client_select"),_(l,"class","mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800")},m(f,p){L(f,e,p),L(f,n,p),L(f,r,p),L(f,o,p),L(f,l,p),d&&d.m(l,null),h(l,c),h(l,i),t[8](l),u||(a=j(l,"change",t[6]),u=!0)},p(f,p){f[5]!=="linux"?d||(d=vt(),d.c(),d.m(l,c)):d&&(d.d(1),d=null)},d(f){f&&(S(e),S(n),S(r),S(o),S(l)),d&&d.d(),t[8](null),u=!1,a()}}}function vt(t){let e;return{c(){e=m("option"),e.textContent="OSRS Client",_(e,"data-id",ie.osrs),_(e,"class","dark:bg-slate-900"),e.__value="OSRS Client",be(e,e.__value)},m(n,r){L(n,e,r)},d(n){n&&S(e)}}}function St(t){let e,n=pe(t[4].account.characters),r=[];for(let o=0;o<n.length;o+=1)r[o]=Lt(yt(t,n,o));return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=_e()},m(o,l){for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(o,l);L(o,e,l)},p(o,l){if(l&16){n=pe(o[4].account.characters);let c;for(c=0;c<n.length;c+=1){const i=yt(o,n,c);r[c]?r[c].p(i,l):(r[c]=Lt(i),r[c].c(),r[c].m(e.parentNode,e))}for(;c<r.length;c+=1)r[c].d(1);r.length=n.length}},d(o){o&&S(e),He(r,o)}}}function is(t){let e;return{c(){e=G("New Character")},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function as(t){let e=t[14][1].displayName+"",n;return{c(){n=G(e)},m(r,o){L(r,n,o)},p(r,o){o&16&&e!==(e=r[14][1].displayName+"")&&ae(n,e)},d(r){r&&S(n)}}}function Lt(t){let e,n,r,o;function l(u,a){return u[14][1].displayName?as:is}let c=l(t),i=c(t);return{c(){e=m("option"),i.c(),n=M(),_(e,"data-id",r=t[14][1].accountId),_(e,"class","dark:bg-slate-900"),e.__value=o=`
						`+t[14][1].displayName+`
					`,be(e,e.__value)},m(u,a){L(u,e,a),i.m(e,null),h(e,n)},p(u,a){c===(c=l(u))&&i?i.p(u,a):(i.d(1),i=c(u),i&&(i.c(),i.m(e,n))),a&16&&r!==(r=u[14][1].accountId)&&_(e,"data-id",r),a&16&&o!==(o=`
						`+u[14][1].displayName+`
					`)&&(e.__value=o,be(e,e.__value))},d(u){u&&S(e),i.d()}}}function us(t){let e,n,r,o,l,c,i,u,a,d,f,p,k,b,E,N;function v(R,T){if(R[4].game==Q.osrs)return cs;if(R[4].game==Q.rs3)return ls}let y=v(t),w=y&&y(t),x=t[4].account&&St(t);return{c(){e=m("div"),n=m("img"),o=M(),l=m("button"),l.textContent="Play",c=M(),i=m("div"),w&&w.c(),u=M(),a=m("div"),d=m("label"),d.textContent="Character",f=M(),p=m("br"),k=M(),b=m("select"),x&&x.c(),Zt(n.src,r="svgs/rocket-solid.svg")||_(n,"src",r),_(n,"alt","Launch icon"),_(n,"class","mx-auto mb-5 w-24 rounded-3xl bg-gradient-to-br from-rose-500 to-violet-500 p-5"),_(l,"class","mx-auto mb-2 w-52 rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75"),_(i,"class","mx-auto my-2"),_(d,"for","character_select"),_(d,"class","text-sm"),_(b,"id","character_select"),_(b,"class","mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),_(a,"class","mx-auto my-2"),_(e,"class","bg-grad flex h-full flex-col border-slate-300 p-5 duration-200 dark:border-slate-800")},m(R,T){L(R,e,T),h(e,n),h(e,o),h(e,l),h(e,c),h(e,i),w&&w.m(i,null),h(e,u),h(e,a),h(a,d),h(a,f),h(a,p),h(a,k),h(a,b),x&&x.m(b,null),t[10](b),E||(N=[j(l,"click",t[7]),j(b,"change",t[11])],E=!0)},p(R,[T]){y===(y=v(R))&&w?w.p(R,T):(w&&w.d(1),w=y&&y(R),w&&(w.c(),w.m(i,null))),R[4].account?x?x.p(R,T):(x=St(R),x.c(),x.m(b,null)):x&&(x.d(1),x=null)},i:O,o:O,d(R){R&&S(e),w&&w.d(),x&&x.d(),t[10](null),E=!1,re(N)}}}function ds(t,e,n){let r,o,l,c;F(t,V,v=>n(4,r=v)),F(t,J,v=>n(12,o=v)),F(t,Fe,v=>n(5,l=v)),F(t,Z,v=>n(13,c=v));let{showPluginMenu:i=!1}=e,u,a;function d(){var y,w;if(!r.account)return;const v=u[u.selectedIndex].getAttribute("data-id");I(V,r.character=r.account.characters.get(v),r),r.character&&((w=o.selected_characters)==null||w.set(r.account.userId,(y=r.character)==null?void 0:y.accountId)),I(Z,c=!0,c)}function f(){a.value=="RuneLite"?(I(V,r.client=ie.runeLite,r),I(J,o.selected_client_index=ie.runeLite,o)):a.value=="HDOS"&&(I(V,r.client=ie.hdos,r),I(J,o.selected_client_index=ie.hdos,o)),I(Z,c=!0,c)}function p(){var v,y,w,x,R,T,D,C,g,P,U,H,X,xe,dt;if(!r.account||!r.character){$("Please log in to launch a client");return}switch(r.game){case Q.osrs:switch(r.client){case ie.osrs:ht(l==="windows",!0,(v=r.credentials)==null?void 0:v.session_id,(y=r.character)==null?void 0:y.accountId,(w=r.character)==null?void 0:w.displayName);break;case ie.runeLite:vn((x=r.credentials)==null?void 0:x.session_id,(R=r.character)==null?void 0:R.accountId,(T=r.character)==null?void 0:T.displayName);break;case ie.hdos:Ln((D=r.credentials)==null?void 0:D.session_id,(C=r.character)==null?void 0:C.accountId,(g=r.character)==null?void 0:g.displayName);break}break;case Q.rs3:l==="linux"?yn((P=r.credentials)==null?void 0:P.session_id,(U=r.character)==null?void 0:U.accountId,(H=r.character)==null?void 0:H.displayName):ht(l==="windows",!1,(X=r.credentials)==null?void 0:X.session_id,(xe=r.character)==null?void 0:xe.accountId,(dt=r.character)==null?void 0:dt.displayName);break}}tn(()=>{var v;if(r.game==Q.osrs&&r.client&&n(3,a.selectedIndex=r.client,a),r.account&&((v=o.selected_characters)!=null&&v.has(r.account.userId))){for(let y=0;y<u.options.length;y++)if(u[y].getAttribute("data-id")==o.selected_characters.get(r.account.userId)){n(2,u.selectedIndex=y,u);const w=u[u.selectedIndex].getAttribute("data-id");I(V,r.character=r.account.characters.get(w),r)}}}),De(()=>{o.selected_game_index==Q.osrs&&(n(3,a.selectedIndex=o.selected_client_index,a),I(V,r.client=a.selectedIndex,r))});function k(v){z[v?"unshift":"push"](()=>{a=v,n(3,a)})}const b=()=>{n(0,i=K(ge)??!1)};function E(v){z[v?"unshift":"push"](()=>{u=v,n(2,u)})}const N=()=>d();return t.$$set=v=>{"showPluginMenu"in v&&n(0,i=v.showPluginMenu)},[i,d,u,a,r,l,f,p,k,b,E,N]}class fs extends ce{constructor(e){super(),le(this,e,ds,us,oe,{showPluginMenu:0,characterChanged:1})}get characterChanged(){return this.$$.ctx[1]}}function ps(t){let e;return{c(){e=m("div"),e.innerHTML='<img src="svgs/circle-notch-solid.svg" alt="" class="mx-auto h-1/6 w-1/6 animate-spin"/>',_(e,"class","container mx-auto bg-slate-100 p-5 text-center text-slate-900 dark:bg-slate-900 dark:text-slate-50")},m(n,r){L(n,e,r)},p:O,i:O,o:O,d(n){n&&S(e)}}}class _s extends ce{constructor(e){super(),le(this,e,null,ps,oe,{})}}function xt(t,e,n){const r=t.slice();return r[23]=e[n][0],r[22]=e[n][1],r}function Ct(t,e,n){const r=t.slice();return r[27]=e[n],r}function hs(t){let e;return{c(){e=m("p"),e.textContent="error"},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function bs(t){let e;function n(l,c){return l[26].length==0?ms:gs}let r=n(t),o=r(t);return{c(){o.c(),e=_e()},m(l,c){o.m(l,c),L(l,e,c)},p(l,c){r===(r=n(l))&&o?o.p(l,c):(o.d(1),o=r(l),o&&(o.c(),o.m(e.parentNode,e)))},d(l){l&&S(e),o.d(l)}}}function gs(t){let e,n=pe(t[26]),r=[];for(let o=0;o<n.length;o+=1)r[o]=Tt(Ct(t,n,o));return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=_e()},m(o,l){for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(o,l);L(o,e,l)},p(o,l){if(l&22){n=pe(o[26]);let c;for(c=0;c<n.length;c+=1){const i=Ct(o,n,c);r[c]?r[c].p(i,l):(r[c]=Tt(i),r[c].c(),r[c].m(e.parentNode,e))}for(;c<r.length;c+=1)r[c].d(1);r.length=n.length}},d(o){o&&S(e),He(r,o)}}}function ms(t){let e;return{c(){e=m("p"),e.textContent="(start an RS3 game client with plugins enabled and it will be listed here.)"},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function Tt(t){let e,n=(t[27].identity||Et)+"",r,o,l,c,i,u;function a(){return t[14](t[27])}return{c(){e=m("button"),r=G(n),l=M(),c=m("br"),_(e,"class",o="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(t[4]&&t[1]===t[27].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")},m(d,f){L(d,e,f),h(e,r),L(d,l,f),L(d,c,f),i||(u=j(e,"click",a),i=!0)},p(d,f){t=d,f&4&&n!==(n=(t[27].identity||Et)+"")&&ae(r,n),f&22&&o!==(o="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(t[4]&&t[1]===t[27].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")&&_(e,"class",o)},d(d){d&&(S(e),S(l),S(c)),i=!1,u()}}}function ks(t){let e;return{c(){e=m("p"),e.textContent="loading..."},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function ws(t){let e;return{c(){e=m("p"),e.textContent="error"},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function ys(t){let e,n,r,o,l,c=pe(Object.entries(t[7])),i=[];for(let f=0;f<c.length;f+=1)i[f]=Pt(xt(t,c,f));function u(f,p){return f[4]?vs:Ss}let a=u(t),d=a(t);return{c(){e=m("select");for(let f=0;f<i.length;f+=1)i[f].c();n=M(),d.c(),r=_e(),_(e,"class","mx-auto mb-4 w-[min(280px,_45%)] cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),t[0]===void 0&&$e(()=>t[15].call(e))},m(f,p){L(f,e,p);for(let k=0;k<i.length;k+=1)i[k]&&i[k].m(e,null);pt(e,t[0],!0),L(f,n,p),d.m(f,p),L(f,r,p),o||(l=j(e,"change",t[15]),o=!0)},p(f,p){if(p&128){c=pe(Object.entries(f[7]));let k;for(k=0;k<c.length;k+=1){const b=xt(f,c,k);i[k]?i[k].p(b,p):(i[k]=Pt(b),i[k].c(),i[k].m(e,null))}for(;k<i.length;k+=1)i[k].d(1);i.length=c.length}p&129&&pt(e,f[0]),a===(a=u(f))&&d?d.p(f,p):(d.d(1),d=a(f),d&&(d.c(),d.m(r.parentNode,r)))},d(f){f&&(S(e),S(n),S(r)),He(i,f),d.d(f),o=!1,l()}}}function Pt(t){let e,n=(t[22].name??je)+"",r,o;return{c(){e=m("option"),r=G(n),_(e,"class","dark:bg-slate-900"),e.__value=o=t[23],be(e,e.__value)},m(l,c){L(l,e,c),h(e,r)},p(l,c){c&128&&n!==(n=(l[22].name??je)+"")&&ae(r,n),c&128&&o!==(o=l[23])&&(e.__value=o,be(e,e.__value))},d(l){l&&S(e)}}}function vs(t){let e,n,r,o,l={ctx:t,current:null,token:null,hasCatch:!0,pending:Es,then:xs,catch:Ls,value:22};return Ee(o=t[6],l),{c(){e=m("br"),n=M(),r=_e(),l.block.c()},m(c,i){L(c,e,i),L(c,n,i),L(c,r,i),l.block.m(c,l.anchor=i),l.mount=()=>r.parentNode,l.anchor=r},p(c,i){t=c,l.ctx=t,i&64&&o!==(o=t[6])&&Ee(o,l)||lt(l,t,i)},d(c){c&&(S(e),S(n),S(r)),l.block.d(c),l.token=null,l=null}}}function Ss(t){let e,n,r,o,l,c,i,u,a;function d(k,b){return b&128&&(c=null),c==null&&(c=Object.entries(k[7]).length!==0),c?Ns:Ms}let f=d(t,-1),p=f(t);return{c(){e=m("button"),n=G("+"),r=M(),o=m("br"),l=M(),p.c(),i=_e(),_(e,"class","aspect-square w-8 rounded-lg border-2 border-blue-500 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:border-gray-500"),e.disabled=t[3]},m(k,b){L(k,e,b),h(e,n),L(k,r,b),L(k,o,b),L(k,l,b),p.m(k,b),L(k,i,b),u||(a=j(e,"click",t[9]),u=!0)},p(k,b){b&8&&(e.disabled=k[3]),f===(f=d(k,b))&&p?p.p(k,b):(p.d(1),p=f(k),p&&(p.c(),p.m(i.parentNode,i)))},d(k){k&&(S(e),S(r),S(o),S(l),S(i)),p.d(k),u=!1,a()}}}function Ls(t){let e;return{c(){e=m("p"),e.textContent="error"},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function xs(t){let e,n;function r(c,i){return i&193&&(e=null),e==null&&(e=!!(c[22]&&c[22].main&&Object.keys(c[7]).includes(c[0]))),e?Ts:Cs}let o=r(t,-1),l=o(t);return{c(){l.c(),n=_e()},m(c,i){l.m(c,i),L(c,n,i)},p(c,i){o===(o=r(c,i))&&l?l.p(c,i):(l.d(1),l=o(c),l&&(l.c(),l.m(n.parentNode,n)))},d(c){c&&S(n),l.d(c)}}}function Cs(t){let e;return{c(){e=m("p"),e.textContent="can't start plugin: does not appear to be configured"},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function Ts(t){let e;function n(l,c){return l[7][l[0]].path?Rs:Ps}let r=n(t),o=r(t);return{c(){o.c(),e=_e()},m(l,c){o.m(l,c),L(l,e,c)},p(l,c){r===(r=n(l))&&o?o.p(l,c):(o.d(1),o=r(l),o&&(o.c(),o.m(e.parentNode,e)))},d(l){l&&S(e),o.d(l)}}}function Ps(t){let e;return{c(){e=m("p"),e.textContent="can't start plugin: no path is configured"},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function Rs(t){let e,n,r=t[22].name+"",o,l,c;function i(){return t[18](t[22])}return{c(){e=m("button"),n=G("Start "),o=G(r),_(e,"class","mx-auto mb-1 w-auto rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75")},m(u,a){L(u,e,a),h(e,n),h(e,o),l||(c=j(e,"click",i),l=!0)},p(u,a){t=u,a&64&&r!==(r=t[22].name+"")&&ae(o,r)},d(u){u&&S(e),l=!1,c()}}}function Es(t){let e;return{c(){e=m("p"),e.textContent="loading..."},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function Ms(t){let e;return{c(){e=m("p"),e.textContent=`You have no plugins installed. Click the + button and select a plugin's bolt.json file
							to add it.`},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function Ns(t){let e=Object.keys(K(fe)).includes(t[0])&&t[6]!==null,n,r=e&&Rt(t);return{c(){r&&r.c(),n=_e()},m(o,l){r&&r.m(o,l),L(o,n,l)},p(o,l){l&65&&(e=Object.keys(K(fe)).includes(o[0])&&o[6]!==null),e?r?r.p(o,l):(r=Rt(o),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(o){o&&S(n),r&&r.d(o)}}}function Rt(t){let e,n,r,o,l,c,i,u={ctx:t,current:null,token:null,hasCatch:!0,pending:js,then:Is,catch:Os,value:22};return Ee(e=t[6],u),{c(){u.block.c(),n=M(),r=m("button"),r.textContent="Remove",o=M(),l=m("button"),l.textContent="Reload",_(r,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-rose-500 enabled:hover:opacity-75 disabled:bg-gray-500"),_(l,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(a,d){u.block.m(a,u.anchor=d),u.mount=()=>n.parentNode,u.anchor=n,L(a,n,d),L(a,r,d),L(a,o,d),L(a,l,d),c||(i=[j(r,"click",t[16]),j(l,"click",t[17])],c=!0)},p(a,d){t=a,u.ctx=t,d&64&&e!==(e=t[6])&&Ee(e,u)||lt(u,t,d)},d(a){a&&(S(n),S(r),S(o),S(l)),u.block.d(a),u.token=null,u=null,c=!1,re(i)}}}function Os(t){let e,n,r;return{c(){e=m("p"),e.textContent="error",n=M(),r=m("br")},m(o,l){L(o,e,l),L(o,n,l),L(o,r,l)},p:O,d(o){o&&(S(e),S(n),S(r))}}}function Is(t){let e,n=(t[22].name??je)+"",r,o,l,c=(t[22].description??"no description")+"",i,u,a,d;return{c(){e=m("p"),r=G(n),o=M(),l=m("p"),i=G(c),a=M(),d=m("br"),_(e,"class","pb-4 text-xl font-bold"),_(l,"class",u=t[22].description?null:"italic")},m(f,p){L(f,e,p),h(e,r),L(f,o,p),L(f,l,p),h(l,i),L(f,a,p),L(f,d,p)},p(f,p){p&64&&n!==(n=(f[22].name??je)+"")&&ae(r,n),p&64&&c!==(c=(f[22].description??"no description")+"")&&ae(i,c),p&64&&u!==(u=f[22].description?null:"italic")&&_(l,"class",u)},d(f){f&&(S(e),S(o),S(l),S(a),S(d))}}}function js(t){let e;return{c(){e=m("p"),e.textContent="loading..."},m(n,r){L(n,e,r)},p:O,d(n){n&&S(e)}}}function Hs(t){let e,n,r,o,l,c,i,u,a,d,f,p,k,b,E,N,v,y,w;n=new at({}),n.$on("click",t[11]);let x={ctx:t,current:null,token:null,hasCatch:!0,pending:ks,then:bs,catch:hs,value:26};Ee(b=t[2],x);function R(C,g){return ge?ys:ws}let D=R()(t);return{c(){e=m("div"),ne(n.$$.fragment),r=M(),o=m("div"),l=m("button"),l.innerHTML='<img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/>',c=M(),i=m("div"),u=m("button"),a=G("Manage Plugins"),f=M(),p=m("hr"),k=M(),x.block.c(),E=M(),N=m("div"),D.c(),_(l,"class","absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75"),_(u,"class",d="mx-auto mb-2 w-[95%] rounded-lg border-2 "+(t[4]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75"),_(p,"class","p-1 dark:border-slate-700"),_(i,"class","left-0 float-left h-full w-[min(180px,_50%)] overflow-hidden border-r-2 border-slate-300 pt-2 dark:border-slate-800"),_(N,"class","h-full pt-10"),_(o,"class","absolute left-[5%] top-[5%] z-20 h-[90%] w-[90%] rounded-lg bg-slate-100 text-center shadow-lg dark:bg-slate-900")},m(C,g){L(C,e,g),ee(n,e,null),h(e,r),h(e,o),h(o,l),h(o,c),h(o,i),h(i,u),h(u,a),h(i,f),h(i,p),h(i,k),x.block.m(i,x.anchor=null),x.mount=()=>i,x.anchor=null,h(o,E),h(o,N),D.m(N,null),v=!0,y||(w=[j(l,"click",t[11]),j(u,"click",t[13])],y=!0)},p(C,[g]){t=C,(!v||g&16&&d!==(d="mx-auto mb-2 w-[95%] rounded-lg border-2 "+(t[4]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75"))&&_(u,"class",d),x.ctx=t,g&4&&b!==(b=t[2])&&Ee(b,x)||lt(x,t,g),D.p(t,g)},i(C){v||(A(n.$$.fragment,C),v=!0)},o(C){B(n.$$.fragment,C),v=!1},d(C){C&&S(e),te(n),x.block.d(),x.token=null,x=null,D.d(),y=!1,re(w)}}}const je="(unnamed)",Et="(new character)";function As(t,e,n){let r,o,l;F(t,et,g=>n(2,o=g)),F(t,fe,g=>n(7,l=g));let{showPluginMenu:c}=e;const i=g=>new Promise((P,U)=>{const H=g.concat(g.endsWith("/")?"bolt.json":"/bolt.json");var X=new XMLHttpRequest;X.onreadystatechange=()=>{X.readyState==4&&(X.status==200?P(JSON.parse(X.responseText)):U(X.responseText))},X.open("GET","/read-json-file?".concat(new URLSearchParams({path:H}).toString()),!0),X.send()}),u=g=>{const U=K(fe)[g];if(!U)return null;const H=U.path;return H?i(H):null},a=(g,P)=>{i(g).then(U=>{do n(0,E=crypto.randomUUID());while(Object.keys(K(fe)).includes(E));I(fe,l[E]={name:U.name??je,path:g},l),n(5,y=!0)}).catch(U=>{console.error(`Config file '${P}' couldn't be fetched, reason: ${U}`)})};let d=!1;const f=()=>{n(3,d=!0);var g=new XMLHttpRequest;g.onreadystatechange=()=>{if(g.readyState==4&&(n(3,d=!1),g.status==200)){const P=K(Fe)==="windows"?g.responseText.replaceAll("\\","/"):g.responseText;if(P.endsWith("/bolt.json")){const U=P.substring(0,P.length-9);a(U,P)}else console.log(`Selection '${P}' is not named bolt.json; ignored`)}},g.open("GET","/json-file-picker",!0),g.send()};et.set(zt());const p=(g,P,U,H)=>{var X=new XMLHttpRequest;X.onreadystatechange=()=>{X.readyState==4&&$(`Start-plugin status: ${X.statusText.trim()}`)},X.open("GET","/start-plugin?".concat(new URLSearchParams({client:g,id:P,path:U,main:H}).toString()),!0),X.send()},k=()=>{d||n(12,c=!1)};function b(g){g.key==="Escape"&&k()}addEventListener("keydown",b);var E,N=!1,v;let y=!1;rt(()=>{y&&xn(),removeEventListener("keydown",b)});const w=()=>n(4,N=!1),x=g=>{n(1,v=g.uid),n(4,N=!0)};function R(){E=Qt(this),n(0,E)}const T=()=>{n(6,r=null),n(5,y=!0);let g=K(fe);delete g[E],fe.set(g)},D=()=>n(6,r=u(E)),C=g=>p(v,E,l[E].path??"",g.main??"");return t.$$set=g=>{"showPluginMenu"in g&&n(12,c=g.showPluginMenu)},t.$$.update=()=>{t.$$.dirty&6&&o.then(g=>{g.some(P=>P.uid===v)||n(4,N=!1)}),t.$$.dirty&1&&n(6,r=u(E))},[E,v,o,d,N,y,r,l,u,f,p,k,c,w,x,R,T,D,C]}class Ds extends ce{constructor(e){super(),le(this,e,As,Hs,oe,{showPluginMenu:12})}}function Us(t){let e,n,r,o,l,c,i,u,a,d,f,p,k,b,E,N,v=t[1]&&Mt(t),y=t[0]&&Nt(t),w=t[3]&&Ot();function x(C){t[6](C)}let R={};t[0]!==void 0&&(R.showSettings=t[0]),o=new On({props:R}),z.push(()=>Ie(o,"showSettings",x));function T(C){t[7](C)}let D={};return t[1]!==void 0&&(D.showPluginMenu=t[1]),d=new fs({props:D}),z.push(()=>Ie(d,"showPluginMenu",T)),E=new os({}),{c(){v&&v.c(),e=M(),y&&y.c(),n=M(),w&&w.c(),r=M(),ne(o.$$.fragment),c=M(),i=m("div"),u=m("div"),a=M(),ne(d.$$.fragment),p=M(),k=m("div"),b=M(),ne(E.$$.fragment),_(i,"class","mt-16 grid h-full grid-flow-col grid-cols-3")},m(C,g){v&&v.m(C,g),L(C,e,g),y&&y.m(C,g),L(C,n,g),w&&w.m(C,g),L(C,r,g),ee(o,C,g),L(C,c,g),L(C,i,g),h(i,u),h(i,a),ee(d,i,null),h(i,p),h(i,k),L(C,b,g),ee(E,C,g),N=!0},p(C,g){C[1]?v?(v.p(C,g),g&2&&A(v,1)):(v=Mt(C),v.c(),A(v,1),v.m(e.parentNode,e)):v&&(ve(),B(v,1,1,()=>{v=null}),Se()),C[0]?y?(y.p(C,g),g&1&&A(y,1)):(y=Nt(C),y.c(),A(y,1),y.m(n.parentNode,n)):y&&(ve(),B(y,1,1,()=>{y=null}),Se()),C[3]?w?g&8&&A(w,1):(w=Ot(),w.c(),A(w,1),w.m(r.parentNode,r)):w&&(ve(),B(w,1,1,()=>{w=null}),Se());const P={};!l&&g&1&&(l=!0,P.showSettings=C[0],Oe(()=>l=!1)),o.$set(P);const U={};!f&&g&2&&(f=!0,U.showPluginMenu=C[1],Oe(()=>f=!1)),d.$set(U)},i(C){N||(A(v),A(y),A(w),A(o.$$.fragment,C),A(d.$$.fragment,C),A(E.$$.fragment,C),N=!0)},o(C){B(v),B(y),B(w),B(o.$$.fragment,C),B(d.$$.fragment,C),B(E.$$.fragment,C),N=!1},d(C){C&&(S(e),S(n),S(r),S(c),S(i),S(b)),v&&v.d(C),y&&y.d(C),w&&w.d(C),te(o,C),te(d),te(E,C)}}}function qs(t){let e,n;return e=new _s({}),{c(){ne(e.$$.fragment)},m(r,o){ee(e,r,o),n=!0},p:O,i(r){n||(A(e.$$.fragment,r),n=!0)},o(r){B(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function Mt(t){let e,n,r;function o(c){t[4](c)}let l={};return t[1]!==void 0&&(l.showPluginMenu=t[1]),e=new Ds({props:l}),z.push(()=>Ie(e,"showPluginMenu",o)),{c(){ne(e.$$.fragment)},m(c,i){ee(e,c,i),r=!0},p(c,i){const u={};!n&&i&2&&(n=!0,u.showPluginMenu=c[1],Oe(()=>n=!1)),e.$set(u)},i(c){r||(A(e.$$.fragment,c),r=!0)},o(c){B(e.$$.fragment,c),r=!1},d(c){te(e,c)}}}function Nt(t){let e,n,r;function o(c){t[5](c)}let l={};return t[0]!==void 0&&(l.showSettings=t[0]),e=new es({props:l}),z.push(()=>Ie(e,"showSettings",o)),{c(){ne(e.$$.fragment)},m(c,i){ee(e,c,i),r=!0},p(c,i){const u={};!n&&i&1&&(n=!0,u.showSettings=c[0],Oe(()=>n=!1)),e.$set(u)},i(c){r||(A(e.$$.fragment,c),r=!0)},o(c){B(e.$$.fragment,c),r=!1},d(c){te(e,c)}}}function Ot(t){let e,n;return e=new Dn({}),{c(){ne(e.$$.fragment)},m(r,o){ee(e,r,o),n=!0},i(r){n||(A(e.$$.fragment,r),n=!0)},o(r){B(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function Bs(t){let e,n,r,o;const l=[qs,Us],c=[];function i(u,a){return u[2]?0:1}return n=i(t),r=c[n]=l[n](t),{c(){e=m("main"),r.c(),_(e,"class","h-full")},m(u,a){L(u,e,a),c[n].m(e,null),o=!0},p(u,[a]){let d=n;n=i(u),n===d?c[n].p(u,a):(ve(),B(c[d],1,1,()=>{c[d]=null}),Se(),r=c[n],r?r.p(u,a):(r=c[n]=l[n](u),r.c()),A(r,1),r.m(e,null))},i(u){o||(A(r),o=!0)},o(u){B(r),o=!1},d(u){u&&S(e),c[n].d()}}}function Js(t,e,n){let r;F(t,Xe,p=>n(3,r=p));let o=!1,l=!1,c=!1;_n();const i=window.opener||window.parent;if(i){const p=new URLSearchParams(window.location.search);p.get("id_token")?(c=!0,i.postMessage({type:"gameSessionServerAuth",code:p.get("code"),id_token:p.get("id_token"),state:p.get("state")},"*")):p.get("code")&&(c=!0,i.postMessage({type:"authCode",code:p.get("code"),state:p.get("state")},"*"))}function u(p){l=p,n(1,l)}function a(p){o=p,n(0,o)}function d(p){o=p,n(0,o)}function f(p){l=p,n(1,l)}return[o,l,c,r,u,a,d,f]}class $s extends ce{constructor(e){super(),le(this,e,Js,Bs,oe,{})}}new $s({target:document.getElementById("app")});const ue=[],Gs=K(Ut);let W;ue.push(ct.subscribe(t=>W=t));let se;ue.push(J.subscribe(t=>se=t));ue.push(Fe.subscribe(t=>t));let ke;ue.push(ye.subscribe(t=>ke=t));ue.push(ge.subscribe(t=>t??!1));let de;ue.push(We.subscribe(t=>de=t));let ut;ue.push(it.subscribe(t=>ut=t));ue.push(Le.subscribe(t=>t));ue.push(Ge.subscribe(t=>t));let ze;ue.push(V.subscribe(t=>ze=t));function Xs(){var o;const t=atob(W.origin),e=atob(W.clientid),n=t.concat("/oauth2/token");ke.size==0&&Xe.set(!0),fn(),se.selected_game_accounts&&((o=se.selected_game_accounts)==null?void 0:o.size)>0&&J.update(l=>{var c;return l.selected_characters=l.selected_game_accounts,(c=l.selected_game_accounts)==null||c.clear(),l});const r=[Gs,t,atob(W.origin_2fa)];window.addEventListener("message",l=>{if(!r.includes(l.origin)){$(`discarding window message from origin ${l.origin}`);return}let c=de;const i=new XMLHttpRequest;switch(l.data.type){case"authCode":if(c){We.set({});const u=new URLSearchParams({grant_type:"authorization_code",client_id:atob(W.clientid),code:l.data.code,code_verifier:c.verifier,redirect_uri:atob(W.redirect)});i.onreadystatechange=()=>{if(i.readyState==4)if(i.status==200){const a=Jt(i.response),d=Dt(a);d?_t(c==null?void 0:c.win,d).then(f=>{f&&(ye.update(p=>(p.set(d.sub,d),p)),Me())}):(q("Error: invalid credentials received",!1),c.win.close())}else q(`Error: from ${n}: ${i.status}: ${i.response}`,!1),c.win.close()},i.open("POST",n,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.setRequestHeader("Accept","application/json"),i.send(u)}break;case"externalUrl":i.onreadystatechange=()=>{i.readyState==4&&$(`External URL status: '${i.responseText.trim()}'`)},i.open("POST","/open-external-url",!0),i.send(l.data.url);break;case"gameSessionServerAuth":if(c=ut.find(u=>l.data.state==u.state),c){pn(c,!0);const u=l.data.id_token.split(".");if(u.length!==3){q(`Malformed id_token: ${u.length} sections, expected 3`,!1);break}const a=JSON.parse(atob(u[0]));if(a.typ!=="JWT"){q(`Bad id_token header: typ ${a.typ}, expected JWT`,!1);break}const d=JSON.parse(atob(u[1]));if(atob(d.nonce)!==c.nonce){q("Incorrect nonce in id_token",!1);break}const f=atob(W.auth_api).concat("/sessions");i.onreadystatechange=()=>{if(i.readyState==4)if(i.status==200){const p=atob(W.auth_api).concat("/accounts");c.creds.session_id=JSON.parse(i.response).sessionId,Gt(c.creds,p,c.account_info_promise).then(k=>{k&&(ye.update(b=>{var E;return b.set((E=c==null?void 0:c.creds)==null?void 0:E.sub,c.creds),b}),Me())})}else q(`Error: from ${f}: ${i.status}: ${i.response}`,!1)},i.open("POST",f,!0),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Accept","application/json"),i.send(`{"idToken": "${l.data.id_token}"}`)}break;case"gameClientListUpdate":et.set(zt());break;default:$("Unknown message type: ".concat(l.data.type));break}}),(async()=>(ke.size>0&&ke.forEach(async l=>{const c=await Bt(l,n,e);c!==null&&c!==0&&(q(`Discarding expired login for #${l.sub}`,!1),ye.update(u=>(u.delete(l.sub),u)),Me());let i;if(c===null&&await _t(null,l)?i={creds:l,valid:!0}:i={creds:l,valid:c===0},i.valid){const u=l;ye.update(a=>(a.set(u.sub,u),a)),Me()}}),Z.set(!1)))()}function $(t){console.log(t);const e={isError:!1,text:t,time:new Date(Date.now())};Le.update(n=>(n.unshift(e),n))}function q(t,e){const n={isError:!0,text:t,time:new Date(Date.now())};if(Le.update(r=>(r.unshift(n),r)),!e)console.error(t);else throw new Error(t)}ct.set(s());onload=()=>Xs();onunload=()=>{for(const t in ue)delete ue[t];Ue()};
