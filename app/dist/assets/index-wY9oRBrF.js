var Ot=Object.defineProperty;var Ht=(t,e,n)=>e in t?Ot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ce=(t,e,n)=>(Ht(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();var Ve=(t=>(t[t.SECOND=1e3]="SECOND",t[t.MINUTE=6e4]="MINUTE",t[t.HALF_HOUR=18e5]="HALF_HOUR",t[t.HOUR=36e5]="HOUR",t[t.DAY=864e5]="DAY",t[t.WEEK=6048e5]="WEEK",t[t.MONTH=2592e6]="MONTH",t))(Ve||{});class ke{static set(e,n,o,l){const r=new Date;r.setTime(r.getTime()+o*l);const i=`expires=${r.toUTCString()}`;document.cookie=`${e}=${n};${i};path=/`}static get(e){const n=`${e}=`,o=document.cookie.split(";");for(let l=0;l<o.length;l++){let r=o[l];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(n)===0)return r.substring(n.length,r.length)}return null}static remove(e){document.cookie=`${e}=; Max-Age=-99999999;`}}function le(t){return{ok:!0,value:t}}function X(t){return{ok:!1,error:t}}var W=(t=>(t.rs3="rs3",t.osrs="osrs",t))(W||{}),de=(t=>(t.official="Official",t.runelite="RuneLite",t.hdos="HDOS",t))(de||{});const tt={rs3:["Official"],osrs:["Official","RuneLite","HDOS"]};class Ue{static parseTokenResponse(e){try{const n=JSON.parse(e),o=n.id_token.split(".");if(o.length!==3){const i=`Malformed id_token: ${o.length} sections, expected 3`;return X(i)}const l=JSON.parse(atob(o[0]));if(l.typ!=="JWT"){const i=`Bad id_token header: typ ${l.typ}, expected JWT`;return X(i)}const r=JSON.parse(atob(o[1]));return le({access_token:n.access_token,id_token:n.id_token,refresh_token:n.refresh_token,sub:r.sub,expiry:Date.now()+n.expires_in*1e3})}catch{return X("Unable to parse token response")}}static parseSessionResponse(e){try{const n=JSON.parse(e);return n.sessionId?le(n.sessionId):X("sessionId does not exist on parsed object")}catch{return X("Unable to parse session response")}}static decodeBolt(e){const n={};for(const o in e){const l=o,r=e[l];typeof r=="string"?n[l]=atob(r):Array.isArray(r)&&r.every(i=>typeof i=="string")?n[l]=r.map(i=>atob(i)):n[l]=r}return n}}var xe=(t=>(t.Windows="windows",t.Linux="linux",t.MacOS="mac",t))(xe||{});const R={env:Ue.decodeBolt(s()),platform:null,rs3DebInstalledHash:null,rs3ExeInstalledHash:null,rs3AppInstalledHash:null,osrsExeInstalledHash:null,osrsAppInstalledHash:null,runeLiteInstalledId:null,hdosInstalledVersion:null,isFlathub:!1,hasBoltPlugins:!1,pluginList:{}};class Xe{static async makeLoginUrl(e){const n=new TextEncoder().encode(e.pkceCodeVerifier),o=await crypto.subtle.digest("SHA-256",n);let l="";const r=new Uint8Array(o);for(let a=0;a<r.byteLength;a++)l+=String.fromCharCode(r[a]);const i=btoa(l).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return e.origin.concat("/oauth2/auth?").concat(new URLSearchParams({auth_method:e.authMethod,login_type:e.loginType,flow:e.flow,response_type:"code",client_id:e.clientid,redirect_uri:e.redirect,code_challenge:i,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:e.pkceState}).toString())}static makeRandomVerifier(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=new Uint32Array(43);return crypto.getRandomValues(n),Array.from(n,function(o){return e[o%e.length]}).join("")}static makeRandomState(){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",o=n.length-1,l=crypto.getRandomValues(new Uint8Array(12));return Array.from(l).map(r=>Math.round(r*(o-0)/255+0)).map(r=>n[r]).join("")}}const we=class we{static async openLoginWindow(e,n,o){if(we.pendingLoginWindow!==null)return we.pendingLoginWindow.window.focus();const l=Xe.makeRandomState(),r=Xe.makeRandomVerifier(),i=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",i);let u="";const c=new Uint8Array(a);for(let _=0;_<c.byteLength;_++)u+=String.fromCharCode(c[_]);const d=btoa(u).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),f=new URLSearchParams({auth_method:"",login_type:"",flow:"launcher",response_type:"code",client_id:o,redirect_uri:n,code_challenge:d,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:l}),g=`${e}/oauth2/auth?${f.toString()}`;ke.set("auth_verifier",r,10,Ve.MINUTE),we.pendingLoginWindow=window.open(g,"","width=480,height=720")}static navigateToAuthConsent(e,n,o){const l=Xe.makeRandomState(),r=new URLSearchParams({id_token_hint:n,nonce:o,prompt:"consent",redirect_uri:"http://localhost",response_type:"id_token code",state:l,client_id:"1fddee4e-b100-4f4e-b2b0-097f9088f9d2",scope:"openid offline"}),i=`${e}/oauth2/auth?${r.toString()}`;ke.set("auth_nonce",o,10,Ve.MINUTE),window.location.href=i}static async refreshOAuthToken(e){return new Promise(n=>{if(e.expiry-Date.now()<3e4){const o=new URLSearchParams({grant_type:"refresh_token",client_id:R.env.clientid,refresh_token:e.refresh_token}),l=new XMLHttpRequest;l.onreadystatechange=()=>{if(l.readyState==4)if(l.status==200){const i=Ue.parseTokenResponse(l.response);i.ok?n(le(i.value)):n(X(0))}else n(X(l.status))},l.onerror=()=>{n(X(0))};const r=R.env.origin.concat("/oauth2/token");l.open("POST",r,!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.setRequestHeader("Accept","application/json"),l.send(o)}else n(le(e))})}static async getOAuthToken(e,n,o,l,r){const i=`${e}/oauth2/token`;return new Promise(a=>{const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(u.readyState==4)if(u.status==200){const d=Ue.parseTokenResponse(u.response);return d.ok?a(le(d.value)):a(X(d.error))}else return a(X(`Error: from ${i}: ${u.status}: ${u.response}`))},u.open("POST",i,!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.setRequestHeader("Accept","application/json");const c=new URLSearchParams({grant_type:"authorization_code",client_id:n,code:r,code_verifier:o,redirect_uri:l});u.send(c)})}static revokeOauthCreds(e){const n=`${R.env.origin}/oauth2/revoke`;return new Promise(o=>{const l=new XMLHttpRequest;l.open("POST",n,!0),l.onreadystatechange=()=>{l.readyState==4&&o(l.status)},l.setRequestHeader("Content-Type","application/x-www-form-urlencoded");const r=new URLSearchParams({token:e,client_id:R.env.clientid});l.send(r)})}static async getSessionId(e,n){const o=`${e}/sessions`;return new Promise(l=>{const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const a=Ue.parseSessionResponse(r.response);return a.ok?l(le(a.value)):l(X(a.error))}else X(`Error: from ${o}: ${r.status}: ${r.response}`)},r.open("POST",o,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json");const i={idToken:n};r.send(JSON.stringify(i))})}static validateIdToken(e,n){const o=e.split(".");if(o.length!==3)return X(`Malformed id_token: ${o.length} sections, expected 3`);const l=JSON.parse(atob(o[0]));return l.typ!=="JWT"?X(`Bad id_token header: typ ${l.typ}, expected JWT`):JSON.parse(atob(o[1])).nonce!==n?X("Incorrect nonce in id_token"):le(void 0)}};Ce(we,"pendingLoginWindow",null);let se=we;class je{static async buildSession(e,n){const o=await je.getUser(e.sub,e.access_token);if(!o.ok)return X(`Failed to fetch user. Status: ${o.error}`);const l=await je.getUserAccounts(n);return l.ok?le({user:o.value,accounts:l.value,tokens:e,session_id:n}):X(`Failed to fetch game accounts. Status: ${l.error}`)}static getUser(e,n){return new Promise(o=>{const l=`${R.env.api}/users/${e}/displayName`,r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const i=JSON.parse(r.response);o(le(i))}else o(X(r.status))},r.open("GET",l,!0),r.setRequestHeader("Authorization","Bearer ".concat(n)),r.send()})}static getUserAccounts(e){const n=`${R.env.auth_api}/accounts`;return new Promise(o=>{const l=new XMLHttpRequest;l.onreadystatechange=async()=>{if(l.readyState==4)if(l.status==200){const r=JSON.parse(l.response);o(le(r))}else o(X(l.status))},l.open("GET",n,!0),l.setRequestHeader("Accept","application/json"),l.setRequestHeader("Authorization","Bearer ".concat(e)),l.send()})}}function U(){}function Et(t,e){for(const n in e)t[n]=e[n];return t}function Ut(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function Lt(t){return t()}function nt(){return Object.create(null)}function ne(t){t.forEach(Lt)}function Ae(t){return typeof t=="function"}function K(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let Ee;function Nt(t,e){return t===e?!0:(Ee||(Ee=document.createElement("a")),Ee.href=e,t===Ee.href)}function jt(t){return Object.keys(t).length===0}function Ct(t,...e){if(t==null){for(const o of e)o(void 0);return U}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ae(t){let e;return Ct(t,n=>e=n)(),e}function re(t,e,n){t.$$.on_destroy.push(Ct(e,n))}function De(t,e,n,o){if(t){const l=Rt(t,e,n,o);return t[0](l)}}function Rt(t,e,n,o){return t[1]&&o?Et(n.ctx.slice(),t[1](o(e))):n.ctx}function qe(t,e,n,o){if(t[2]&&o){const l=t[2](o(n));if(e.dirty===void 0)return l;if(typeof l=="object"){const r=[],i=Math.max(e.dirty.length,l.length);for(let a=0;a<i;a+=1)r[a]=e.dirty[a]|l[a];return r}return e.dirty|l}return e.dirty}function Be(t,e,n,o,l,r){if(l){const i=Rt(e,n,o,r);t.p(i,l)}}function Ge(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let o=0;o<n;o++)e[o]=-1;return e}return-1}function ye(t,e,n){return t.set(n),e}function Mt(t){return t&&Ae(t.destroy)?t.destroy:U}function v(t,e){t.appendChild(e)}function w(t,e,n){t.insertBefore(e,n||null)}function k(t){t.parentNode&&t.parentNode.removeChild(t)}function Pe(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function J(t){return document.createTextNode(t)}function P(){return J(" ")}function fe(){return J("")}function N(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function At(t){return function(e){e.target===this&&t.call(this,e)}}function m(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Dt(t){return Array.from(t.childNodes)}function ie(t,e){e=""+e,t.data!==e&&(t.data=e)}function Q(t,e){t.value=e??""}function $e(t,e,n){for(let o=0;o<t.options.length;o+=1){const l=t.options[o];if(l.__value===e){l.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Ye(t){const e=t.querySelector(":checked");return e&&e.__value}function F(t,e,n){t.classList.toggle(e,!!n)}function qt(t,e,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:o})}let Te;function ce(t){Te=t}function Je(){if(!Te)throw new Error("Function called outside component initialization");return Te}function xt(t){Je().$$.on_mount.push(t)}function Bt(t){Je().$$.on_destroy.push(t)}function Gt(){const t=Je();return(e,n,{cancelable:o=!1}={})=>{const l=t.$$.callbacks[e];if(l){const r=qt(e,n,{cancelable:o});return l.slice().forEach(i=>{i.call(t,r)}),!r.defaultPrevented}return!0}}const be=[],ue=[];let ve=[];const st=[],Jt=Promise.resolve();let ze=!1;function Xt(){ze||(ze=!0,Jt.then(Ke))}function Se(t){ve.push(t)}const Fe=new Set;let _e=0;function Ke(){if(_e!==0)return;const t=Te;do{try{for(;_e<be.length;){const e=be[_e];_e++,ce(e),Ft(e.$$)}}catch(e){throw be.length=0,_e=0,e}for(ce(null),be.length=0,_e=0;ue.length;)ue.pop()();for(let e=0;e<ve.length;e+=1){const n=ve[e];Fe.has(n)||(Fe.add(n),n())}ve.length=0}while(be.length);for(;st.length;)st.pop()();ze=!1,Fe.clear(),ce(t)}function Ft(t){if(t.fragment!==null){t.update(),ne(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Se)}}function Wt(t){const e=[],n=[];ve.forEach(o=>t.indexOf(o)===-1?e.push(o):n.push(o)),n.forEach(o=>o()),ve=e}const Ne=new Set;let pe;function Oe(){pe={r:0,c:[],p:pe}}function He(){pe.r||ne(pe.c),pe=pe.p}function M(t,e){t&&t.i&&(Ne.delete(t),t.i(e))}function D(t,e,n,o){if(t&&t.o){if(Ne.has(t))return;Ne.add(t),pe.c.push(()=>{Ne.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}function Le(t,e){const n=e.token={};function o(l,r,i,a){if(e.token!==n)return;e.resolved=a;let u=e.ctx;i!==void 0&&(u=u.slice(),u[i]=a);const c=l&&(e.current=l)(u);let d=!1;e.block&&(e.blocks?e.blocks.forEach((f,g)=>{g!==r&&f&&(Oe(),D(f,1,1,()=>{e.blocks[g]===f&&(e.blocks[g]=null)}),He())}):e.block.d(1),c.c(),M(c,1),c.m(e.mount(),e.anchor),d=!0),e.block=c,e.blocks&&(e.blocks[r]=c),d&&Ke()}if(Ut(t)){const l=Je();if(t.then(r=>{ce(l),o(e.then,1,e.value,r),ce(null)},r=>{if(ce(l),o(e.catch,2,e.error,r),ce(null),!e.hasCatch)throw r}),e.current!==e.pending)return o(e.pending,0),!0}else{if(e.current!==e.then)return o(e.then,1,e.value,t),!0;e.resolved=t}}function Qe(t,e,n){const o=e.slice(),{resolved:l}=t;t.current===t.then&&(o[t.value]=l),t.current===t.catch&&(o[t.error]=l),t.block.p(o,n)}function oe(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Vt(t,e){t.d(1),e.delete(t.key)}function zt(t,e,n,o,l,r,i,a,u,c,d,f){let g=t.length,_=r.length,p=g;const S={};for(;p--;)S[t[p].key]=p;const h=[],L=new Map,I=new Map,j=[];for(p=_;p--;){const x=f(l,r,p),$=n(x);let y=i.get($);y?o&&j.push(()=>y.p(x,e)):(y=c($,x),y.c()),L.set($,h[p]=y),$ in S&&I.set($,Math.abs(p-S[$]))}const E=new Set,O=new Set;function H(x){M(x,1),x.m(a,d),i.set(x.key,x),d=x.first,_--}for(;g&&_;){const x=h[_-1],$=t[g-1],y=x.key,C=$.key;x===$?(d=x.first,g--,_--):L.has(C)?!i.has(y)||E.has(y)?H(x):O.has(C)?g--:I.get(y)>I.get(C)?(O.add(y),H(x)):(E.add(C),g--):(u($,i),g--)}for(;g--;){const x=t[g];L.has(x.key)||u(x,i)}for(;_;)H(h[_-1]);return ne(j),h}function Y(t){t&&t.c()}function V(t,e,n){const{fragment:o,after_update:l}=t.$$;o&&o.m(e,n),Se(()=>{const r=t.$$.on_mount.map(Lt).filter(Ae);t.$$.on_destroy?t.$$.on_destroy.push(...r):ne(r),t.$$.on_mount=[]}),l.forEach(Se)}function z(t,e){const n=t.$$;n.fragment!==null&&(Wt(n.after_update),ne(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Zt(t,e){t.$$.dirty[0]===-1&&(be.push(t),Xt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ee(t,e,n,o,l,r,i=null,a=[-1]){const u=Te;ce(t);const c=t.$$={fragment:null,ctx:[],props:r,update:U,not_equal:l,bound:nt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:nt(),dirty:a,skip_bound:!1,root:e.target||u.$$.root};i&&i(c.root);let d=!1;if(c.ctx=n?n(t,e.props||{},(f,g,..._)=>{const p=_.length?_[0]:g;return c.ctx&&l(c.ctx[f],c.ctx[f]=p)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](p),d&&Zt(t,f)),g}):[],c.update(),d=!0,ne(c.before_update),c.fragment=o?o(c.ctx):!1,e.target){if(e.hydrate){const f=Dt(e.target);c.fragment&&c.fragment.l(f),f.forEach(k)}else c.fragment&&c.fragment.c();e.intro&&M(t.$$.fragment),V(t,e.target,e.anchor),Ke()}ce(u)}class te{constructor(){Ce(this,"$$");Ce(this,"$$set")}$destroy(){z(this,1),this.$destroy=U}$on(e,n){if(!Ae(n))return U;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const l=o.indexOf(n);l!==-1&&o.splice(l,1)}}$set(e){this.$$set&&!jt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Yt="4",ge=[];function Me(t,e=U){let n;const o=new Set;function l(a){if(K(t,a)&&(t=a,n)){const u=!ge.length;for(const c of o)c[1](),ge.push(c,t);if(u){for(let c=0;c<ge.length;c+=2)ge[c][0](ge[c+1]);ge.length=0}}}function r(a){l(a(t))}function i(a,u=U){const c=[a,u];return o.add(c),o.size===1&&(n=e(l,r)||U),a(t),()=>{o.delete(c),o.size===0&&n&&(n(),n=null)}}return{set:l,update:r,subscribe:i}}var Re=(t=>(t.info="info",t.warn="warn",t.error="error",t))(Re||{});class Kt{constructor(){Ce(this,"logs",Me([]))}_addLog(e,n){this.logs.update(o=>(o.unshift({date:new Date,severity:e,content:n}),o))}info(e){this._addLog("info",e)}warn(e){this._addLog("warn",e)}error(e){this._addLog("error",e)}updateLogAtIndex(e,n){this.logs.update(o=>(o[e]&&(o[e].content=n),o))}}const T=new Kt;function Qt(t,e){let n=!1;return t.subscribe(o=>{n?e(o):n=!0})}const en={use_dark_theme:!0,rs_plugin_loader:!1,flatpak_rich_presence:!1,runelite_use_custom_jar:!1,use_custom_rs_config_uri:!1,selected:{game:W.osrs,client:de.runelite,user_id:null},userDetails:{}};function tn(){const e=new URLSearchParams(window.location.search).get("config");function n(l){return typeof l=="object"&&typeof l.use_dark_theme=="boolean"&&typeof l.rs_plugin_loader=="boolean"&&typeof l.flatpak_rich_presence=="boolean"&&typeof l.runelite_use_custom_jar=="boolean"&&typeof l.selected=="object"&&Object.values(W).includes(l.selected.game)&&Object.values(de).includes(l.selected.client)&&(typeof l.selected.user_id=="string"||l.selected.user_id===null)&&typeof l.userDetails=="object"}const{config:o}=q;if(e)try{const l=JSON.parse(e);n(l)?o.set(l):(T.error("The config saved on disk is not the correct format. It has been restored to default."),q.configHasPendingChanges=!0)}catch{T.error("Unable to parse config, restoring to default"),q.configHasPendingChanges=!0}else G.saveConfig(!1);Qt(q.config,()=>{q.configHasPendingChanges=!0})}const q={configHasPendingChanges:!1,config:Me(en),sessions:Me([])};let We=!1;class G{static async login(e,n){const o=await je.buildSession(e,n);if(!o.ok)return X(o.error);const{config:l,sessions:r}=q,i=o.value;return G.findSession(e.sub)||(r.update(u=>(u.push(i),u)),l.update(u=>(u.selected.user_id=i.user.userId,u))),!ae(l).selected.user_id===null&&i.user.userId,le(i)}static async logout(e){const{sessions:n,config:o}=q;return n.update(l=>{const r=l.findIndex(i=>i.user.userId===e);return r>-1&&(se.revokeOauthCreds(l[r].tokens.access_token),l.splice(r,1)),l}),o.update(l=>(typeof l.userDetails[e]<"u"&&delete l.userDetails[e],l.selected.user_id===e&&(l.selected.user_id=null),l)),ae(n)}static saveConfig(e=!0){if(We||e&&!q.configHasPendingChanges)return;We=!0;const n=new XMLHttpRequest;n.open("POST","/save-config",!0),n.onreadystatechange=()=>{n.readyState==4&&(T.info(`Save config status: '${n.responseText.trim()}'`),We=!1)},n.setRequestHeader("Content-Type","application/json");const o=ae(q.config);return n.send(JSON.stringify(o)),o}static async saveCredentials(){new Promise(e=>{const n=new XMLHttpRequest;n.open("POST","/save-credentials",!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=()=>{n.readyState==4&&e(void 0)};const o=ae(q.sessions);n.send(JSON.stringify(o))})}static async openFilePicker(){return new Promise(e=>{const n=new XMLHttpRequest;n.onreadystatechange=()=>{if(n.readyState==4)return n.status==200?e(n.responseText):e(void 0)},n.open("GET","/jar-file-picker",!0),n.send()})}static findSession(e){return ae(q.sessions).find(o=>o.user.userId===e)}static findAccount(e,n){return e.find(o=>o.accountId==n)}}function nn(t,e,n){G.saveConfig();const o=(a,u)=>{const c=new XMLHttpRequest,d={},f=ae(q.config);a&&(d.hash=a),t&&(d.jx_session_id=t),e&&(d.jx_character_id=e),n&&(d.jx_display_name=n),f.rs_plugin_loader&&(d.plugin_loader="1"),f.use_custom_rs_config_uri&&f.rs_config_uri?d.config_uri=f.rs_config_uri:d.config_uri=R.env.default_config_uri,c.open("POST","/launch-rs3-deb?".concat(new URLSearchParams(d).toString()),!0),c.onreadystatechange=()=>{c.readyState==4&&(T.info(`Game launch status: '${c.responseText.trim()}'`),c.status==200&&a&&(R.rs3DebInstalledHash=a))},c.send(u)},l=new XMLHttpRequest,r=R.env.content_url,i=r.concat("dists/trusty/non-free/binary-amd64/Packages");l.open("GET",i,!0),l.onreadystatechange=()=>{if(l.readyState==4&&l.status==200){const a=Object.fromEntries(l.response.split(`
`).map(u=>u.split(": ")));if(!a.Filename||!a.Size){T.error(`Could not parse package data from URL: ${i}`),o();return}if(a.SHA256!==R.rs3DebInstalledHash){T.info("Downloading RS3 client...");const u=new XMLHttpRequest;u.open("GET",r.concat(a.Filename),!0),u.responseType="arraybuffer",u.onprogress=c=>{if(c.loaded){const d=(Math.round(1e3*c.loaded/c.total)/10).toFixed(1);T.updateLogAtIndex(0,`Downloading RS3 client... ${d}%`)}},u.onreadystatechange=()=>{u.readyState==4&&u.status==200&&o(a.SHA256,u.response)},u.onerror=()=>{T.error(`Error downloading game client: from ${i}: non-http error`),o()},u.send()}else T.info("Latest client is already installed"),o()}},l.onerror=()=>{T.error(`Error: from ${i}: non-http error`),o()},l.send()}function Tt(t,e,n,o){G.saveConfig();const l=o?"/launch-runelite-jar-configure?":"/launch-runelite-jar?",r=(u,c,d)=>{const f=new XMLHttpRequest,g={};u&&(g.id=u),d&&(g.jar_path=d),t&&(g.jx_session_id=t),e&&(g.jx_character_id=e),n&&(g.jx_display_name=n),ae(q.config).flatpak_rich_presence&&(g.flatpak_rich_presence=""),f.open(c?"POST":"GET",l.concat(new URLSearchParams(g).toString()),!0),f.onreadystatechange=()=>{f.readyState==4&&(T.info(`Game launch status: '${f.responseText.trim()}'`),f.status==200&&u&&(R.runeLiteInstalledId=u))},f.send(c)};if(ae(q.config).runelite_use_custom_jar){r(null,null,ae(q.config).runelite_custom_jar);return}const i=new XMLHttpRequest,a="https://api.github.com/repos/runelite/launcher/releases";i.open("GET",a,!0),i.onreadystatechange=()=>{if(i.readyState==4)if(i.status==200){const u=JSON.parse(i.responseText).map(c=>c.assets).flat().find(c=>c.name.toLowerCase()=="runelite.jar");if(u.id!=R.runeLiteInstalledId){T.info("Downloading RuneLite...");const c=new XMLHttpRequest;c.open("GET",u.browser_download_url,!0),c.responseType="arraybuffer",c.onreadystatechange=()=>{c.readyState==4&&(c.status==200?r(u.id,c.response):T.error(`Error downloading from ${u.url}: ${c.status}: ${c.responseText}`))},c.onprogress=d=>{if(d.loaded&&d.lengthComputable){const f=(Math.round(1e3*d.loaded/d.total)/10).toFixed(1);T.updateLogAtIndex(0,`Downloading RuneLite... ${f}%`)}},c.send()}else T.info("Latest JAR is already installed"),r()}else T.error(`Error from ${a}: ${i.status}: ${i.responseText}`)},i.send()}function sn(t,e,n){G.saveConfig();const o=(i,a)=>{const u=new XMLHttpRequest,c={};i&&(c.version=i),t&&(c.jx_session_id=t),e&&(c.jx_character_id=e),n&&(c.jx_display_name=n),u.open("POST","/launch-hdos-jar?".concat(new URLSearchParams(c).toString()),!0),u.onreadystatechange=()=>{u.readyState==4&&(T.info(`Game launch status: '${u.responseText.trim()}'`),u.status==200&&i&&(R.hdosInstalledVersion=i))},u.send(a)},l=new XMLHttpRequest,r="https://cdn.hdos.dev/client/getdown.txt";l.open("GET",r,!0),l.onreadystatechange=()=>{if(l.readyState==4)if(l.status==200){const i=l.responseText.match(/^launcher\.version *= *(.*?)$/m);if(i&&i.length>=2){const a=i[1];if(a!==R.hdosInstalledVersion){const u=`https://cdn.hdos.dev/launcher/v${a}/hdos-launcher.jar`;T.info("Downloading HDOS...");const c=new XMLHttpRequest;c.open("GET",u,!0),c.responseType="arraybuffer",c.onreadystatechange=()=>{if(c.readyState==4)if(c.status==200)o(a,c.response);else{const d=JSON.parse(l.responseText).map(f=>f.assets).flat().find(f=>f.name.toLowerCase()=="runelite.jar");T.error(`Error downloading from ${d.url}: ${c.status}: ${c.responseText}`)}},c.onprogress=d=>{if(d.loaded&&d.lengthComputable){const f=(Math.round(1e3*d.loaded/d.total)/10).toFixed(1);T.updateLogAtIndex(0,`Downloading HDOS... ${f}%`)}},c.send()}else T.info("Latest JAR is already installed"),o()}else T.info("Couldn't parse latest launcher version"),o()}else T.error(`Error from ${r}: ${l.status}: ${l.responseText}`)},l.send()}function It(){return new Promise((t,e)=>{const n=new XMLHttpRequest;n.open("GET","/list-game-clients",!0),n.onreadystatechange=()=>{if(n.readyState==4)if(n.status==200&&n.getResponseHeader("content-type")==="application/json"){const o=JSON.parse(n.responseText);t(Object.keys(o).map(l=>({uid:l,identity:o[l].identity||null})))}else e(`error (${n.responseText})`)},n.send()})}function on(){const t=new XMLHttpRequest;t.open("POST","/save-plugin-config",!0),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=()=>{t.readyState==4&&T.info(`Save-plugin-config status: ${t.responseText.trim()}`)},t.send(JSON.stringify(R.pluginList))}async function ot(t,e,n,o,l){G.saveConfig();const r=`${e?"osrs":R.env.provider}-${t?"win":"mac"}`;let i=t?e?R.osrsExeInstalledHash:R.rs3ExeInstalledHash:e?R.osrsAppInstalledHash:R.rs3AppInstalledHash;const a=async(x,$)=>{const y={};x&&(y.hash=x),n&&(y.jx_session_id=n),o&&(y.jx_character_id=o),l&&(y.jx_display_name=l);const C=await fetch(`/launch-${e?"osrs":"rs3"}-${t?"exe":"app"}?${new URLSearchParams(y).toString()}`,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:await $});C.text().then(A=>T.info(`Game launch status: '${A.trim()}'`)),C.status==200&&x&&(i=x)},u=`${R.env.direct6_url}${r}/${r}.json`,c=await fetch(u,{method:"GET"}),d=await c.text();if(c.status!==200){T.error(`Error from ${u}: ${c.status}: ${d}`);return}const f=JSON.parse(atob(d.split(".")[1])).environments.production;if(i===f.id){T.info("Latest client is already installed"),a();return}T.info(`Downloading client version ${f.version}`);const g=`${R.env.direct6_url}${r}/catalog/${f.id}/catalog.json`,_=await fetch(g,{method:"GET"}),p=await _.text();if(_.status!==200){T.error(`Error from ${g}: ${_.status}: ${p}`);return}const S=JSON.parse(atob(p.split(".")[1])),h=S.metafile.replace(/^http:/i,"https:"),L=await fetch(h,{method:"GET"}),I=await L.text();if(L.status!==200){T.error(`Error from ${h}: ${L.status}: ${I}`);return}const j=JSON.parse(atob(I.split(".")[1])),E=j.pieces.digests.map(x=>{const $=atob(x).split("").map(C=>C.charCodeAt(0).toString(16).padStart(2,"0")).join(""),y=S.config.remote.baseUrl.replace(/^http:/i,"https:").concat(S.config.remote.pieceFormat.replace("{SubString:0,2,{TargetDigest}}",$.substring(0,2)).replace("{TargetDigest}",$));return fetch(y,{method:"GET"}).then(C=>C.blob().then(A=>{const B=new DecompressionStream("gzip");return new Response(A.slice(6).stream().pipeThrough(B)).blob()}))});let O=0,H=null;for(let x=0;x<j.files.length;x+=1)if(t?j.files[x].name.endsWith(".exe"):j.files[x].name.includes(".app/Contents/MacOS/"))if(H!==null){T.error(`Error parsing ${h}: file list has multiple possibilities for main exe`);return}else H=j.files[x].size;else H===null&&(O+=j.files[x].size);if(H===null){T.error(`Error parsing ${h}: file list has no possibilities for main exe`);return}Promise.all(E).then(x=>{const $=new Blob(x).slice(O,O+H);a(j.id,$.arrayBuffer())})}const Ze=Me();typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Yt);function ln(t){let e,n;const o=t[4].default,l=De(o,t,t[3],null);return{c(){e=b("main"),l&&l.c(),m(e,"class","fixed top-0 h-screen w-screen bg-slate-100 text-xs text-slate-900 duration-200 sm:text-sm md:text-base dark:bg-slate-900 dark:text-slate-50"),F(e,"dark",t[0])},m(r,i){w(r,e,i),l&&l.m(e,null),n=!0},p(r,[i]){l&&l.p&&(!n||i&8)&&Be(l,o,r,r[3],n?qe(o,r[3],i,null):Ge(r[3]),null),(!n||i&1)&&F(e,"dark",r[0])},i(r){n||(M(l,r),n=!0)},o(r){D(l,r),n=!1},d(r){r&&k(e),l&&l.d(r)}}}function rn(t,e,n){let o,l,{$$slots:r={},$$scope:i}=e;const{config:a}=q;return re(t,a,u=>n(2,l=u)),t.$$set=u=>{"$$scope"in u&&n(3,i=u.$$scope)},t.$$.update=()=>{t.$$.dirty&4&&n(0,o=l.use_dark_theme)},[o,a,l,i,r]}class Pt extends te{constructor(e){super(),ee(this,e,rn,ln,K,{})}}function an(t){let e;return{c(){e=b("div"),e.innerHTML='<img class="h-60 w-60 animate-spin" src="svgs/circle-notch-solid.svg" alt="loading"/>',m(e,"class","flex h-full items-center justify-center")},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function cn(t){let e,n;return e=new Pt({props:{$$slots:{default:[an]},$$scope:{ctx:t}}}),{c(){Y(e.$$.fragment)},m(o,l){V(e,o,l),n=!0},p(o,[l]){const r={};l&32&&(r.$$scope={dirty:l,ctx:o}),e.$set(r)},i(o){n||(M(e.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),n=!1},d(o){z(e,o)}}}function un(t){const e=window.opener;R.env==null&&l("BoltEnv is not defined. Please close and re-open Bolt to try again.");async function n(i){const a=ke.get("auth_verifier");if(!a)return l("Verifier token has expired. Please try signing in again."),null;const{clientid:u,redirect:c}=R.env,d=await se.getOAuthToken(R.env.origin,u,a,c,i);return d.ok?d.value:(l(`Fetching OAuth token failed. ${d.error}`),null)}async function o(i){const a=ke.get("auth_nonce"),u=se.validateIdToken(i,a??"");if(!u.ok)return l(u.error),null;const c=await se.getSessionId(R.env.auth_api,i);return c.ok?c.value:(l(`Unable to retreive session id. ${c.error}`),null)}function l(i){r({type:"authFailed",reason:i}),window.close()}function r(i){e.postMessage(i,window.location.origin)}return xt(async()=>{const i=new URLSearchParams(window.location.search),a=i.get("code"),u=i.get("state"),c=i.get("id_token");if(c==null&&a&&u){const d=await n(a);if(!d)return l("tokens object is null.");r({type:"authTokenUpdate",tokens:d});const f=crypto.randomUUID();se.navigateToAuthConsent(R.env.origin,d.id_token,f)}else if(c&&a&&u){const d=await o(c);if(!d)return l("sessionId is null");r({type:"authSessionUpdate",sessionId:d}),window.close()}else l("Authentication server did not response with the appropriate parameters. Please try again later.")}),Bt(()=>{ke.remove("auth_verifier"),ke.remove("auth_nonce")}),[]}class dn extends te{constructor(e){super(),ee(this,e,un,cn,K,{})}}function lt(t){let e,n,o;return{c(){e=b("button"),e.innerHTML='<img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/>',m(e,"class","absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75")},m(l,r){w(l,e,r),n||(o=N(e,"click",t[8]),n=!0)},p:U,d(l){l&&k(e),n=!1,o()}}}function rt(t){let e;const n=t[7].default,o=De(n,t,t[6],null);return{c(){o&&o.c()},m(l,r){o&&o.m(l,r),e=!0},p(l,r){o&&o.p&&(!e||r&64)&&Be(o,n,l,l[6],e?qe(n,l[6],r,null):Ge(l[6]),null)},i(l){e||(M(o,l),e=!0)},o(l){D(o,l),e=!1},d(l){o&&o.d(l)}}}function fn(t){let e,n,o,l,r,i,a=t[1]&&lt(t),u=t[3]&&rt(t);return{c(){e=b("dialog"),a&&a.c(),n=P(),u&&u.c(),m(e,"class",o=t[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"),F(e,"backdrop:cursor-pointer",t[1])},m(c,d){w(c,e,d),a&&a.m(e,null),v(e,n),u&&u.m(e,null),t[9](e),l=!0,r||(i=[N(e,"keydown",t[10]),N(e,"mousedown",At(t[11]))],r=!0)},p(c,[d]){c[1]?a?a.p(c,d):(a=lt(c),a.c(),a.m(e,n)):a&&(a.d(1),a=null),c[3]?u?(u.p(c,d),d&8&&M(u,1)):(u=rt(c),u.c(),M(u,1),u.m(e,null)):u&&(Oe(),D(u,1,1,()=>{u=null}),He()),(!l||d&1&&o!==(o=c[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"))&&m(e,"class",o),(!l||d&3)&&F(e,"backdrop:cursor-pointer",c[1])},i(c){l||(M(u),l=!0)},o(c){D(u),l=!1},d(c){c&&k(e),a&&a.d(),u&&u.d(),t[9](null),r=!1,ne(i)}}}function pn(t,e,n){let{$$slots:o={},$$scope:l}=e,{class:r=""}=e,{canSelfClose:i=!0}=e,a,u=!1;const c=Gt();function d(){a.showModal(),n(3,u=!0)}function f(){c("close"),a.close(),n(3,u=!1)}const g=()=>a.close();function _(h){ue[h?"unshift":"push"](()=>{a=h,n(2,a)})}const p=h=>{h.key==="Escape"&&!i&&h.preventDefault()},S=()=>{i&&a.close()};return t.$$set=h=>{"class"in h&&n(0,r=h.class),"canSelfClose"in h&&n(1,i=h.canSelfClose),"$$scope"in h&&n(6,l=h.$$scope)},[r,i,a,u,d,f,l,o,g,_,p,S]}class et extends te{constructor(e){super(),ee(this,e,pn,fn,K,{class:0,canSelfClose:1,open:4,close:5})}get open(){return this.$$.ctx[4]}get close(){return this.$$.ctx[5]}}function _n(t){let e,n,o,l,r,i,a;return{c(){e=b("p"),e.textContent=`${atob("Qm9sdCBpcyBhbiB1bm9mZmljaWFsIHRoaXJkLXBhcnR5IGxhdW5jaGVyLiBJdCdzIGZyZWUgYW5kIG9wZW4tc291cmNlIHNvZnR3YXJlIGxpY2Vuc2VkIHVuZGVyIEFHUEwgMy4wLg==")}`,n=P(),o=b("p"),o.textContent=`${atob("SmFnZXggaXMgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgcHJvYmxlbXMgb3IgZGFtYWdlIGNhdXNlZCBieSB1c2luZyB0aGlzIHByb2R1Y3Qu")}`,l=P(),r=b("button"),r.textContent="I Understand",m(e,"class","p-2"),m(o,"class","p-2"),m(r,"class","m-5 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75")},m(u,c){w(u,e,c),w(u,n,c),w(u,o,c),w(u,l,c),w(u,r,c),i||(a=N(r,"click",t[2]),i=!0)},p:U,d(u){u&&(k(e),k(n),k(o),k(l),k(r)),i=!1,a()}}}function gn(t){let e,n,o={canSelfClose:!1,class:"w-1/2 text-center",$$slots:{default:[_n]},$$scope:{ctx:t}};return e=new et({props:o}),t[3](e),{c(){Y(e.$$.fragment)},m(l,r){V(e,l,r),n=!0},p(l,[r]){const i={};r&33&&(i.$$scope={dirty:r,ctx:l}),e.$set(i)},i(l){n||(M(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){t[3](null),z(e,l)}}}function hn(t,e,n){let o;const{sessions:l}=q;re(t,l,u=>n(4,o=u));let r;xt(()=>{o.length==0&&r.open()});const i=()=>r.close();function a(u){ue[u?"unshift":"push"](()=>{r=u,n(0,r)})}return[r,l,i,a]}class mn extends te{constructor(e){super(),ee(this,e,hn,gn,K,{})}}function it(t,e,n){const o=t.slice();return o[24]=e[n][0],o[23]=e[n][1],o}function at(t,e,n){const o=t.slice();return o[28]=e[n],o}function bn(t){let e;return{c(){e=b("p"),e.textContent="error"},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function kn(t){let e;function n(r,i){return r[27].length==0?yn:wn}let o=n(t),l=o(t);return{c(){l.c(),e=fe()},m(r,i){l.m(r,i),w(r,e,i)},p(r,i){o===(o=n(r))&&l?l.p(r,i):(l.d(1),l=o(r),l&&(l.c(),l.m(e.parentNode,e)))},d(r){r&&k(e),l.d(r)}}}function wn(t){let e,n=oe(t[27]),o=[];for(let l=0;l<n.length;l+=1)o[l]=ct(at(t,n,l));return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=fe()},m(l,r){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,r);w(l,e,r)},p(l,r){if(r[0]&70){n=oe(l[27]);let i;for(i=0;i<n.length;i+=1){const a=at(l,n,i);o[i]?o[i].p(a,r):(o[i]=ct(a),o[i].c(),o[i].m(e.parentNode,e))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(l){l&&k(e),Pe(o,l)}}}function yn(t){let e;return{c(){e=b("p"),e.textContent="(start an RS3 game client with plugins enabled and it will be listed here.)"},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function ct(t){let e,n=(t[28].identity||ft)+"",o,l,r,i,a,u;function c(){return t[14](t[28])}return{c(){e=b("button"),o=J(n),r=P(),i=b("br"),m(e,"class",l="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(t[6]&&t[1]===t[28].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")},m(d,f){w(d,e,f),v(e,o),w(d,r,f),w(d,i,f),a||(u=N(e,"click",c),a=!0)},p(d,f){t=d,f[0]&4&&n!==(n=(t[28].identity||ft)+"")&&ie(o,n),f[0]&70&&l!==(l="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(t[6]&&t[1]===t[28].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")&&m(e,"class",l)},d(d){d&&(k(e),k(r),k(i)),a=!1,u()}}}function vn(t){let e;return{c(){e=b("p"),e.textContent="loading..."},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function $n(t){let e;return{c(){e=b("p"),e.textContent="error"},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function Sn(t){let e,n,o,l,r,i=oe(Object.entries(t[3].pluginList)),a=[];for(let f=0;f<i.length;f+=1)a[f]=ut(it(t,i,f));function u(f,g){return f[6]?Ln:Cn}let c=u(t),d=c(t);return{c(){e=b("select");for(let f=0;f<a.length;f+=1)a[f].c();n=P(),d.c(),o=fe(),m(e,"class","mx-auto mb-4 w-[min(280px,_45%)] cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),t[0]===void 0&&Se(()=>t[15].call(e))},m(f,g){w(f,e,g);for(let _=0;_<a.length;_+=1)a[_]&&a[_].m(e,null);$e(e,t[0],!0),w(f,n,g),d.m(f,g),w(f,o,g),l||(r=N(e,"change",t[15]),l=!0)},p(f,g){if(g[0]&8){i=oe(Object.entries(f[3].pluginList));let _;for(_=0;_<i.length;_+=1){const p=it(f,i,_);a[_]?a[_].p(p,g):(a[_]=ut(p),a[_].c(),a[_].m(e,null))}for(;_<a.length;_+=1)a[_].d(1);a.length=i.length}g[0]&9&&$e(e,f[0]),c===(c=u(f))&&d?d.p(f,g):(d.d(1),d=c(f),d&&(d.c(),d.m(o.parentNode,o)))},d(f){f&&(k(e),k(n),k(o)),Pe(a,f),d.d(f),l=!1,r()}}}function ut(t){let e,n=(t[23].name??Ie)+"",o,l;return{c(){e=b("option"),o=J(n),m(e,"class","dark:bg-slate-900"),e.__value=l=t[24],Q(e,e.__value)},m(r,i){w(r,e,i),v(e,o)},p(r,i){i[0]&8&&n!==(n=(r[23].name??Ie)+"")&&ie(o,n),i[0]&8&&l!==(l=r[24])&&(e.__value=l,Q(e,e.__value))},d(r){r&&k(e)}}}function Ln(t){let e,n,o,l,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Hn,then:xn,catch:Rn,value:23};return Le(l=t[8],r),{c(){e=b("br"),n=P(),o=fe(),r.block.c()},m(i,a){w(i,e,a),w(i,n,a),w(i,o,a),r.block.m(i,r.anchor=a),r.mount=()=>o.parentNode,r.anchor=o},p(i,a){t=i,r.ctx=t,a[0]&256&&l!==(l=t[8])&&Le(l,r)||Qe(r,t,a)},d(i){i&&(k(e),k(n),k(o)),r.block.d(i),r.token=null,r=null}}}function Cn(t){let e,n,o,l,r,i,a,u,c;function d(_,p){return p[0]&8&&(i=null),i==null&&(i=Object.entries(_[3].pluginList).length!==0),i?Un:En}let f=d(t,[-1,-1]),g=f(t);return{c(){e=b("button"),n=J("+"),o=P(),l=b("br"),r=P(),g.c(),a=fe(),m(e,"class","aspect-square w-8 rounded-lg border-2 border-blue-500 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:border-gray-500"),e.disabled=t[5]},m(_,p){w(_,e,p),v(e,n),w(_,o,p),w(_,l,p),w(_,r,p),g.m(_,p),w(_,a,p),u||(c=N(e,"click",t[10]),u=!0)},p(_,p){p[0]&32&&(e.disabled=_[5]),f===(f=d(_,p))&&g?g.p(_,p):(g.d(1),g=f(_),g&&(g.c(),g.m(a.parentNode,a)))},d(_){_&&(k(e),k(o),k(l),k(r),k(a)),g.d(_),u=!1,c()}}}function Rn(t){let e;return{c(){e=b("p"),e.textContent="error"},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function xn(t){let e,n;function o(i,a){return a[0]&265&&(e=null),e==null&&(e=!!(i[23]&&i[23].main&&Object.keys(i[3].pluginList).includes(i[0]))),e?In:Tn}let l=o(t,[-1,-1]),r=l(t);return{c(){r.c(),n=fe()},m(i,a){r.m(i,a),w(i,n,a)},p(i,a){l===(l=o(i,a))&&r?r.p(i,a):(r.d(1),r=l(i),r&&(r.c(),r.m(n.parentNode,n)))},d(i){i&&k(n),r.d(i)}}}function Tn(t){let e;return{c(){e=b("p"),e.textContent="can't start plugin: does not appear to be configured"},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function In(t){let e;function n(r,i){return r[3].pluginList[r[0]].path?On:Pn}let o=n(t),l=o(t);return{c(){l.c(),e=fe()},m(r,i){l.m(r,i),w(r,e,i)},p(r,i){o===(o=n(r))&&l?l.p(r,i):(l.d(1),l=o(r),l&&(l.c(),l.m(e.parentNode,e)))},d(r){r&&k(e),l.d(r)}}}function Pn(t){let e;return{c(){e=b("p"),e.textContent="can't start plugin: no path is configured"},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function On(t){let e,n,o=t[23].name+"",l,r,i;function a(){return t[18](t[23])}return{c(){e=b("button"),n=J("Start "),l=J(o),m(e,"class","mx-auto mb-1 w-auto rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75")},m(u,c){w(u,e,c),v(e,n),v(e,l),r||(i=N(e,"click",a),r=!0)},p(u,c){t=u,c[0]&256&&o!==(o=t[23].name+"")&&ie(l,o)},d(u){u&&k(e),r=!1,i()}}}function Hn(t){let e;return{c(){e=b("p"),e.textContent="loading..."},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function En(t){let e;return{c(){e=b("p"),e.textContent=`You have no plugins installed. Click the + button and select a plugin's bolt.json file
						to add it.`},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function Un(t){let e=Object.keys(t[3].pluginList).includes(t[0])&&t[8]!==null,n,o=e&&dt(t);return{c(){o&&o.c(),n=fe()},m(l,r){o&&o.m(l,r),w(l,n,r)},p(l,r){r[0]&265&&(e=Object.keys(l[3].pluginList).includes(l[0])&&l[8]!==null),e?o?o.p(l,r):(o=dt(l),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},d(l){l&&k(n),o&&o.d(l)}}}function dt(t){let e,n,o,l,r,i,a,u={ctx:t,current:null,token:null,hasCatch:!0,pending:Mn,then:jn,catch:Nn,value:23};return Le(e=t[8],u),{c(){u.block.c(),n=P(),o=b("button"),o.textContent="Remove",l=P(),r=b("button"),r.textContent="Reload",m(o,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-rose-500 enabled:hover:opacity-75 disabled:bg-gray-500"),m(r,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(c,d){u.block.m(c,u.anchor=d),u.mount=()=>n.parentNode,u.anchor=n,w(c,n,d),w(c,o,d),w(c,l,d),w(c,r,d),i||(a=[N(o,"click",t[16]),N(r,"click",t[17])],i=!0)},p(c,d){t=c,u.ctx=t,d[0]&256&&e!==(e=t[8])&&Le(e,u)||Qe(u,t,d)},d(c){c&&(k(n),k(o),k(l),k(r)),u.block.d(c),u.token=null,u=null,i=!1,ne(a)}}}function Nn(t){let e,n,o;return{c(){e=b("p"),e.textContent="error",n=P(),o=b("br")},m(l,r){w(l,e,r),w(l,n,r),w(l,o,r)},p:U,d(l){l&&(k(e),k(n),k(o))}}}function jn(t){let e,n=(t[23].name??Ie)+"",o,l,r,i=(t[23].description??"no description")+"",a,u,c,d;return{c(){e=b("p"),o=J(n),l=P(),r=b("p"),a=J(i),c=P(),d=b("br"),m(e,"class","pb-4 text-xl font-bold"),m(r,"class",u=t[23].description?null:"italic")},m(f,g){w(f,e,g),v(e,o),w(f,l,g),w(f,r,g),v(r,a),w(f,c,g),w(f,d,g)},p(f,g){g[0]&256&&n!==(n=(f[23].name??Ie)+"")&&ie(o,n),g[0]&256&&i!==(i=(f[23].description??"no description")+"")&&ie(a,i),g[0]&256&&u!==(u=f[23].description?null:"italic")&&m(r,"class",u)},d(f){f&&(k(e),k(l),k(r),k(c),k(d))}}}function Mn(t){let e;return{c(){e=b("p"),e.textContent="loading..."},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function An(t){let e,n,o,l,r,i,a,u,c,d,f,g,_={ctx:t,current:null,token:null,hasCatch:!0,pending:vn,then:kn,catch:bn,value:27};Le(u=t[2],_);function p(L,I){return L[3].hasBoltPlugins?Sn:$n}let S=p(t),h=S(t);return{c(){e=b("div"),n=b("button"),o=J("Manage Plugins"),r=P(),i=b("hr"),a=P(),_.block.c(),c=P(),d=b("div"),h.c(),m(n,"class",l="mx-auto mb-2 w-[95%] rounded-lg border-2 "+(t[6]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75"),m(i,"class","p-1 dark:border-slate-700"),m(e,"class","left-0 float-left h-full w-[min(180px,_50%)] overflow-hidden border-r-2 border-slate-300 pt-2 dark:border-slate-800"),m(d,"class","h-full pt-10")},m(L,I){w(L,e,I),v(e,n),v(n,o),v(e,r),v(e,i),v(e,a),_.block.m(e,_.anchor=null),_.mount=()=>e,_.anchor=null,w(L,c,I),w(L,d,I),h.m(d,null),f||(g=N(n,"click",t[13]),f=!0)},p(L,I){t=L,I[0]&64&&l!==(l="mx-auto mb-2 w-[95%] rounded-lg border-2 "+(t[6]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75")&&m(n,"class",l),_.ctx=t,I[0]&4&&u!==(u=t[2])&&Le(u,_)||Qe(_,t,I),S===(S=p(t))&&h?h.p(t,I):(h.d(1),h=S(t),h&&(h.c(),h.m(d,null)))},d(L){L&&(k(e),k(c),k(d)),_.block.d(),_.token=null,_=null,h.d(),f=!1,g()}}}function Dn(t){let e,n,o={class:"h-[90%] w-[90%] text-center",$$slots:{default:[An]},$$scope:{ctx:t}};return e=new et({props:o}),t[19](e),e.$on("close",t[20]),{c(){Y(e.$$.fragment)},m(l,r){V(e,l,r),n=!0},p(l,r){const i={};r[0]&495|r[1]&1&&(i.$$scope={dirty:r,ctx:l}),e.$set(i)},i(l){n||(M(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){t[19](null),z(e,l)}}}const Ie="(unnamed)",ft="(new character)";function qn(t,e,n){let o,l;re(t,Ze,y=>n(2,l=y));let r;function i(){r.open()}const a=y=>new Promise((C,A)=>{const B=y.concat(y.endsWith("/")?"bolt.json":"/bolt.json");var Z=new XMLHttpRequest;Z.onreadystatechange=()=>{Z.readyState==4&&(Z.status==200?C(JSON.parse(Z.responseText)):A(Z.responseText))},Z.open("GET","/read-json-file?".concat(new URLSearchParams({path:B}).toString()),!0),Z.send()}),u=y=>{const A=R.pluginList[y];if(!A)return null;const B=A.path;return B?a(B):null},c=(y,C)=>{a(y).then(A=>{do n(0,_=crypto.randomUUID());while(Object.keys(R.pluginList).includes(_));n(3,R.pluginList[_]={name:A.name??Ie,path:y},R),n(7,h=!0)}).catch(A=>{console.error(`Config file '${C}' couldn't be fetched, reason: ${A}`)})};let d=!1;const f=()=>{n(5,d=!0);var y=new XMLHttpRequest;y.onreadystatechange=()=>{if(y.readyState==4&&(n(5,d=!1),y.status==200)){const C=R.platform==="windows"?y.responseText.replaceAll("\\","/"):y.responseText;if(C.endsWith("/bolt.json")){const A=C.substring(0,C.length-9);c(A,C)}else console.log(`Selection '${C}' is not named bolt.json; ignored`)}},y.open("GET","/json-file-picker",!0),y.send()};Ze.set(It());const g=(y,C,A,B)=>{var Z=new XMLHttpRequest;Z.onreadystatechange=()=>{Z.readyState==4&&T.info(`Start-plugin status: ${Z.statusText.trim()}`)},Z.open("GET","/start-plugin?".concat(new URLSearchParams({client:y,id:C,path:A,main:B}).toString()),!0),Z.send()};var _,p=!1,S;let h=!1;const L=()=>n(6,p=!1),I=y=>{n(1,S=y.uid),n(6,p=!0)};function j(){_=Ye(this),n(0,_),n(3,R)}const E=()=>{n(8,o=null),n(7,h=!0);let y=R.pluginList;delete y[_],n(3,R.pluginList=y,R)},O=()=>n(8,o=u(_)),H=y=>g(S,_,R.pluginList[_].path??"",y.main??"");function x(y){ue[y?"unshift":"push"](()=>{r=y,n(4,r)})}const $=()=>{h&&on()};return t.$$.update=()=>{t.$$.dirty[0]&6&&l.then(y=>{y.some(C=>C.uid===S)||n(6,p=!1)}),t.$$.dirty[0]&1&&n(8,o=u(_))},[_,S,l,R,r,d,p,h,o,u,f,g,i,L,I,j,E,O,H,x,$]}class Bn extends te{constructor(e){super(),ee(this,e,qn,Dn,K,{open:12},null,[-1,-1])}get open(){return this.$$.ctx[12]}}function pt(t,e,n){const o=t.slice();return o[12]=e[n],o}function _t(t,e,n){const o=t.slice();return o[15]=e[n],o}function Gn(t){let e,n,o={};return e=new Bn({props:o}),t[8](e),{c(){Y(e.$$.fragment)},m(l,r){V(e,l,r),n=!0},p(l,r){const i={};e.$set(i)},i(l){n||(M(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){t[8](null),z(e,l)}}}function Jn(t){let e,n,o;return{c(){e=b("button"),e.textContent="Plugin menu",e.disabled=!R.hasBoltPlugins,m(e,"title",R.hasBoltPlugins?null:"Coming soon..."),m(e,"class","w-52 rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(l,r){w(l,e,r),n||(o=N(e,"click",t[11]),n=!0)},p:U,d(l){l&&k(e),n=!1,o()}}}function Xn(t){let e,n,o,l,r,i,a=oe(tt[t[0].selected.game]),u=[];for(let c=0;c<a.length;c+=1)u[c]=gt(_t(t,a,c));return{c(){e=b("label"),n=b("span"),n.textContent="Game Client",o=P(),l=b("select");for(let c=0;c<u.length;c+=1)u[c].c();m(n,"class","text-sm"),m(l,"id","game_client_select"),m(l,"class","w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),t[0].selected.client===void 0&&Se(()=>t[10].call(l)),m(e,"class","flex flex-col")},m(c,d){w(c,e,d),v(e,n),v(e,o),v(e,l);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(l,null);$e(l,t[0].selected.client,!0),r||(i=N(l,"change",t[10]),r=!0)},p(c,d){if(d&1){a=oe(tt[c[0].selected.game]);let f;for(f=0;f<a.length;f+=1){const g=_t(c,a,f);u[f]?u[f].p(g,d):(u[f]=gt(g),u[f].c(),u[f].m(l,null))}for(;f<u.length;f+=1)u[f].d(1);u.length=a.length}d&1&&$e(l,c[0].selected.client)},d(c){c&&k(e),Pe(u,c),r=!1,i()}}}function gt(t){let e,n=t[15]+"",o,l,r;return{c(){e=b("option"),o=J(n),m(e,"class","dark:bg-slate-900"),e.disabled=l=t[15]===de.official&&R.platform==xe.Linux,e.__value=r=t[15],Q(e,e.__value)},m(i,a){w(i,e,a),v(e,o)},p(i,a){a&1&&n!==(n=i[15]+"")&&ie(o,n),a&1&&l!==(l=i[15]===de.official&&R.platform==xe.Linux)&&(e.disabled=l),a&1&&r!==(r=i[15])&&(e.__value=r,Q(e,e.__value))},d(i){i&&k(e)}}}function ht(t){let e;return{c(){e=b("option"),e.textContent="No characters",m(e,"class","dark:bg-slate-900"),e.disabled=!0,e.selected=!0,e.__value="No characters",Q(e,e.__value)},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function Fn(t){let e;return{c(){e=J("New Character")},m(n,o){w(n,e,o)},p:U,d(n){n&&k(e)}}}function Wn(t){let e=t[12].displayName+"",n;return{c(){n=J(e)},m(o,l){w(o,n,l)},p(o,l){l&8&&e!==(e=o[12].displayName+"")&&ie(n,e)},d(o){o&&k(n)}}}function mt(t){let e,n,o,l;function r(u,c){return u[12].displayName?Wn:Fn}let i=r(t),a=i(t);return{c(){e=b("option"),a.c(),n=P(),e.selected=o=t[2]===t[12].accountId,e.__value=l=t[12].accountId,Q(e,e.__value),m(e,"class","dark:bg-slate-900")},m(u,c){w(u,e,c),a.m(e,null),v(e,n)},p(u,c){i===(i=r(u))&&a?a.p(u,c):(a.d(1),a=i(u),a&&(a.c(),a.m(e,n))),c&12&&o!==(o=u[2]===u[12].accountId)&&(e.selected=o),c&8&&l!==(l=u[12].accountId)&&(e.__value=l,Q(e,e.__value))},d(u){u&&k(e),a.d()}}}function Vn(t){let e,n,o,l,r,i,a,u,c,d,f,g,_,p,S,h,L,I,j=R.hasBoltPlugins&&Gn(t);function E(C,A){if(C[0].selected.game==W.osrs)return Xn;if(C[0].selected.game===W.rs3)return Jn}let O=E(t),H=O&&O(t),x=oe(t[3]),$=[];for(let C=0;C<x.length;C+=1)$[C]=mt(pt(t,x,C));let y=null;return x.length||(y=ht()),{c(){j&&j.c(),e=P(),n=b("div"),o=b("div"),l=b("img"),i=P(),a=b("button"),a.textContent="Play",u=P(),H&&H.c(),c=P(),d=b("label"),f=b("span"),f.textContent="Character",g=P(),_=b("select"),p=b("option"),p.textContent="Select an account";for(let C=0;C<$.length;C+=1)$[C].c();y&&y.c(),Nt(l.src,r="svgs/rocket-solid.svg")||m(l,"src",r),m(l,"alt","Launch icon"),m(l,"class","mb-3 w-24 rounded-3xl bg-gradient-to-br from-rose-500 to-violet-500 p-5"),m(a,"class","w-52 rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75"),m(f,"class","text-sm"),p.disabled=!0,p.selected=!0,m(p,"class","dark:bg-slate-900"),p.__value="Select an account",Q(p,p.__value),m(_,"id","character_select"),m(_,"class","mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),_.disabled=S=t[0].selected.user_id===null,m(d,"class","flex flex-col"),m(o,"class","flex flex-col items-center gap-4"),m(n,"class","bg-grad flex h-full flex-col border-slate-300 p-5 duration-200 dark:border-slate-800")},m(C,A){j&&j.m(C,A),w(C,e,A),w(C,n,A),v(n,o),v(o,l),v(o,i),v(o,a),v(o,u),H&&H.m(o,null),v(o,c),v(o,d),v(d,f),v(d,g),v(d,_),v(_,p);for(let B=0;B<$.length;B+=1)$[B]&&$[B].m(_,null);y&&y.m(_,null),h=!0,L||(I=[N(a,"click",t[9]),N(_,"change",t[6])],L=!0)},p(C,[A]){if(R.hasBoltPlugins&&j.p(C,A),O===(O=E(C))&&H?H.p(C,A):(H&&H.d(1),H=O&&O(C),H&&(H.c(),H.m(o,c))),A&12){x=oe(C[3]);let B;for(B=0;B<x.length;B+=1){const Z=pt(C,x,B);$[B]?$[B].p(Z,A):($[B]=mt(Z),$[B].c(),$[B].m(_,null))}for(;B<$.length;B+=1)$[B].d(1);$.length=x.length,!x.length&&y?y.p(C,A):x.length?y&&(y.d(1),y=null):(y=ht(),y.c(),y.m(_,null))}(!h||A&1&&S!==(S=C[0].selected.user_id===null))&&(_.disabled=S)},i(C){h||(M(j),h=!0)},o(C){D(j),h=!1},d(C){C&&(k(e),k(n)),j&&j.d(C),H&&H.d(),Pe($,C),y&&y.d(),L=!1,ne(I)}}}function zn(t,e,n){let o,l,r,i,a,{config:u}=q;re(t,u,S=>n(0,i=S));function c(S,h){if(!o)return T.warn("Please log in or select a user to play.");if(!l)return T.warn("Please select a character from the select menu.");const L=G.findSession(i.selected.user_id);if(!L)return T.warn("Unable to launch game, session was not found.");const{session_id:I}=L,j=G.findAccount(L.accounts,l);if(!j)return T.warn("Unable to launch game, account was not found.");const{accountId:E,displayName:O}=j,H=R.platform===xe.Windows,x=R.platform===xe.Linux;switch(S){case W.osrs:switch(h){case de.official:ot(H,!0,I,E,O);break;case de.runelite:Tt(I,E,O,!1);break;case de.hdos:sn(I,E,O);break}break;case W.rs3:x?nn(I,E,O):ot(H,!1,I,E,O);break}}function d(S){const h=S.target.value;if(!o)return;const L=i.userDetails[o];L?(L.account_id=h,ye(u,i.userDetails[o]=L,i)):ye(u,i.userDetails[o]={account_id:h},i)}function f(S){ue[S?"unshift":"push"](()=>{a=S,n(1,a)})}const g=()=>c(i.selected.game,i.selected.client);function _(){i.selected.client=Ye(this),u.set(i)}const p=()=>{a.open()};return t.$$.update=()=>{var S,h;t.$$.dirty&1&&n(7,o=i.selected.user_id),t.$$.dirty&129&&n(2,l=(S=i.userDetails[o??""])==null?void 0:S.account_id),t.$$.dirty&1&&n(3,r=((h=G.findSession(i.selected.user_id))==null?void 0:h.accounts)??[])},[i,a,l,r,u,c,d,o,f,g,_,p]}class Zn extends te{constructor(e){super(),ee(this,e,zn,Vn,K,{})}}function bt(t,e,n){const o=t.slice();return o[1]=e[n].date,o[2]=e[n].severity,o[3]=e[n].content,o}function kt(t){var u;let e,n=((u=t[1])==null?void 0:u.toLocaleTimeString())+"",o,l,r=t[3]+"",i,a;return{c(){e=b("li"),o=J(n),l=J(`
				- `),i=J(r),a=P(),F(e,"text-rose-500",t[2]===Re.error),F(e,"text-orange-700",t[2]===Re.warn)},m(c,d){w(c,e,d),v(e,o),v(e,l),v(e,i),v(e,a)},p(c,d){var f;d&1&&n!==(n=((f=c[1])==null?void 0:f.toLocaleTimeString())+"")&&ie(o,n),d&1&&r!==(r=c[3]+"")&&ie(i,r),d&1&&F(e,"text-rose-500",c[2]===Re.error),d&1&&F(e,"text-orange-700",c[2]===Re.warn)},d(c){c&&k(e)}}}function Yn(t){let e,n,o,l,r=oe(t[0]),i=[];for(let a=0;a<r.length;a+=1)i[a]=kt(bt(t,r,a));return{c(){e=b("div"),n=b("div"),n.innerHTML='<img src="svgs/circle-info-solid.svg" alt="Message list icon" class="h-7 w-7 rounded-full bg-blue-500 p-[3px] duration-200"/>',o=P(),l=b("ol");for(let a=0;a<i.length;a+=1)i[a].c();m(n,"class","absolute right-6 top-2"),m(l,"id","message_list"),m(l,"class","h-full list-inside list-disc overflow-y-auto pl-5 pt-1 marker:text-blue-500"),m(e,"class","fixed bottom-0 h-1/4 w-screen border-t-2 border-t-slate-300 bg-slate-100 duration-200 dark:border-t-slate-800 dark:bg-slate-900")},m(a,u){w(a,e,u),v(e,n),v(e,o),v(e,l);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(l,null)},p(a,[u]){if(u&1){r=oe(a[0]);let c;for(c=0;c<r.length;c+=1){const d=bt(a,r,c);i[c]?i[c].p(d,u):(i[c]=kt(d),i[c].c(),i[c].m(l,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i:U,o:U,d(a){a&&k(e),Pe(i,a)}}}function Kn(t,e,n){let{logs:o}=e;return t.$$set=l=>{"logs"in l&&n(0,o=l.logs)},[o]}class Qn extends te{constructor(e){super(),ee(this,e,Kn,Yn,K,{logs:0})}}function wt(t,e,n){const o=t.slice();return o[7]=e[n],o}function yt(t,e){let n,o=e[7].user.displayName+"",l,r;return{key:t,first:null,c(){n=b("option"),l=J(o),n.__value=r=e[7].user.userId,Q(n,n.__value),m(n,"class","dark:bg-slate-900"),this.first=n},m(i,a){w(i,n,a),v(n,l)},p(i,a){e=i,a&2&&o!==(o=e[7].user.displayName+"")&&ie(l,o),a&2&&r!==(r=e[7].user.userId)&&(n.__value=r,Q(n,n.__value))},d(i){i&&k(n)}}}function es(t){let e,n,o=[],l=new Map,r,i,a,u,c,d,f,g,_,p=oe(t[1]);const S=h=>h[7].user.userId;for(let h=0;h<p.length;h+=1){let L=wt(t,p,h),I=S(L);l.set(I,o[h]=yt(I,L))}return{c(){e=b("select"),n=b("option"),n.textContent="Select a user";for(let h=0;h<o.length;h+=1)o[h].c();r=P(),i=b("div"),a=b("button"),a.textContent="Log In",u=P(),c=b("button"),d=J("Log Out"),n.__value=null,Q(n,n.__value),n.disabled=!0,m(n,"class","dark:bg-slate-900"),m(e,"class","w-full cursor-pointer rounded-lg border-2 border-inherit bg-inherit p-2 text-center"),t[0].selected.user_id===void 0&&Se(()=>t[4].call(e)),m(a,"class","mx-auto mr-2 rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),m(c,"class","mx-auto rounded-lg border-2 border-blue-500 p-2 font-bold duration-200 hover:opacity-75"),c.disabled=f=!t[0].selected.user_id,m(i,"class","mt-5 flex")},m(h,L){w(h,e,L),v(e,n);for(let I=0;I<o.length;I+=1)o[I]&&o[I].m(e,null);$e(e,t[0].selected.user_id,!0),w(h,r,L),w(h,i,L),v(i,a),v(i,u),v(i,c),v(c,d),g||(_=[N(e,"change",t[4]),N(a,"click",t[5]),N(c,"click",t[6])],g=!0)},p(h,[L]){L&2&&(p=oe(h[1]),o=zt(o,L,S,1,h,p,l,e,Vt,yt,null,wt)),L&3&&$e(e,h[0].selected.user_id),L&3&&f!==(f=!h[0].selected.user_id)&&(c.disabled=f)},i:U,o:U,d(h){h&&(k(e),k(r),k(i));for(let L=0;L<o.length;L+=1)o[L].d();g=!1,ne(_)}}}function ts(t,e,n){let o,l;const{sessions:r,config:i}=q;re(t,r,d=>n(1,l=d)),re(t,i,d=>n(0,o=d));function a(){o.selected.user_id=Ye(this),i.set(o)}return[o,l,r,i,a,()=>{const{origin:d,redirect:f,clientid:g}=R.env;se.openLoginWindow(d,f,g)},async()=>{o.selected.user_id&&(await G.logout(o.selected.user_id),G.saveCredentials())}]}class ns extends te{constructor(e){super(),ee(this,e,ts,es,K,{})}}function ss(t,{callback:e,ignore:n=[]}){const o=l=>{const r=n.some(i=>i.contains(l.target));t&&!t.contains(l.target)&&!l.defaultPrevented&&!r&&e()};return document.addEventListener("click",o,!0),document.addEventListener("contextmenu",o,!0),{destroy(){document.removeEventListener("click",o,!0),document.removeEventListener("contextmenu",o,!0)}}}const os=t=>({}),vt=t=>({});function $t(t){let e,n,o,l,r,i;const a=t[9].content,u=De(a,t,t[8],vt);return{c(){e=b("div"),u&&u.c(),m(e,"class",n="dropdown-color absolute z-20 rounded-lg border-2 "+t[1]+" "+t[2]+" svelte-xifudk")},m(c,d){w(c,e,d),u&&u.m(e,null),l=!0,r||(i=Mt(o=ss.call(null,e,{callback:t[3],ignore:[t[5]]})),r=!0)},p(c,d){u&&u.p&&(!l||d&256)&&Be(u,a,c,c[8],l?qe(a,c[8],d,os):Ge(c[8]),vt),(!l||d&6&&n!==(n="dropdown-color absolute z-20 rounded-lg border-2 "+c[1]+" "+c[2]+" svelte-xifudk"))&&m(e,"class",n),o&&Ae(o.update)&&d&32&&o.update.call(null,{callback:c[3],ignore:[c[5]]})},i(c){l||(M(u,c),l=!0)},o(c){D(u,c),l=!1},d(c){c&&k(e),u&&u.d(c),r=!1,i()}}}function ls(t){let e,n,o,l,r,i,a;const u=t[9].default,c=De(u,t,t[8],null);let d=t[4]&&$t(t);return{c(){e=b("div"),n=b("button"),c&&c.c(),o=P(),d&&d.c(),m(e,"class",l="relative h-fit w-fit "+t[0]+" svelte-xifudk")},m(f,g){w(f,e,g),v(e,n),c&&c.m(n,null),t[10](n),v(e,o),d&&d.m(e,null),r=!0,i||(a=N(n,"click",t[6]),i=!0)},p(f,[g]){c&&c.p&&(!r||g&256)&&Be(c,u,f,f[8],r?qe(u,f[8],g,null):Ge(f[8]),null),f[4]?d?(d.p(f,g),g&16&&M(d,1)):(d=$t(f),d.c(),M(d,1),d.m(e,null)):d&&(Oe(),D(d,1,1,()=>{d=null}),He()),(!r||g&1&&l!==(l="relative h-fit w-fit "+f[0]+" svelte-xifudk"))&&m(e,"class",l)},i(f){r||(M(c,f),M(d),r=!0)},o(f){D(c,f),D(d),r=!1},d(f){f&&k(e),c&&c.d(f),t[10](null),d&&d.d(),i=!1,a()}}}function rs(t,e,n){let{$$slots:o={},$$scope:l}=e,{class:r=""}=e,{position:i="bottom"}=e,{align:a="start"}=e,u=!1,c;function d(){n(4,u=!0)}function f(){n(4,u=!1)}function g(){u?f():d()}function _(p){ue[p?"unshift":"push"](()=>{c=p,n(5,c)})}return t.$$set=p=>{"class"in p&&n(0,r=p.class),"position"in p&&n(1,i=p.position),"align"in p&&n(2,a=p.align),"$$scope"in p&&n(8,l=p.$$scope)},[r,i,a,f,u,c,g,d,l,o,_]}class is extends te{constructor(e){super(),ee(this,e,rs,ls,K,{class:0,position:1,align:2,open:7,close:3})}get open(){return this.$$.ctx[7]}get close(){return this.$$.ctx[3]}}function as(t){let e,n,o;return{c(){e=b("button"),e.innerHTML=`<div class="flex"><img src="svgs/database-solid.svg" alt="Browse app data" class="mr-2 h-7 w-7 rounded-lg bg-violet-500 p-1"/>
		Browse App Data</div>`,m(e,"id","data_dir_button"),m(e,"class","p-2 hover:opacity-75")},m(l,r){w(l,e,r),n||(o=N(e,"click",t[1]),n=!0)},p:U,i:U,o:U,d(l){l&&k(e),n=!1,o()}}}function cs(t){function e(){var o=new XMLHttpRequest;o.open("GET","/browse-data"),o.onreadystatechange=()=>{o.readyState==4&&T.info(`Browse status: '${o.responseText.trim()}'`)},o.send()}return[e,()=>{e()}]}class us extends te{constructor(e){super(),ee(this,e,cs,as,K,{})}}function ds(t){let e,n,o,l,r,i,a,u,c,d,f,g,_,p,S,h,L,I,j;return{c(){var E,O;e=b("button"),n=b("div"),n.innerHTML=`<img src="svgs/wrench-solid.svg" alt="Configure RuneLite" class="mr-2 h-7 w-7 rounded-lg bg-pink-500 p-1"/>
		Configure RuneLite`,l=P(),r=b("div"),i=b("label"),i.textContent="Use custom RuneLite JAR:",a=P(),u=b("input"),c=P(),d=b("div"),f=b("textarea"),_=P(),p=b("br"),S=P(),h=b("button"),L=J("Select File"),m(n,"class","flex"),e.disabled=o=!((E=t[0])!=null&&E.session_id)||!((O=t[3])!=null&&O.accountId),m(e,"class","p-2 pb-5 hover:opacity-75"),m(i,"for","use_custom_jar"),m(u,"type","checkbox"),m(u,"class","ml-2"),m(r,"class","mx-auto border-t-2 border-slate-300 p-2 pt-5 dark:border-slate-800"),m(f,"class","h-10 rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),f.disabled=g=!t[1].runelite_use_custom_jar,m(h,"class","mt-1 rounded-lg border-2 border-blue-500 p-1 duration-200 hover:opacity-75"),h.disabled=t[2],m(d,"class","mx-auto p-2"),F(d,"opacity-25",!t[1].runelite_use_custom_jar)},m(E,O){w(E,e,O),v(e,n),w(E,l,O),w(E,r,O),v(r,i),v(r,a),v(r,u),u.checked=t[1].runelite_use_custom_jar,w(E,c,O),w(E,d,O),v(d,f),Q(f,t[1].runelite_custom_jar),v(d,_),v(d,p),v(d,S),v(d,h),v(h,L),I||(j=[N(e,"click",t[7]),N(u,"change",t[8]),N(f,"input",t[9]),N(h,"click",t[10])],I=!0)},p(E,[O]){var H,x;O&9&&o!==(o=!((H=E[0])!=null&&H.session_id)||!((x=E[3])!=null&&x.accountId))&&(e.disabled=o),O&2&&(u.checked=E[1].runelite_use_custom_jar),O&2&&g!==(g=!E[1].runelite_use_custom_jar)&&(f.disabled=g),O&2&&Q(f,E[1].runelite_custom_jar),O&4&&(h.disabled=E[2]),O&2&&F(d,"opacity-25",!E[1].runelite_use_custom_jar)},i:U,o:U,d(E){E&&(k(e),k(l),k(r),k(c),k(d)),I=!1,ne(j)}}}function fs(t,e,n){let o,l,r;const{config:i}=q;re(t,i,p=>n(1,r=p));let a=!1;async function u(){n(2,a=!0),ye(i,r.runelite_custom_jar=await G.openFilePicker(),r),console.log("done picking"),n(2,a=!1)}function c(){!(o!=null&&o.session_id)||!(l!=null&&l.accountId)||!(l!=null&&l.displayName)||Tt(o.session_id,l.accountId,l.displayName,!0)}const d=()=>c();function f(){r.runelite_use_custom_jar=this.checked,i.set(r)}function g(){r.runelite_custom_jar=this.value,i.set(r)}const _=()=>{u()};return t.$$.update=()=>{var p;t.$$.dirty&2&&n(0,o=G.findSession(r.selected.user_id)),t.$$.dirty&3&&n(3,l=G.findAccount((o==null?void 0:o.accounts)??[],(p=r.userDetails[r.selected.user_id??""])==null?void 0:p.account_id))},[o,r,a,l,i,u,c,d,f,g,_]}class ps extends te{constructor(e){super(),ee(this,e,fs,ds,K,{})}}function _s(t){let e,n,o,l,r,i;return{c(){e=b("div"),n=b("label"),n.textContent="Enable Bolt plugin loader:",o=P(),l=b("input"),m(n,"for","enable_plugins"),m(l,"type","checkbox"),m(l,"name","enable_plugins"),m(l,"id","enable_plugins"),m(l,"class","ml-2"),m(e,"class","mx-auto p-2")},m(a,u){w(a,e,u),v(e,n),v(e,o),v(e,l),l.checked=t[0].rs_plugin_loader,r||(i=N(l,"change",t[2]),r=!0)},p(a,u){u&1&&(l.checked=a[0].rs_plugin_loader)},d(a){a&&k(e),r=!1,i()}}}function gs(t){let e,n,o,l,r,i,a,u,c,d,f,g=R.hasBoltPlugins&&_s(t);return{c(){g&&g.c(),e=P(),n=b("div"),o=b("label"),o.textContent="Use custom config URI:",l=P(),r=b("input"),i=P(),a=b("div"),u=b("textarea"),m(o,"for","use_custom_uri"),m(r,"type","checkbox"),m(r,"class","ml-2"),m(n,"class","mx-auto p-2"),m(u,"class","rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),u.disabled=c=!t[0].use_custom_rs_config_uri,m(u,"rows","4"),m(u,"placeholder",R.env.default_config_uri),m(a,"class","p-2")},m(_,p){g&&g.m(_,p),w(_,e,p),w(_,n,p),v(n,o),v(n,l),v(n,r),r.checked=t[0].use_custom_rs_config_uri,w(_,i,p),w(_,a,p),v(a,u),Q(u,t[0].rs_config_uri),d||(f=[N(r,"change",t[3]),N(u,"input",t[4])],d=!0)},p(_,[p]){R.hasBoltPlugins&&g.p(_,p),p&1&&(r.checked=_[0].use_custom_rs_config_uri),p&1&&c!==(c=!_[0].use_custom_rs_config_uri)&&(u.disabled=c),p&1&&Q(u,_[0].rs_config_uri)},i:U,o:U,d(_){_&&(k(e),k(n),k(i),k(a)),g&&g.d(_),d=!1,ne(f)}}}function hs(t,e,n){let o;const{config:l}=q;re(t,l,u=>n(0,o=u));function r(){o.rs_plugin_loader=this.checked,l.set(o)}function i(){o.use_custom_rs_config_uri=this.checked,l.set(o)}function a(){o.rs_config_uri=this.value,l.set(o)}return[o,l,r,i,a]}class ms extends te{constructor(e){super(),ee(this,e,hs,gs,K,{})}}function bs(t){let e,n;return e=new ms({}),{c(){Y(e.$$.fragment)},m(o,l){V(e,o,l),n=!0},i(o){n||(M(e.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),n=!1},d(o){z(e,o)}}}function ks(t){let e,n;return e=new ps({}),{c(){Y(e.$$.fragment)},m(o,l){V(e,o,l),n=!0},i(o){n||(M(e.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),n=!1},d(o){z(e,o)}}}function ws(t){let e,n;return e=new us({}),{c(){Y(e.$$.fragment)},m(o,l){V(e,o,l),n=!0},i(o){n||(M(e.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),n=!1},d(o){z(e,o)}}}function ys(t){let e,n,o,l,r,i,a,u,c,d,f,g,_,p,S,h,L,I,j,E;const O=[ws,ks,bs],H=[];function x($,y){return $[1]==$[2].general?0:$[1]==$[2].osrs?1:$[1]==$[2].rs3?2:-1}return~(h=x(t))&&(L=H[h]=O[h](t)),{c(){e=b("div"),n=b("div"),o=b("button"),l=J("General"),i=P(),a=b("button"),u=J("OSRS"),d=P(),f=b("button"),g=J("RS3"),p=P(),S=b("div"),L&&L.c(),m(o,"class",r=t[1]===t[2].general?he:me),m(a,"class",c=t[1]===t[2].osrs?he:me),m(f,"class",_=t[1]===t[2].rs3?he:me),m(n,"class","flex flex-col items-center gap-2 border-r-2 border-slate-300 pt-10 dark:border-slate-800"),m(S,"class","col-span-3 p-5 pt-10 text-center"),m(e,"class","grid h-full grid-cols-4")},m($,y){w($,e,y),v(e,n),v(n,o),v(o,l),v(n,i),v(n,a),v(a,u),v(n,d),v(n,f),v(f,g),v(e,p),v(e,S),~h&&H[h].m(S,null),I=!0,j||(E=[N(o,"click",t[4]),N(a,"click",t[5]),N(f,"click",t[6])],j=!0)},p($,y){(!I||y&2&&r!==(r=$[1]===$[2].general?he:me))&&m(o,"class",r),(!I||y&2&&c!==(c=$[1]===$[2].osrs?he:me))&&m(a,"class",c),(!I||y&2&&_!==(_=$[1]===$[2].rs3?he:me))&&m(f,"class",_);let C=h;h=x($),h!==C&&(L&&(Oe(),D(H[C],1,1,()=>{H[C]=null}),He()),~h?(L=H[h],L||(L=H[h]=O[h]($),L.c()),M(L,1),L.m(S,null)):L=null)},i($){I||(M(L),I=!0)},o($){D(L),I=!1},d($){$&&k(e),~h&&H[h].d(),j=!1,ne(E)}}}function vs(t){let e,n,o={class:"h-3/4 w-3/4",$$slots:{default:[ys]},$$scope:{ctx:t}};return e=new et({props:o}),t[7](e),{c(){Y(e.$$.fragment)},m(l,r){V(e,l,r),n=!0},p(l,[r]){const i={};r&258&&(i.$$scope={dirty:r,ctx:l}),e.$set(i)},i(l){n||(M(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){t[7](null),z(e,l)}}}let he="border-2 border-blue-500 bg-blue-500 hover:opacity-75 font-bold text-black duration-200 rounded-lg p-1 w-3/4",me="border-2 border-blue-500 hover:opacity-75 duration-200 rounded-lg p-1 w-3/4";function $s(t,e,n){let o;function l(){o.open()}var r=(f=>(f[f.general=0]="general",f[f.osrs=1]="osrs",f[f.rs3=2]="rs3",f))(r||{});let i=1;const a=()=>{n(1,i=r.general)},u=()=>{n(1,i=r.osrs)},c=()=>{n(1,i=r.rs3)};function d(f){ue[f?"unshift":"push"](()=>{o=f,n(0,o)})}return[o,i,r,l,a,u,c,d]}class Ss extends te{constructor(e){super(),ee(this,e,$s,vs,K,{open:3})}get open(){return this.$$.ctx[3]}}function Ls(t){const e=t.slice(),n=G.findSession(e[1].selected.user_id??"");return e[11]=n,e}function Cs(t){let e,n,o;return{c(){e=b("button"),e.textContent="Login",m(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit p-2 text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(l,r){w(l,e,r),n||(o=N(e,"click",t[10]),n=!0)},p:U,i:U,o:U,d(l){l&&k(e),n=!1,o()}}}function Rs(t){let e,n;return e=new is({props:{align:"center",$$slots:{content:[Ts],default:[xs]},$$scope:{ctx:t}}}),{c(){Y(e.$$.fragment)},m(o,l){V(e,o,l),n=!0},p(o,l){const r={};l&4098&&(r.$$scope={dirty:l,ctx:o}),e.$set(r)},i(o){n||(M(e.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),n=!1},d(o){z(e,o)}}}function xs(t){var l;let e,n=(((l=t[11])==null?void 0:l.user.displayName)??"No user selected")+"",o;return{c(){e=b("button"),o=J(n),m(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(r,i){w(r,e,i),v(e,o)},p(r,i){var a;i&2&&n!==(n=(((a=r[11])==null?void 0:a.user.displayName)??"No user selected")+"")&&ie(o,n)},d(r){r&&k(e)}}}function Ts(t){let e,n,o;return n=new ns({}),{c(){e=b("div"),Y(n.$$.fragment),m(e,"slot","content"),m(e,"class","w-40")},m(l,r){w(l,e,r),V(n,e,null),o=!0},p:U,i(l){o||(M(n.$$.fragment,l),o=!0)},o(l){D(n.$$.fragment,l),o=!1},d(l){l&&k(e),z(n)}}}function Is(t){let e,n,o,l,r,i,a,u,c,d,f,g,_,p,S,h,L,I,j={};e=new Ss({props:j}),t[5](e);const E=[Rs,Cs],O=[];function H($,y){return $[2].length>0?0:1}function x($,y){return y===0?Ls($):$}return p=H(t),S=O[p]=E[p](x(t,p)),{c(){Y(e.$$.fragment),n=P(),o=b("div"),l=b("div"),r=b("button"),r.textContent="RS3",i=P(),a=b("button"),a.textContent="OSRS",u=P(),c=b("div"),d=b("button"),d.innerHTML='<img src="svgs/lightbulb-solid.svg" class="m-auto h-6 w-6" alt="Change Theme"/>',f=P(),g=b("button"),g.innerHTML='<img src="svgs/gear-solid.svg" class="m-auto h-6 w-6" alt="Settings"/>',_=P(),S.c(),m(r,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75"),F(r,"text-black",t[1].selected.game===W.rs3),F(r,"bg-blue-500",t[1].selected.game===W.rs3),m(a,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 bg-blue-500 p-2 text-black duration-200 hover:opacity-75"),F(a,"text-black",t[1].selected.game===W.osrs),F(a,"bg-blue-500",t[1].selected.game===W.osrs),m(l,"class","m-3 ml-9 font-bold"),m(d,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),m(g,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),m(c,"class","m-2 ml-auto flex gap-2"),m(o,"class","fixed top-0 flex h-16 w-screen border-b-2 border-slate-300 bg-slate-100 duration-200 dark:border-slate-800 dark:bg-slate-900")},m($,y){V(e,$,y),w($,n,y),w($,o,y),v(o,l),v(l,r),v(l,i),v(l,a),v(o,u),v(o,c),v(c,d),v(c,f),v(c,g),v(c,_),O[p].m(c,null),h=!0,L||(I=[N(r,"click",t[6]),N(a,"click",t[7]),N(d,"click",t[8]),N(g,"click",t[9])],L=!0)},p($,[y]){const C={};e.$set(C),(!h||y&2)&&F(r,"text-black",$[1].selected.game===W.rs3),(!h||y&2)&&F(r,"bg-blue-500",$[1].selected.game===W.rs3),(!h||y&2)&&F(a,"text-black",$[1].selected.game===W.osrs),(!h||y&2)&&F(a,"bg-blue-500",$[1].selected.game===W.osrs);let A=p;p=H($),p===A?O[p].p(x($,p),y):(Oe(),D(O[A],1,1,()=>{O[A]=null}),He(),S=O[p],S?S.p(x($,p),y):(S=O[p]=E[p](x($,p)),S.c()),M(S,1),S.m(c,null))},i($){h||(M(e.$$.fragment,$),M(S),h=!0)},o($){D(e.$$.fragment,$),D(S),h=!1},d($){$&&(k(n),k(o)),t[5](null),z(e,$),O[p].d(),L=!1,ne(I)}}}function Ps(t,e,n){let o,l;const{config:r,sessions:i}=q;re(t,r,p=>n(1,o=p)),re(t,i,p=>n(2,l=p));let a;function u(p){ue[p?"unshift":"push"](()=>{a=p,n(0,a)})}return[a,o,l,r,i,u,()=>{ye(r,o.selected.game=W.rs3,o)},()=>{ye(r,o.selected.game=W.osrs,o)},()=>ye(r,o.use_dark_theme=!o.use_dark_theme,o),()=>a.open(),()=>{const{origin:p,redirect:S,clientid:h}=R.env;se.openLoginWindow(p,S,h)}]}class Os extends te{constructor(e){super(),ee(this,e,Ps,Is,K,{})}}function Hs(t){let e,n,o,l,r,i,a,u,c,d,f,g,_;return e=new mn({}),o=new Os({}),u=new Zn({}),g=new Qn({props:{logs:t[0]}}),{c(){Y(e.$$.fragment),n=P(),Y(o.$$.fragment),l=P(),r=b("div"),i=b("div"),a=P(),Y(u.$$.fragment),c=P(),d=b("div"),f=P(),Y(g.$$.fragment),m(r,"class","mt-16 grid h-full grid-flow-col grid-cols-3")},m(p,S){V(e,p,S),w(p,n,S),V(o,p,S),w(p,l,S),w(p,r,S),v(r,i),v(r,a),V(u,r,null),v(r,c),v(r,d),w(p,f,S),V(g,p,S),_=!0},p(p,S){const h={};S&1&&(h.logs=p[0]),g.$set(h)},i(p){_||(M(e.$$.fragment,p),M(o.$$.fragment,p),M(u.$$.fragment,p),M(g.$$.fragment,p),_=!0)},o(p){D(e.$$.fragment,p),D(o.$$.fragment,p),D(u.$$.fragment,p),D(g.$$.fragment,p),_=!1},d(p){p&&(k(n),k(l),k(r),k(f)),z(e,p),z(o,p),z(u),z(g,p)}}}function Es(t){let e,n,o,l;return e=new Pt({props:{$$slots:{default:[Hs]},$$scope:{ctx:t}}}),{c(){Y(e.$$.fragment)},m(r,i){V(e,r,i),n=!0,o||(l=N(window,"beforeunload",t[2]),o=!0)},p(r,[i]){const a={};i&9&&(a.$$scope={dirty:i,ctx:r}),e.$set(a)},i(r){n||(M(e.$$.fragment,r),n=!0)},o(r){D(e.$$.fragment,r),n=!1},d(r){z(e,r),o=!1,l()}}}function Us(t,e,n){let o;const l=T.logs;return re(t,l,i=>n(0,o=i)),[o,l,()=>G.saveConfig()]}class Ns extends te{constructor(e){super(),ee(this,e,Us,Es,K,{})}}const St={target:document.getElementById("app")};window.opener||window.location.search.includes("&id_token")?new dn(St):(js(),tn(),Ms(),As(),new Ns(St));function js(){const t=new URLSearchParams(window.location.search);R.platform=t.get("platform"),R.isFlathub=t.get("flathub")==="1",R.rs3DebInstalledHash=t.get("rs3_deb_installed_hash"),R.rs3ExeInstalledHash=t.get("rs3_exe_installed_hash"),R.rs3AppInstalledHash=t.get("rs3_app_installed_hash"),R.osrsExeInstalledHash=t.get("osrs_exe_installed_hash"),R.osrsAppInstalledHash=t.get("osrs_app_installed_hash"),R.runeLiteInstalledId=t.get("runelite_installed_id"),R.hdosInstalledVersion=t.get("hdos_installed_version");const e=t.get("plugins");if(R.hasBoltPlugins=e!==null,e!==null)try{R.pluginList=JSON.parse(e)}catch{T.error("Unable to parse plugin list")}const n=t.get("credentials");if(n)try{const o=JSON.parse(n),l=o.every(r=>typeof r.session_id=="string"&&typeof r.tokens=="object"&&typeof r.accounts=="object"&&typeof r.user=="object");l?q.sessions.set(o):(q.sessions.set([]),G.saveCredentials(),T.warn("Credentials saved on disk are out of date. Please sign in again.")),q.sessions.set(l?o:[])}catch{q.sessions.set([]),G.saveCredentials(),T.error("Unable to parse saved credentials. Please sign in again.")}}function Ms(){const{origin:t,origin_2fa:e}=R.env,n=[window.location.origin,t,e];let o=null;window.addEventListener("message",async l=>{var r;if(!n.includes(l.origin)){T.info(`discarding window message from origin ${l.origin}`);return}switch(l.data.type){case"authTokenUpdate":{o=l.data.tokens;break}case"authSessionUpdate":{if(o===null)return T.error("auth is null. Please try again.");const i=l.data.sessionId,a=await G.login(o,i);a.ok?T.info(`Added new user '${a.value.user.displayName}'`):T.error(`Unable to add new user. Please try again. ${a.error}`),G.saveCredentials(),se.pendingLoginWindow=null,o=null;break}case"authFailed":{T.error(`Unable to authenticate: ${l.data.reason}`),se.pendingLoginWindow=null,o=null;break}case"externalUrl":{const i=new XMLHttpRequest;i.onreadystatechange=()=>{i.readyState==4&&T.info(`External URL status: '${i.responseText.trim()}'`)},i.open("POST","/open-external-url",!0),i.send(l.data.url);break}case"gameClientListUpdate":Ze.set(It());break;default:{const i=((r=l.data)==null?void 0:r.type)??"no type provided";T.info(`Unknown message type: ${i}`);break}}})}async function As(){const t=ae(q.sessions),e=[];for(const n of t){const o=await se.refreshOAuthToken(n.tokens);if(!o.ok){o.error===0?T.error(`Unable to verify saved login, status: ${o.error}. Do you have an internet connection? Please relaunch Bolt to try again.`):(T.error(`Discarding expired login, status: ${o.error}. Please sign in again.`),e.push(n.tokens.sub));continue}const l=o.value;n.tokens=l;const r=await G.login(l,n.session_id);r.ok?T.info(`Signed into saved user '${r.value.user.displayName}'`):(T.error(`Unable to sign into saved user '${n.user.displayName}' - please sign in again. ${r.error}`),e.push(n.tokens.sub))}e.forEach(n=>{G.logout(n)}),q.sessions.set(t),G.saveCredentials()}
