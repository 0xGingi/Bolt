var Ut=Object.defineProperty;var Nt=(n,e,t)=>e in n?Ut(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var xe=(n,e,t)=>(Nt(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(l){if(l.ep)return;l.ep=!0;const r=t(l);fetch(l.href,r)}})();var Ze=(n=>(n[n.SECOND=1e3]="SECOND",n[n.MINUTE=6e4]="MINUTE",n[n.HALF_HOUR=18e5]="HALF_HOUR",n[n.HOUR=36e5]="HOUR",n[n.DAY=864e5]="DAY",n[n.WEEK=6048e5]="WEEK",n[n.MONTH=2592e6]="MONTH",n))(Ze||{});class ve{static set(e,t,o,l){const r=new Date;r.setTime(r.getTime()+o*l);const i=`expires=${r.toUTCString()}`;document.cookie=`${e}=${t};${i};path=/`}static get(e){const t=`${e}=`,o=document.cookie.split(";");for(let l=0;l<o.length;l++){let r=o[l];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(t)===0)return r.substring(t.length,r.length)}return null}static remove(e){document.cookie=`${e}=; Max-Age=-99999999;`}}function re(n){return{ok:!0,value:n}}function F(n){return{ok:!1,error:n}}var V=(n=>(n.rs3="rs3",n.osrs="osrs",n))(V||{}),pe=(n=>(n.official="Official",n.runelite="RuneLite",n.hdos="HDOS",n))(pe||{});const st={rs3:["Official"],osrs:["Official","RuneLite","HDOS"]};class je{static parseTokenResponse(e){try{const t=JSON.parse(e),o=t.id_token.split(".");if(o.length!==3){const i=`Malformed id_token: ${o.length} sections, expected 3`;return F(i)}const l=JSON.parse(atob(o[0]));if(l.typ!=="JWT"){const i=`Bad id_token header: typ ${l.typ}, expected JWT`;return F(i)}const r=JSON.parse(atob(o[1]));return re({access_token:t.access_token,id_token:t.id_token,refresh_token:t.refresh_token,sub:r.sub,expiry:Date.now()+t.expires_in*1e3})}catch{return F("Unable to parse token response")}}static parseSessionResponse(e){try{const t=JSON.parse(e);return t.sessionId?re(t.sessionId):F("sessionId does not exist on parsed object")}catch{return F("Unable to parse session response")}}static decodeBolt(e){const t={};for(const o in e){const l=o,r=e[l];typeof r=="string"?t[l]=atob(r):Array.isArray(r)&&r.every(i=>typeof i=="string")?t[l]=r.map(i=>atob(i)):t[l]=r}return t}}var Pe=(n=>(n.Windows="windows",n.Linux="linux",n.MacOS="mac",n))(Pe||{});const R={env:je.decodeBolt(s()),platform:null,rs3DebInstalledHash:null,rs3ExeInstalledHash:null,rs3AppInstalledHash:null,osrsExeInstalledHash:null,osrsAppInstalledHash:null,runeLiteInstalledId:null,hdosInstalledVersion:null,isFlathub:!1,hasBoltPlugins:!1,pluginList:{}};class We{static async makeLoginUrl(e){const t=new TextEncoder().encode(e.pkceCodeVerifier),o=await crypto.subtle.digest("SHA-256",t);let l="";const r=new Uint8Array(o);for(let a=0;a<r.byteLength;a++)l+=String.fromCharCode(r[a]);const i=btoa(l).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return e.origin.concat("/oauth2/auth?").concat(new URLSearchParams({auth_method:e.authMethod,login_type:e.loginType,flow:e.flow,response_type:"code",client_id:e.clientid,redirect_uri:e.redirect,code_challenge:i,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:e.pkceState}).toString())}static makeRandomVerifier(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=new Uint32Array(43);return crypto.getRandomValues(t),Array.from(t,function(o){return e[o%e.length]}).join("")}static makeRandomState(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",o=t.length-1,l=crypto.getRandomValues(new Uint8Array(12));return Array.from(l).map(r=>Math.round(r*(o-0)/255+0)).map(r=>t[r]).join("")}}const $e=class $e{static async openLoginWindow(e,t,o){if($e.pendingLoginWindow!==null)return $e.pendingLoginWindow.window.focus();const l=We.makeRandomState(),r=We.makeRandomVerifier(),i=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",i);let u="";const c=new Uint8Array(a);for(let g=0;g<c.byteLength;g++)u+=String.fromCharCode(c[g]);const d=btoa(u).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),f=new URLSearchParams({auth_method:"",login_type:"",flow:"launcher",response_type:"code",client_id:o,redirect_uri:t,code_challenge:d,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:l}),_=`${e}/oauth2/auth?${f.toString()}`;ve.set("auth_verifier",r,10,Ze.MINUTE),$e.pendingLoginWindow=window.open(_,"","width=480,height=720")}static navigateToAuthConsent(e,t,o){const l=We.makeRandomState(),r=new URLSearchParams({id_token_hint:t,nonce:o,prompt:"consent",redirect_uri:"http://localhost",response_type:"id_token code",state:l,client_id:"1fddee4e-b100-4f4e-b2b0-097f9088f9d2",scope:"openid offline"}),i=`${e}/oauth2/auth?${r.toString()}`;ve.set("auth_nonce",o,10,Ze.MINUTE),window.location.href=i}static async refreshOAuthToken(e){return new Promise(t=>{if(e.expiry-Date.now()<3e4){const o=new URLSearchParams({grant_type:"refresh_token",client_id:R.env.clientid,refresh_token:e.refresh_token}),l=new XMLHttpRequest;l.onreadystatechange=()=>{if(l.readyState==4)if(l.status==200){const i=je.parseTokenResponse(l.response);i.ok?t(re(i.value)):t(F(0))}else t(F(l.status))},l.onerror=()=>{t(F(0))};const r=R.env.origin.concat("/oauth2/token");l.open("POST",r,!0),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.setRequestHeader("Accept","application/json"),l.send(o)}else t(re(e))})}static async getOAuthToken(e,t,o,l,r){const i=`${e}/oauth2/token`;return new Promise(a=>{const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(u.readyState==4)if(u.status==200){const d=je.parseTokenResponse(u.response);return d.ok?a(re(d.value)):a(F(d.error))}else return a(F(`Error: from ${i}: ${u.status}: ${u.response}`))},u.open("POST",i,!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.setRequestHeader("Accept","application/json");const c=new URLSearchParams({grant_type:"authorization_code",client_id:t,code:r,code_verifier:o,redirect_uri:l});u.send(c)})}static revokeOauthCreds(e){const t=`${R.env.origin}/oauth2/revoke`;return new Promise(o=>{const l=new XMLHttpRequest;l.open("POST",t,!0),l.onreadystatechange=()=>{l.readyState==4&&o(l.status)},l.setRequestHeader("Content-Type","application/x-www-form-urlencoded");const r=new URLSearchParams({token:e,client_id:R.env.clientid});l.send(r)})}static async getSessionId(e,t){const o=`${e}/sessions`;return new Promise(l=>{const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const a=je.parseSessionResponse(r.response);return a.ok?l(re(a.value)):l(F(a.error))}else F(`Error: from ${o}: ${r.status}: ${r.response}`)},r.open("POST",o,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json");const i={idToken:t};r.send(JSON.stringify(i))})}static validateIdToken(e,t){const o=e.split(".");if(o.length!==3)return F(`Malformed id_token: ${o.length} sections, expected 3`);const l=JSON.parse(atob(o[0]));return l.typ!=="JWT"?F(`Bad id_token header: typ ${l.typ}, expected JWT`):JSON.parse(atob(o[1])).nonce!==t?F("Incorrect nonce in id_token"):re(void 0)}};xe($e,"pendingLoginWindow",null);let oe=$e;class Ae{static async buildSession(e,t){const o=await Ae.getUser(e.sub,e.access_token);if(!o.ok)return F(`Failed to fetch user. Status: ${o.error}`);const l=await Ae.getUserAccounts(t);return l.ok?re({user:o.value,accounts:l.value,tokens:e,session_id:t}):F(`Failed to fetch game accounts. Status: ${l.error}`)}static getUser(e,t){return new Promise(o=>{const l=`${R.env.api}/users/${e}/displayName`,r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const i=JSON.parse(r.response);o(re(i))}else o(F(r.status))},r.open("GET",l,!0),r.setRequestHeader("Authorization","Bearer ".concat(t)),r.send()})}static getUserAccounts(e){const t=`${R.env.auth_api}/accounts`;return new Promise(o=>{const l=new XMLHttpRequest;l.onreadystatechange=async()=>{if(l.readyState==4)if(l.status==200){const r=JSON.parse(l.response);o(re(r))}else o(F(l.status))},l.open("GET",t,!0),l.setRequestHeader("Accept","application/json"),l.setRequestHeader("Authorization","Bearer ".concat(e)),l.send()})}}function E(){}function jt(n,e){for(const t in e)n[t]=e[t];return n}function Mt(n){return!!n&&(typeof n=="object"||typeof n=="function")&&typeof n.then=="function"}function xt(n){return n()}function ot(){return Object.create(null)}function ne(n){n.forEach(xt)}function qe(n){return typeof n=="function"}function K(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let Ne;function At(n,e){return n===e?!0:(Ne||(Ne=document.createElement("a")),Ne.href=e,n===Ne.href)}function Dt(n){return Object.keys(n).length===0}function Tt(n,...e){if(n==null){for(const o of e)o(void 0);return E}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function ie(n){let e;return Tt(n,t=>e=t)(),e}function ae(n,e,t){n.$$.on_destroy.push(Tt(e,t))}function Be(n,e,t,o){if(n){const l=Pt(n,e,t,o);return n[0](l)}}function Pt(n,e,t,o){return n[1]&&o?jt(t.ctx.slice(),n[1](o(e))):t.ctx}function Ge(n,e,t,o){if(n[2]&&o){const l=n[2](o(t));if(e.dirty===void 0)return l;if(typeof l=="object"){const r=[],i=Math.max(e.dirty.length,l.length);for(let a=0;a<i;a+=1)r[a]=e.dirty[a]|l[a];return r}return e.dirty|l}return e.dirty}function Je(n,e,t,o,l,r){if(l){const i=Pt(e,t,o,r);n.p(i,l)}}function Xe(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let o=0;o<t;o++)e[o]=-1;return e}return-1}function Se(n,e,t){return n.set(t),e}function qt(n){return n&&qe(n.destroy)?n.destroy:E}function y(n,e){n.appendChild(e)}function w(n,e,t){n.insertBefore(e,t||null)}function k(n){n.parentNode&&n.parentNode.removeChild(n)}function Oe(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function b(n){return document.createElement(n)}function J(n){return document.createTextNode(n)}function I(){return J(" ")}function ge(){return J("")}function U(n,e,t,o){return n.addEventListener(e,t,o),()=>n.removeEventListener(e,t,o)}function Bt(n){return function(e){e.target===this&&n.call(this,e)}}function m(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Gt(n){return Array.from(n.childNodes)}function ce(n,e){e=""+e,n.data!==e&&(n.data=e)}function Q(n,e){n.value=e??""}function _e(n,e,t){for(let o=0;o<n.options.length;o+=1){const l=n.options[o];if(l.__value===e){l.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function Qe(n){const e=n.querySelector(":checked");return e&&e.__value}function W(n,e,t){n.classList.toggle(e,!!t)}function Jt(n,e,{bubbles:t=!1,cancelable:o=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:o})}let Ie;function de(n){Ie=n}function Fe(){if(!Ie)throw new Error("Function called outside component initialization");return Ie}function It(n){Fe().$$.on_mount.push(n)}function Xt(n){Fe().$$.on_destroy.push(n)}function Ft(){const n=Fe();return(e,t,{cancelable:o=!1}={})=>{const l=n.$$.callbacks[e];if(l){const r=Jt(e,t,{cancelable:o});return l.slice().forEach(i=>{i.call(n,r)}),!r.defaultPrevented}return!0}}const ye=[],fe=[];let Le=[];const lt=[],Wt=Promise.resolve();let Ye=!1;function Vt(){Ye||(Ye=!0,Wt.then(et))}function Ce(n){Le.push(n)}const Ve=new Set;let me=0;function et(){if(me!==0)return;const n=Ie;do{try{for(;me<ye.length;){const e=ye[me];me++,de(e),zt(e.$$)}}catch(e){throw ye.length=0,me=0,e}for(de(null),ye.length=0,me=0;fe.length;)fe.pop()();for(let e=0;e<Le.length;e+=1){const t=Le[e];Ve.has(t)||(Ve.add(t),t())}Le.length=0}while(ye.length);for(;lt.length;)lt.pop()();Ye=!1,Ve.clear(),de(n)}function zt(n){if(n.fragment!==null){n.update(),ne(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Ce)}}function Zt(n){const e=[],t=[];Le.forEach(o=>n.indexOf(o)===-1?e.push(o):t.push(o)),t.forEach(o=>o()),Le=e}const Me=new Set;let he;function Ee(){he={r:0,c:[],p:he}}function Ue(){he.r||ne(he.c),he=he.p}function M(n,e){n&&n.i&&(Me.delete(n),n.i(e))}function D(n,e,t,o){if(n&&n.o){if(Me.has(n))return;Me.add(n),he.c.push(()=>{Me.delete(n),o&&(t&&n.d(1),o())}),n.o(e)}else o&&o()}function Re(n,e){const t=e.token={};function o(l,r,i,a){if(e.token!==t)return;e.resolved=a;let u=e.ctx;i!==void 0&&(u=u.slice(),u[i]=a);const c=l&&(e.current=l)(u);let d=!1;e.block&&(e.blocks?e.blocks.forEach((f,_)=>{_!==r&&f&&(Ee(),D(f,1,1,()=>{e.blocks[_]===f&&(e.blocks[_]=null)}),Ue())}):e.block.d(1),c.c(),M(c,1),c.m(e.mount(),e.anchor),d=!0),e.block=c,e.blocks&&(e.blocks[r]=c),d&&et()}if(Mt(n)){const l=Fe();if(n.then(r=>{de(l),o(e.then,1,e.value,r),de(null)},r=>{if(de(l),o(e.catch,2,e.error,r),de(null),!e.hasCatch)throw r}),e.current!==e.pending)return o(e.pending,0),!0}else{if(e.current!==e.then)return o(e.then,1,e.value,n),!0;e.resolved=n}}function tt(n,e,t){const o=e.slice(),{resolved:l}=n;n.current===n.then&&(o[n.value]=l),n.current===n.catch&&(o[n.error]=l),n.block.p(o,t)}function le(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Yt(n,e){n.d(1),e.delete(n.key)}function Kt(n,e,t,o,l,r,i,a,u,c,d,f){let _=n.length,g=r.length,p=_;const $={};for(;p--;)$[n[p].key]=p;const h=[],L=new Map,T=new Map,B=[];for(p=g;p--;){const C=f(l,r,p),S=t(C);let x=i.get(S);x?o&&B.push(()=>x.p(C,e)):(x=c(S,C),x.c()),L.set(S,h[p]=x),S in $&&T.set(S,Math.abs(p-$[S]))}const H=new Set,O=new Set;function N(C){M(C,1),C.m(a,d),i.set(C.key,C),d=C.first,g--}for(;_&&g;){const C=h[g-1],S=n[_-1],x=C.key,j=S.key;C===S?(d=C.first,_--,g--):L.has(j)?!i.has(x)||H.has(x)?N(C):O.has(j)?_--:T.get(x)>T.get(j)?(O.add(x),N(C)):(H.add(j),_--):(u(S,i),_--)}for(;_--;){const C=n[_];L.has(C.key)||u(C,i)}for(;g;)N(h[g-1]);return ne(B),h}function Y(n){n&&n.c()}function z(n,e,t){const{fragment:o,after_update:l}=n.$$;o&&o.m(e,t),Ce(()=>{const r=n.$$.on_mount.map(xt).filter(qe);n.$$.on_destroy?n.$$.on_destroy.push(...r):ne(r),n.$$.on_mount=[]}),l.forEach(Ce)}function Z(n,e){const t=n.$$;t.fragment!==null&&(Zt(t.after_update),ne(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Qt(n,e){n.$$.dirty[0]===-1&&(ye.push(n),Vt(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function ee(n,e,t,o,l,r,i=null,a=[-1]){const u=Ie;de(n);const c=n.$$={fragment:null,ctx:[],props:r,update:E,not_equal:l,bound:ot(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:ot(),dirty:a,skip_bound:!1,root:e.target||u.$$.root};i&&i(c.root);let d=!1;if(c.ctx=t?t(n,e.props||{},(f,_,...g)=>{const p=g.length?g[0]:_;return c.ctx&&l(c.ctx[f],c.ctx[f]=p)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](p),d&&Qt(n,f)),_}):[],c.update(),d=!0,ne(c.before_update),c.fragment=o?o(c.ctx):!1,e.target){if(e.hydrate){const f=Gt(e.target);c.fragment&&c.fragment.l(f),f.forEach(k)}else c.fragment&&c.fragment.c();e.intro&&M(n.$$.fragment),z(n,e.target,e.anchor),et()}de(u)}class te{constructor(){xe(this,"$$");xe(this,"$$set")}$destroy(){Z(this,1),this.$destroy=E}$on(e,t){if(!qe(t))return E;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(t),()=>{const l=o.indexOf(t);l!==-1&&o.splice(l,1)}}$set(e){this.$$set&&!Dt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const en="4",be=[];function De(n,e=E){let t;const o=new Set;function l(a){if(K(n,a)&&(n=a,t)){const u=!be.length;for(const c of o)c[1](),be.push(c,n);if(u){for(let c=0;c<be.length;c+=2)be[c][0](be[c+1]);be.length=0}}}function r(a){l(a(n))}function i(a,u=E){const c=[a,u];return o.add(c),o.size===1&&(t=e(l,r)||E),a(n),()=>{o.delete(c),o.size===0&&t&&(t(),t=null)}}return{set:l,update:r,subscribe:i}}var Te=(n=>(n.info="info",n.warn="warn",n.error="error",n))(Te||{});class tn{constructor(){xe(this,"logs",De([]))}_addLog(e,t){this.logs.update(o=>(o.unshift({date:new Date,severity:e,content:t}),o))}info(e){this._addLog("info",e)}warn(e){this._addLog("warn",e)}error(e){this._addLog("error",e)}updateLogAtIndex(e,t){this.logs.update(o=>(o[e]&&(o[e].content=t),o))}}const P=new tn;function nn(n,e){let t=!1;return n.subscribe(o=>{t?e(o):t=!0})}const sn={use_dark_theme:!0,rs_plugin_loader:!1,flatpak_rich_presence:!1,runelite_use_custom_jar:!1,use_custom_rs_config_uri:!1,selected:{game:V.osrs,client:pe.runelite,user_id:null},userDetails:{}};function on(){const e=new URLSearchParams(window.location.search).get("config");function t(l){return typeof l=="object"&&typeof l.use_dark_theme=="boolean"&&typeof l.rs_plugin_loader=="boolean"&&typeof l.flatpak_rich_presence=="boolean"&&typeof l.runelite_use_custom_jar=="boolean"&&typeof l.selected=="object"&&Object.values(V).includes(l.selected.game)&&Object.values(pe).includes(l.selected.client)&&(typeof l.selected.user_id=="string"||l.selected.user_id===null)&&typeof l.userDetails=="object"}const{config:o}=A;if(e)try{const l=JSON.parse(e);t(l)?o.set(l):(P.error("The config saved on disk is not the correct format. It has been restored to default."),A.configHasPendingChanges=!0)}catch{P.error("Unable to parse config, restoring to default"),A.configHasPendingChanges=!0}else A.configHasPendingChanges=!0;nn(A.config,()=>{A.configHasPendingChanges=!0})}const A={configHasPendingChanges:!1,config:De(sn),sessions:De([])};let ze=!1;class X{static async login(e,t){const o=await Ae.buildSession(e,t);if(!o.ok)return F(o.error);const{config:l,sessions:r}=A,i=o.value;return X.findSession(e.sub)||(r.update(u=>(u.push(i),u)),l.update(u=>(u.selected.user_id=i.user.userId,u))),!ie(l).selected.user_id===null&&i.user.userId,re(i)}static async logout(e){const{sessions:t,config:o}=A;return t.update(l=>{const r=l.findIndex(i=>i.user.userId===e);return r>-1&&(oe.revokeOauthCreds(l[r].tokens.access_token),l.splice(r,1)),l}),o.update(l=>(typeof l.userDetails[e]<"u"&&delete l.userDetails[e],l.selected.user_id===e&&(l.selected.user_id=null),l)),ie(t)}static saveConfig(e=!0){if(ze||e&&!A.configHasPendingChanges)return;ze=!0;const t=new XMLHttpRequest;t.open("POST","/save-config",!0),t.onreadystatechange=()=>{t.readyState==4&&(P.info(`Save config status: '${t.responseText.trim()}'`),ze=!1)},t.setRequestHeader("Content-Type","application/json");const o=ie(A.config);return t.send(JSON.stringify(o)),o}static async saveCredentials(){new Promise(e=>{const t=new XMLHttpRequest;t.open("POST","/save-credentials",!0),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=()=>{t.readyState==4&&e(void 0)};const o=ie(A.sessions);t.send(JSON.stringify(o))})}static async openFilePicker(){return new Promise(e=>{const t=new XMLHttpRequest;t.onreadystatechange=()=>{if(t.readyState==4)return t.status==200?e(t.responseText):e(void 0)},t.open("GET","/jar-file-picker",!0),t.send()})}static findSession(e){return ie(A.sessions).find(o=>o.user.userId===e)}static findAccount(e,t){return e.find(o=>o.accountId==t)}}function ln(n,e,t){X.saveConfig();const o=(a,u)=>{const c=new XMLHttpRequest,d={},f=ie(A.config);a&&(d.hash=a),n&&(d.jx_session_id=n),e&&(d.jx_character_id=e),t&&(d.jx_display_name=t),f.rs_plugin_loader&&(d.plugin_loader="1"),f.use_custom_rs_config_uri&&f.rs_config_uri?d.config_uri=f.rs_config_uri:d.config_uri=R.env.default_config_uri,c.open("POST","/launch-rs3-deb?".concat(new URLSearchParams(d).toString()),!0),c.onreadystatechange=()=>{c.readyState==4&&(P.info(`Game launch status: '${c.responseText.trim()}'`),c.status==200&&a&&(R.rs3DebInstalledHash=a))},c.send(u)},l=new XMLHttpRequest,r=R.env.content_url,i=r.concat("dists/trusty/non-free/binary-amd64/Packages");l.open("GET",i,!0),l.onreadystatechange=()=>{if(l.readyState==4&&l.status==200){const a=Object.fromEntries(l.response.split(`
`).map(u=>u.split(": ")));if(!a.Filename||!a.Size){P.error(`Could not parse package data from URL: ${i}`),o();return}if(a.SHA256!==R.rs3DebInstalledHash){P.info("Downloading RS3 client...");const u=new XMLHttpRequest;u.open("GET",r.concat(a.Filename),!0),u.responseType="arraybuffer",u.onprogress=c=>{if(c.loaded){const d=(Math.round(1e3*c.loaded/c.total)/10).toFixed(1);P.updateLogAtIndex(0,`Downloading RS3 client... ${d}%`)}},u.onreadystatechange=()=>{u.readyState==4&&u.status==200&&o(a.SHA256,u.response)},u.onerror=()=>{P.error(`Error downloading game client: from ${i}: non-http error`),o()},u.send()}else P.info("Latest client is already installed"),o()}},l.onerror=()=>{P.error(`Error: from ${i}: non-http error`),o()},l.send()}function Ht(n,e,t,o){X.saveConfig();const l=o?"/launch-runelite-jar-configure?":"/launch-runelite-jar?",r=(u,c,d)=>{const f=new XMLHttpRequest,_={};u&&(_.id=u),d&&(_.jar_path=d),n&&(_.jx_session_id=n),e&&(_.jx_character_id=e),t&&(_.jx_display_name=t),ie(A.config).flatpak_rich_presence&&(_.flatpak_rich_presence=""),f.open(c?"POST":"GET",l.concat(new URLSearchParams(_).toString()),!0),f.onreadystatechange=()=>{f.readyState==4&&(P.info(`Game launch status: '${f.responseText.trim()}'`),f.status==200&&u&&(R.runeLiteInstalledId=u))},f.send(c)};if(ie(A.config).runelite_use_custom_jar){r(null,null,ie(A.config).runelite_custom_jar);return}const i=new XMLHttpRequest,a="https://api.github.com/repos/runelite/launcher/releases";i.open("GET",a,!0),i.onreadystatechange=()=>{if(i.readyState==4)if(i.status==200){const u=JSON.parse(i.responseText).map(c=>c.assets).flat().find(c=>c.name.toLowerCase()=="runelite.jar");if(u.id!=R.runeLiteInstalledId){P.info("Downloading RuneLite...");const c=new XMLHttpRequest;c.open("GET",u.browser_download_url,!0),c.responseType="arraybuffer",c.onreadystatechange=()=>{c.readyState==4&&(c.status==200?r(u.id,c.response):P.error(`Error downloading from ${u.url}: ${c.status}: ${c.responseText}`))},c.onprogress=d=>{if(d.loaded&&d.lengthComputable){const f=(Math.round(1e3*d.loaded/d.total)/10).toFixed(1);P.updateLogAtIndex(0,`Downloading RuneLite... ${f}%`)}},c.send()}else P.info("Latest JAR is already installed"),r()}else P.error(`Error from ${a}: ${i.status}: ${i.responseText}`)},i.send()}function rn(n,e,t){X.saveConfig();const o=(i,a)=>{const u=new XMLHttpRequest,c={};i&&(c.version=i),n&&(c.jx_session_id=n),e&&(c.jx_character_id=e),t&&(c.jx_display_name=t),u.open("POST","/launch-hdos-jar?".concat(new URLSearchParams(c).toString()),!0),u.onreadystatechange=()=>{u.readyState==4&&(P.info(`Game launch status: '${u.responseText.trim()}'`),u.status==200&&i&&(R.hdosInstalledVersion=i))},u.send(a)},l=new XMLHttpRequest,r="https://cdn.hdos.dev/client/getdown.txt";l.open("GET",r,!0),l.onreadystatechange=()=>{if(l.readyState==4)if(l.status==200){const i=l.responseText.match(/^launcher\.version *= *(.*?)$/m);if(i&&i.length>=2){const a=i[1];if(a!==R.hdosInstalledVersion){const u=`https://cdn.hdos.dev/launcher/v${a}/hdos-launcher.jar`;P.info("Downloading HDOS...");const c=new XMLHttpRequest;c.open("GET",u,!0),c.responseType="arraybuffer",c.onreadystatechange=()=>{if(c.readyState==4)if(c.status==200)o(a,c.response);else{const d=JSON.parse(l.responseText).map(f=>f.assets).flat().find(f=>f.name.toLowerCase()=="runelite.jar");P.error(`Error downloading from ${d.url}: ${c.status}: ${c.responseText}`)}},c.onprogress=d=>{if(d.loaded&&d.lengthComputable){const f=(Math.round(1e3*d.loaded/d.total)/10).toFixed(1);P.updateLogAtIndex(0,`Downloading HDOS... ${f}%`)}},c.send()}else P.info("Latest JAR is already installed"),o()}else P.info("Couldn't parse latest launcher version"),o()}else P.error(`Error from ${r}: ${l.status}: ${l.responseText}`)},l.send()}function Ot(){return new Promise((n,e)=>{const t=new XMLHttpRequest;t.open("GET","/list-game-clients",!0),t.onreadystatechange=()=>{if(t.readyState==4)if(t.status==200&&t.getResponseHeader("content-type")==="application/json"){const o=JSON.parse(t.responseText);n(Object.keys(o).map(l=>({uid:l,identity:o[l].identity||null})))}else e(`error (${t.responseText})`)},t.send()})}function an(){const n=new XMLHttpRequest;n.open("POST","/save-plugin-config",!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=()=>{n.readyState==4&&P.info(`Save-plugin-config status: ${n.responseText.trim()}`)},n.send(JSON.stringify(R.pluginList))}async function rt(n,e,t,o,l){X.saveConfig();const r=`${e?"osrs":R.env.provider}-${n?"win":"mac"}`;let i=n?e?R.osrsExeInstalledHash:R.rs3ExeInstalledHash:e?R.osrsAppInstalledHash:R.rs3AppInstalledHash;const a=async(C,S)=>{const x={};if(C&&(x.hash=C),t&&(x.jx_session_id=t),o&&(x.jx_character_id=o),l&&(x.jx_display_name=l),!e){const v=ie(A.config);v.rs_plugin_loader&&(x.plugin_loader="1"),x.config_uri=v.use_custom_rs_config_uri&&v.rs_config_uri?v.rs_config_uri:R.env.default_config_uri}const j=await fetch(`/launch-${e?"osrs":"rs3"}-${n?"exe":"app"}?${new URLSearchParams(x).toString()}`,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:await S});j.text().then(v=>P.info(`Game launch status: '${v.trim()}'`)),j.status==200&&C&&(i=C)},u=`${R.env.direct6_url}${r}/${r}.json`,c=await fetch(u,{method:"GET"}),d=await c.text();if(c.status!==200){P.error(`Error from ${u}: ${c.status}: ${d}`);return}const f=JSON.parse(atob(d.split(".")[1])).environments.production;if(i===f.id){P.info("Latest client is already installed"),a();return}P.info(`Downloading client version ${f.version}`);const _=`${R.env.direct6_url}${r}/catalog/${f.id}/catalog.json`,g=await fetch(_,{method:"GET"}),p=await g.text();if(g.status!==200){P.error(`Error from ${_}: ${g.status}: ${p}`);return}const $=JSON.parse(atob(p.split(".")[1])),h=$.metafile.replace(/^http:/i,"https:"),L=await fetch(h,{method:"GET"}),T=await L.text();if(L.status!==200){P.error(`Error from ${h}: ${L.status}: ${T}`);return}const B=JSON.parse(atob(T.split(".")[1])),H=B.pieces.digests.map(C=>{const S=atob(C).split("").map(j=>j.charCodeAt(0).toString(16).padStart(2,"0")).join(""),x=$.config.remote.baseUrl.replace(/^http:/i,"https:").concat($.config.remote.pieceFormat.replace("{SubString:0,2,{TargetDigest}}",S.substring(0,2)).replace("{TargetDigest}",S));return fetch(x,{method:"GET"}).then(j=>j.blob().then(v=>{const G=new DecompressionStream("gzip");return new Response(v.slice(6).stream().pipeThrough(G)).blob()}))});let O=0,N=null;for(let C=0;C<B.files.length;C+=1)if(n?B.files[C].name.endsWith(".exe"):B.files[C].name.includes(".app/Contents/MacOS/"))if(N!==null){P.error(`Error parsing ${h}: file list has multiple possibilities for main exe`);return}else N=B.files[C].size;else N===null&&(O+=B.files[C].size);if(N===null){P.error(`Error parsing ${h}: file list has no possibilities for main exe`);return}Promise.all(H).then(C=>{const S=new Blob(C).slice(O,O+N);a(B.id,S.arrayBuffer())})}const Ke=De();typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(en);function cn(n){let e,t;const o=n[4].default,l=Be(o,n,n[3],null);return{c(){e=b("main"),l&&l.c(),m(e,"class","fixed top-0 h-screen w-screen bg-slate-100 text-xs text-slate-900 duration-200 sm:text-sm md:text-base dark:bg-slate-900 dark:text-slate-50"),W(e,"dark",n[0])},m(r,i){w(r,e,i),l&&l.m(e,null),t=!0},p(r,[i]){l&&l.p&&(!t||i&8)&&Je(l,o,r,r[3],t?Ge(o,r[3],i,null):Xe(r[3]),null),(!t||i&1)&&W(e,"dark",r[0])},i(r){t||(M(l,r),t=!0)},o(r){D(l,r),t=!1},d(r){r&&k(e),l&&l.d(r)}}}function un(n,e,t){let o,l,{$$slots:r={},$$scope:i}=e;const{config:a}=A;return ae(n,a,u=>t(2,l=u)),n.$$set=u=>{"$$scope"in u&&t(3,i=u.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&t(0,o=l.use_dark_theme)},[o,a,l,i,r]}class Et extends te{constructor(e){super(),ee(this,e,un,cn,K,{})}}function dn(n){let e;return{c(){e=b("div"),e.innerHTML='<img class="h-60 w-60 animate-spin" src="svgs/circle-notch-solid.svg" alt="loading"/>',m(e,"class","flex h-full items-center justify-center")},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function fn(n){let e,t;return e=new Et({props:{$$slots:{default:[dn]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},m(o,l){z(e,o,l),t=!0},p(o,[l]){const r={};l&32&&(r.$$scope={dirty:l,ctx:o}),e.$set(r)},i(o){t||(M(e.$$.fragment,o),t=!0)},o(o){D(e.$$.fragment,o),t=!1},d(o){Z(e,o)}}}function pn(n){const e=window.opener;R.env==null&&l("BoltEnv is not defined. Please close and re-open Bolt to try again.");async function t(i){const a=ve.get("auth_verifier");if(!a)return l("Verifier token has expired. Please try signing in again."),null;const{clientid:u,redirect:c}=R.env,d=await oe.getOAuthToken(R.env.origin,u,a,c,i);return d.ok?d.value:(l(`Fetching OAuth token failed. ${d.error}`),null)}async function o(i){const a=ve.get("auth_nonce"),u=oe.validateIdToken(i,a??"");if(!u.ok)return l(u.error),null;const c=await oe.getSessionId(R.env.auth_api,i);return c.ok?c.value:(l(`Unable to retreive session id. ${c.error}`),null)}function l(i){r({type:"authFailed",reason:i}),window.close()}function r(i){e.postMessage(i,window.location.origin)}return It(async()=>{const i=new URLSearchParams(window.location.search),a=i.get("code"),u=i.get("state"),c=i.get("id_token");if(c==null&&a&&u){const d=await t(a);if(!d)return l("tokens object is null.");r({type:"authTokenUpdate",tokens:d});const f=crypto.randomUUID();oe.navigateToAuthConsent(R.env.origin,d.id_token,f)}else if(c&&a&&u){const d=await o(c);if(!d)return l("sessionId is null");r({type:"authSessionUpdate",sessionId:d}),window.close()}else l("Authentication server did not response with the appropriate parameters. Please try again later.")}),Xt(()=>{ve.remove("auth_verifier"),ve.remove("auth_nonce")}),[]}class _n extends te{constructor(e){super(),ee(this,e,pn,fn,K,{})}}function it(n){let e,t,o;return{c(){e=b("button"),e.innerHTML='<img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/>',m(e,"class","absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75")},m(l,r){w(l,e,r),t||(o=U(e,"click",n[8]),t=!0)},p:E,d(l){l&&k(e),t=!1,o()}}}function at(n){let e;const t=n[7].default,o=Be(t,n,n[6],null);return{c(){o&&o.c()},m(l,r){o&&o.m(l,r),e=!0},p(l,r){o&&o.p&&(!e||r&64)&&Je(o,t,l,l[6],e?Ge(t,l[6],r,null):Xe(l[6]),null)},i(l){e||(M(o,l),e=!0)},o(l){D(o,l),e=!1},d(l){o&&o.d(l)}}}function gn(n){let e,t,o,l,r,i,a=n[1]&&it(n),u=n[3]&&at(n);return{c(){e=b("dialog"),a&&a.c(),t=I(),u&&u.c(),m(e,"class",o=n[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"),W(e,"backdrop:cursor-pointer",n[1])},m(c,d){w(c,e,d),a&&a.m(e,null),y(e,t),u&&u.m(e,null),n[9](e),l=!0,r||(i=[U(e,"keydown",n[10]),U(e,"mousedown",Bt(n[11]))],r=!0)},p(c,[d]){c[1]?a?a.p(c,d):(a=it(c),a.c(),a.m(e,t)):a&&(a.d(1),a=null),c[3]?u?(u.p(c,d),d&8&&M(u,1)):(u=at(c),u.c(),M(u,1),u.m(e,null)):u&&(Ee(),D(u,1,1,()=>{u=null}),Ue()),(!l||d&1&&o!==(o=c[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"))&&m(e,"class",o),(!l||d&3)&&W(e,"backdrop:cursor-pointer",c[1])},i(c){l||(M(u),l=!0)},o(c){D(u),l=!1},d(c){c&&k(e),a&&a.d(),u&&u.d(),n[9](null),r=!1,ne(i)}}}function hn(n,e,t){let{$$slots:o={},$$scope:l}=e,{class:r=""}=e,{canSelfClose:i=!0}=e,a,u=!1;const c=Ft();function d(){a.showModal(),t(3,u=!0)}function f(){c("close"),a.close(),t(3,u=!1)}const _=()=>a.close();function g(h){fe[h?"unshift":"push"](()=>{a=h,t(2,a)})}const p=h=>{h.key==="Escape"&&!i&&h.preventDefault()},$=()=>{i&&a.close()};return n.$$set=h=>{"class"in h&&t(0,r=h.class),"canSelfClose"in h&&t(1,i=h.canSelfClose),"$$scope"in h&&t(6,l=h.$$scope)},[r,i,a,u,d,f,l,o,_,g,p,$]}class nt extends te{constructor(e){super(),ee(this,e,hn,gn,K,{class:0,canSelfClose:1,open:4,close:5})}get open(){return this.$$.ctx[4]}get close(){return this.$$.ctx[5]}}function mn(n){let e,t,o,l,r,i,a;return{c(){e=b("p"),e.textContent=`${atob("Qm9sdCBpcyBhbiB1bm9mZmljaWFsIHRoaXJkLXBhcnR5IGxhdW5jaGVyLiBJdCdzIGZyZWUgYW5kIG9wZW4tc291cmNlIHNvZnR3YXJlIGxpY2Vuc2VkIHVuZGVyIEFHUEwgMy4wLg==")}`,t=I(),o=b("p"),o.textContent=`${atob("SmFnZXggaXMgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgcHJvYmxlbXMgb3IgZGFtYWdlIGNhdXNlZCBieSB1c2luZyB0aGlzIHByb2R1Y3Qu")}`,l=I(),r=b("button"),r.textContent="I Understand",m(e,"class","p-2"),m(o,"class","p-2"),m(r,"class","m-5 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75")},m(u,c){w(u,e,c),w(u,t,c),w(u,o,c),w(u,l,c),w(u,r,c),i||(a=U(r,"click",n[2]),i=!0)},p:E,d(u){u&&(k(e),k(t),k(o),k(l),k(r)),i=!1,a()}}}function bn(n){let e,t,o={canSelfClose:!1,class:"w-1/2 text-center",$$slots:{default:[mn]},$$scope:{ctx:n}};return e=new nt({props:o}),n[3](e),{c(){Y(e.$$.fragment)},m(l,r){z(e,l,r),t=!0},p(l,[r]){const i={};r&33&&(i.$$scope={dirty:r,ctx:l}),e.$set(i)},i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){n[3](null),Z(e,l)}}}function kn(n,e,t){let o;const{sessions:l}=A;ae(n,l,u=>t(4,o=u));let r;It(()=>{o.length==0&&r.open()});const i=()=>r.close();function a(u){fe[u?"unshift":"push"](()=>{r=u,t(0,r)})}return[r,l,i,a]}class wn extends te{constructor(e){super(),ee(this,e,kn,bn,K,{})}}function ct(n,e,t){const o=n.slice();return o[26]=e[t][0],o[25]=e[t][1],o}function ut(n,e,t){const o=n.slice();return o[30]=e[t],o}function yn(n){let e;return{c(){e=b("p"),e.textContent="error"},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function vn(n){let e;function t(r,i){return r[29].length==0?Sn:$n}let o=t(n),l=o(n);return{c(){l.c(),e=ge()},m(r,i){l.m(r,i),w(r,e,i)},p(r,i){o===(o=t(r))&&l?l.p(r,i):(l.d(1),l=o(r),l&&(l.c(),l.m(e.parentNode,e)))},d(r){r&&k(e),l.d(r)}}}function $n(n){let e,t=le(n[29]),o=[];for(let l=0;l<t.length;l+=1)o[l]=dt(ut(n,t,l));return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=ge()},m(l,r){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,r);w(l,e,r)},p(l,r){if(r[0]&70){t=le(l[29]);let i;for(i=0;i<t.length;i+=1){const a=ut(l,t,i);o[i]?o[i].p(a,r):(o[i]=dt(a),o[i].c(),o[i].m(e.parentNode,e))}for(;i<o.length;i+=1)o[i].d(1);o.length=t.length}},d(l){l&&k(e),Oe(o,l)}}}function Sn(n){let e;return{c(){e=b("p"),e.textContent="(start an RS3 game client with plugins enabled and it will be listed here.)"},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function dt(n){let e,t=(n[30].identity||gt)+"",o,l,r,i,a,u;function c(){return n[14](n[30])}return{c(){e=b("button"),o=J(t),r=I(),i=b("br"),m(e,"class",l="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(n[6]&&n[1]===n[30].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")},m(d,f){w(d,e,f),y(e,o),w(d,r,f),w(d,i,f),a||(u=U(e,"click",c),a=!0)},p(d,f){n=d,f[0]&4&&t!==(t=(n[30].identity||gt)+"")&&ce(o,t),f[0]&70&&l!==(l="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(n[6]&&n[1]===n[30].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")&&m(e,"class",l)},d(d){d&&(k(e),k(r),k(i)),a=!1,u()}}}function Ln(n){let e;return{c(){e=b("p"),e.textContent="loading..."},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function Cn(n){let e;return{c(){e=b("p"),e.textContent="error"},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function Rn(n){let e,t,o,l,r,i=le(Object.entries(n[3].pluginList)),a=[];for(let f=0;f<i.length;f+=1)a[f]=ft(ct(n,i,f));function u(f,_){return f[6]?xn:Tn}let c=u(n),d=c(n);return{c(){e=b("select");for(let f=0;f<a.length;f+=1)a[f].c();t=I(),d.c(),o=ge(),m(e,"class","mx-auto mb-4 w-[min(280px,_45%)] cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),n[0]===void 0&&Ce(()=>n[15].call(e))},m(f,_){w(f,e,_);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(e,null);_e(e,n[0],!0),w(f,t,_),d.m(f,_),w(f,o,_),l||(r=U(e,"change",n[15]),l=!0)},p(f,_){if(_[0]&8){i=le(Object.entries(f[3].pluginList));let g;for(g=0;g<i.length;g+=1){const p=ct(f,i,g);a[g]?a[g].p(p,_):(a[g]=ft(p),a[g].c(),a[g].m(e,null))}for(;g<a.length;g+=1)a[g].d(1);a.length=i.length}_[0]&9&&_e(e,f[0]),c===(c=u(f))&&d?d.p(f,_):(d.d(1),d=c(f),d&&(d.c(),d.m(o.parentNode,o)))},d(f){f&&(k(e),k(t),k(o)),Oe(a,f),d.d(f),l=!1,r()}}}function ft(n){let e,t=(n[25].name??He)+"",o,l;return{c(){e=b("option"),o=J(t),m(e,"class","dark:bg-slate-900"),e.__value=l=n[26],Q(e,e.__value)},m(r,i){w(r,e,i),y(e,o)},p(r,i){i[0]&8&&t!==(t=(r[25].name??He)+"")&&ce(o,t),i[0]&8&&l!==(l=r[26])&&(e.__value=l,Q(e,e.__value))},d(r){r&&k(e)}}}function xn(n){let e,t,o,l,r={ctx:n,current:null,token:null,hasCatch:!0,pending:Nn,then:In,catch:Pn,value:25};return Re(l=n[8],r),{c(){e=b("br"),t=I(),o=ge(),r.block.c()},m(i,a){w(i,e,a),w(i,t,a),w(i,o,a),r.block.m(i,r.anchor=a),r.mount=()=>o.parentNode,r.anchor=o},p(i,a){n=i,r.ctx=n,a[0]&256&&l!==(l=n[8])&&Re(l,r)||tt(r,n,a)},d(i){i&&(k(e),k(t),k(o)),r.block.d(i),r.token=null,r=null}}}function Tn(n){let e,t,o,l,r,i,a,u,c;function d(g,p){return p[0]&8&&(i=null),i==null&&(i=Object.entries(g[3].pluginList).length!==0),i?Mn:jn}let f=d(n,[-1,-1]),_=f(n);return{c(){e=b("button"),t=J("+"),o=I(),l=b("br"),r=I(),_.c(),a=ge(),m(e,"class","aspect-square w-8 rounded-lg border-2 border-blue-500 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:border-gray-500"),e.disabled=n[5]},m(g,p){w(g,e,p),y(e,t),w(g,o,p),w(g,l,p),w(g,r,p),_.m(g,p),w(g,a,p),u||(c=U(e,"click",n[10]),u=!0)},p(g,p){p[0]&32&&(e.disabled=g[5]),f===(f=d(g,p))&&_?_.p(g,p):(_.d(1),_=f(g),_&&(_.c(),_.m(a.parentNode,a)))},d(g){g&&(k(e),k(o),k(l),k(r),k(a)),_.d(g),u=!1,c()}}}function Pn(n){let e;return{c(){e=b("p"),e.textContent="error"},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function In(n){let e,t;function o(i,a){return a[0]&265&&(e=null),e==null&&(e=!!(i[25]&&i[25].main&&Object.keys(i[3].pluginList).includes(i[0]))),e?On:Hn}let l=o(n,[-1,-1]),r=l(n);return{c(){r.c(),t=ge()},m(i,a){r.m(i,a),w(i,t,a)},p(i,a){l===(l=o(i,a))&&r?r.p(i,a):(r.d(1),r=l(i),r&&(r.c(),r.m(t.parentNode,t)))},d(i){i&&k(t),r.d(i)}}}function Hn(n){let e;return{c(){e=b("p"),e.textContent="can't start plugin: does not appear to be configured"},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function On(n){let e;function t(r,i){return r[3].pluginList[r[0]].path?Un:En}let o=t(n),l=o(n);return{c(){l.c(),e=ge()},m(r,i){l.m(r,i),w(r,e,i)},p(r,i){o===(o=t(r))&&l?l.p(r,i):(l.d(1),l=o(r),l&&(l.c(),l.m(e.parentNode,e)))},d(r){r&&k(e),l.d(r)}}}function En(n){let e;return{c(){e=b("p"),e.textContent="can't start plugin: no path is configured"},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function Un(n){let e,t,o=n[25].name+"",l,r,i;function a(){return n[18](n[25])}return{c(){e=b("button"),t=J("Start "),l=J(o),m(e,"class","mx-auto mb-1 w-auto rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75")},m(u,c){w(u,e,c),y(e,t),y(e,l),r||(i=U(e,"click",a),r=!0)},p(u,c){n=u,c[0]&256&&o!==(o=n[25].name+"")&&ce(l,o)},d(u){u&&k(e),r=!1,i()}}}function Nn(n){let e;return{c(){e=b("p"),e.textContent="loading..."},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function jn(n){let e;return{c(){e=b("p"),e.textContent=`You have no plugins installed. Click the + button and select a plugin's bolt.json file
						to add it.`},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function Mn(n){let e=Object.keys(n[3].pluginList).includes(n[0])&&n[8]!==null,t,o=e&&pt(n);return{c(){o&&o.c(),t=ge()},m(l,r){o&&o.m(l,r),w(l,t,r)},p(l,r){r[0]&265&&(e=Object.keys(l[3].pluginList).includes(l[0])&&l[8]!==null),e?o?o.p(l,r):(o=pt(l),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null)},d(l){l&&k(t),o&&o.d(l)}}}function pt(n){let e,t,o,l,r,i,a,u={ctx:n,current:null,token:null,hasCatch:!0,pending:qn,then:Dn,catch:An,value:25};return Re(e=n[8],u),{c(){u.block.c(),t=I(),o=b("button"),o.textContent="Remove",l=I(),r=b("button"),r.textContent="Reload",m(o,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-rose-500 enabled:hover:opacity-75 disabled:bg-gray-500"),m(r,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(c,d){u.block.m(c,u.anchor=d),u.mount=()=>t.parentNode,u.anchor=t,w(c,t,d),w(c,o,d),w(c,l,d),w(c,r,d),i||(a=[U(o,"click",n[16]),U(r,"click",n[17])],i=!0)},p(c,d){n=c,u.ctx=n,d[0]&256&&e!==(e=n[8])&&Re(e,u)||tt(u,n,d)},d(c){c&&(k(t),k(o),k(l),k(r)),u.block.d(c),u.token=null,u=null,i=!1,ne(a)}}}function An(n){let e,t,o;return{c(){e=b("p"),e.textContent="error",t=I(),o=b("br")},m(l,r){w(l,e,r),w(l,t,r),w(l,o,r)},p:E,d(l){l&&(k(e),k(t),k(o))}}}function Dn(n){let e,t=(n[25].name??He)+"",o,l,r,i=(n[25].description??"no description")+"",a,u,c,d;return{c(){e=b("p"),o=J(t),l=I(),r=b("p"),a=J(i),c=I(),d=b("br"),m(e,"class","pb-4 text-xl font-bold"),m(r,"class",u=n[25].description?null:"italic")},m(f,_){w(f,e,_),y(e,o),w(f,l,_),w(f,r,_),y(r,a),w(f,c,_),w(f,d,_)},p(f,_){_[0]&256&&t!==(t=(f[25].name??He)+"")&&ce(o,t),_[0]&256&&i!==(i=(f[25].description??"no description")+"")&&ce(a,i),_[0]&256&&u!==(u=f[25].description?null:"italic")&&m(r,"class",u)},d(f){f&&(k(e),k(l),k(r),k(c),k(d))}}}function qn(n){let e;return{c(){e=b("p"),e.textContent="loading..."},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function Bn(n){let e,t,o,l,r,i,a,u,c,d,f,_,g={ctx:n,current:null,token:null,hasCatch:!0,pending:Ln,then:vn,catch:yn,value:29};Re(u=n[2],g);function p(L,T){return L[3].hasBoltPlugins?Rn:Cn}let $=p(n),h=$(n);return{c(){e=b("div"),t=b("button"),o=J("Manage Plugins"),r=I(),i=b("hr"),a=I(),g.block.c(),c=I(),d=b("div"),h.c(),m(t,"class",l="mx-auto mb-2 w-[95%] rounded-lg border-2 "+(n[6]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75"),m(i,"class","p-1 dark:border-slate-700"),m(e,"class","left-0 float-left h-full w-[min(180px,_50%)] overflow-hidden border-r-2 border-slate-300 pt-2 dark:border-slate-800"),m(d,"class","h-full pt-10")},m(L,T){w(L,e,T),y(e,t),y(t,o),y(e,r),y(e,i),y(e,a),g.block.m(e,g.anchor=null),g.mount=()=>e,g.anchor=null,w(L,c,T),w(L,d,T),h.m(d,null),f||(_=U(t,"click",n[13]),f=!0)},p(L,T){n=L,T[0]&64&&l!==(l="mx-auto mb-2 w-[95%] rounded-lg border-2 "+(n[6]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75")&&m(t,"class",l),g.ctx=n,T[0]&4&&u!==(u=n[2])&&Re(u,g)||tt(g,n,T),$===($=p(n))&&h?h.p(n,T):(h.d(1),h=$(n),h&&(h.c(),h.m(d,null)))},d(L){L&&(k(e),k(c),k(d)),g.block.d(),g.token=null,g=null,h.d(),f=!1,_()}}}function Gn(n){let e,t,o={class:"h-[90%] w-[90%] text-center",$$slots:{default:[Bn]},$$scope:{ctx:n}};return e=new nt({props:o}),n[19](e),e.$on("close",n[20]),{c(){Y(e.$$.fragment)},m(l,r){z(e,l,r),t=!0},p(l,r){const i={};r[0]&495|r[1]&4&&(i.$$scope={dirty:r,ctx:l}),e.$set(i)},i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){n[19](null),Z(e,l)}}}const _t="bolt.json",He="(unnamed)",gt="(new character)";function Jn(n,e,t){let o,l;ae(n,Ke,v=>t(2,l=v));let r;const i=R.platform==="windows"?"\\":"/",a=i.concat(_t);function u(){r.open()}const c=v=>new Promise((G,q)=>{const ue=v.concat(v.endsWith(i)?_t:a);var se=new XMLHttpRequest;se.onreadystatechange=()=>{se.readyState==4&&(se.status==200?G(JSON.parse(se.responseText)):q(se.responseText))},se.open("GET","/read-json-file?".concat(new URLSearchParams({path:ue}).toString()),!0),se.send()}),d=v=>{const q=R.pluginList[v];if(!q)return null;const ue=q.path;return ue?c(ue):null},f=(v,G)=>{c(v).then(q=>{do t(0,$=crypto.randomUUID());while(Object.keys(R.pluginList).includes($));t(3,R.pluginList[$]={name:q.name??He,path:v},R),t(7,T=!0)}).catch(q=>{console.error(`Config file '${G}' couldn't be fetched, reason: ${q}`)})};let _=!1;const g=()=>{t(5,_=!0);var v=new XMLHttpRequest;v.onreadystatechange=()=>{if(v.readyState==4&&(t(5,_=!1),v.status==200))if(v.responseText.endsWith(a)){const G=v.responseText.substring(0,v.responseText.length-a.length);f(G,v.responseText)}else console.log(`Selection '${v.responseText}' is not named bolt.json; ignored`)},v.open("GET","/json-file-picker",!0),v.send()};Ke.set(Ot());const p=(v,G,q,ue)=>{var se=new XMLHttpRequest;se.onreadystatechange=()=>{se.readyState==4&&P.info(`Start-plugin status: ${se.statusText.trim()}`)},se.open("GET","/start-plugin?".concat(new URLSearchParams({client:v,id:G,path:q,main:ue}).toString()),!0),se.send()};var $,h=!1,L;let T=!1;const B=()=>t(6,h=!1),H=v=>{t(1,L=v.uid),t(6,h=!0)};function O(){$=Qe(this),t(0,$),t(3,R)}const N=()=>{t(8,o=null),t(7,T=!0);let v=R.pluginList;delete v[$],t(3,R.pluginList=v,R)},C=()=>t(8,o=d($)),S=v=>p(L,$,(R.pluginList[$].path??"").replaceAll("\\","/"),v.main??"");function x(v){fe[v?"unshift":"push"](()=>{r=v,t(4,r)})}const j=()=>{T&&an()};return n.$$.update=()=>{n.$$.dirty[0]&6&&l.then(v=>{v.some(G=>G.uid===L)||t(6,h=!1)}),n.$$.dirty[0]&1&&t(8,o=d($))},[$,L,l,R,r,_,h,T,o,d,g,p,u,B,H,O,N,C,S,x,j]}class Xn extends te{constructor(e){super(),ee(this,e,Jn,Gn,K,{open:12},null,[-1,-1])}get open(){return this.$$.ctx[12]}}function ht(n,e,t){const o=n.slice();return o[12]=e[t],o}function mt(n,e,t){const o=n.slice();return o[15]=e[t],o}function Fn(n){let e,t,o={};return e=new Xn({props:o}),n[8](e),{c(){Y(e.$$.fragment)},m(l,r){z(e,l,r),t=!0},p(l,r){const i={};e.$set(i)},i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){n[8](null),Z(e,l)}}}function Wn(n){let e,t,o;return{c(){e=b("button"),e.textContent="Plugin menu",e.disabled=!R.hasBoltPlugins,m(e,"title",R.hasBoltPlugins?null:"Coming soon..."),m(e,"class","w-52 rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(l,r){w(l,e,r),t||(o=U(e,"click",n[11]),t=!0)},p:E,d(l){l&&k(e),t=!1,o()}}}function Vn(n){let e,t,o,l,r,i,a=le(st[n[0].selected.game]),u=[];for(let c=0;c<a.length;c+=1)u[c]=bt(mt(n,a,c));return{c(){e=b("label"),t=b("span"),t.textContent="Game Client",o=I(),l=b("select");for(let c=0;c<u.length;c+=1)u[c].c();m(t,"class","text-sm"),m(l,"id","game_client_select"),m(l,"class","w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),n[0].selected.client===void 0&&Ce(()=>n[10].call(l)),m(e,"class","flex flex-col")},m(c,d){w(c,e,d),y(e,t),y(e,o),y(e,l);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(l,null);_e(l,n[0].selected.client,!0),r||(i=U(l,"change",n[10]),r=!0)},p(c,d){if(d&1){a=le(st[c[0].selected.game]);let f;for(f=0;f<a.length;f+=1){const _=mt(c,a,f);u[f]?u[f].p(_,d):(u[f]=bt(_),u[f].c(),u[f].m(l,null))}for(;f<u.length;f+=1)u[f].d(1);u.length=a.length}d&1&&_e(l,c[0].selected.client)},d(c){c&&k(e),Oe(u,c),r=!1,i()}}}function bt(n){let e,t=n[15]+"",o,l,r;return{c(){e=b("option"),o=J(t),m(e,"class","dark:bg-slate-900"),e.disabled=l=n[15]===pe.official&&R.platform==Pe.Linux,e.__value=r=n[15],Q(e,e.__value)},m(i,a){w(i,e,a),y(e,o)},p(i,a){a&1&&t!==(t=i[15]+"")&&ce(o,t),a&1&&l!==(l=i[15]===pe.official&&R.platform==Pe.Linux)&&(e.disabled=l),a&1&&r!==(r=i[15])&&(e.__value=r,Q(e,e.__value))},d(i){i&&k(e)}}}function kt(n){let e;return{c(){e=b("option"),e.textContent="No characters",m(e,"class","dark:bg-slate-900"),e.disabled=!0,e.selected=!0,e.__value="No characters",Q(e,e.__value)},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function zn(n){let e;return{c(){e=J("New Character")},m(t,o){w(t,e,o)},p:E,d(t){t&&k(e)}}}function Zn(n){let e=n[12].displayName+"",t;return{c(){t=J(e)},m(o,l){w(o,t,l)},p(o,l){l&8&&e!==(e=o[12].displayName+"")&&ce(t,e)},d(o){o&&k(t)}}}function wt(n){let e,t,o;function l(a,u){return a[12].displayName?Zn:zn}let r=l(n),i=r(n);return{c(){e=b("option"),i.c(),t=I(),e.__value=o=n[12].accountId,Q(e,e.__value),m(e,"class","dark:bg-slate-900")},m(a,u){w(a,e,u),i.m(e,null),y(e,t)},p(a,u){r===(r=l(a))&&i?i.p(a,u):(i.d(1),i=r(a),i&&(i.c(),i.m(e,t))),u&8&&o!==(o=a[12].accountId)&&(e.__value=o,Q(e,e.__value))},d(a){a&&k(e),i.d()}}}function Yn(n){let e,t,o,l,r,i,a,u,c,d,f,_,g,p,$,h,L,T,B,H=R.hasBoltPlugins&&Fn(n);function O(v,G){if(v[0].selected.game==V.osrs)return Vn;if(v[0].selected.game===V.rs3)return Wn}let N=O(n),C=N&&N(n),S=le(n[3]),x=[];for(let v=0;v<S.length;v+=1)x[v]=wt(ht(n,S,v));let j=null;return S.length||(j=kt()),{c(){H&&H.c(),e=I(),t=b("div"),o=b("div"),l=b("img"),i=I(),a=b("button"),a.textContent="Play",u=I(),C&&C.c(),c=I(),d=b("label"),f=b("span"),f.textContent="Character",_=I(),g=b("select"),p=b("option"),$=J("Select an account");for(let v=0;v<x.length;v+=1)x[v].c();j&&j.c(),At(l.src,r="svgs/rocket-solid.svg")||m(l,"src",r),m(l,"alt","Launch icon"),m(l,"class","mb-3 w-24 rounded-3xl bg-gradient-to-br from-rose-500 to-violet-500 p-5"),m(a,"class","w-52 rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75"),m(f,"class","text-sm"),p.__value=void 0,Q(p,p.__value),p.disabled=!0,m(p,"class","dark:bg-slate-900"),m(g,"id","character_select"),m(g,"class","mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),g.disabled=h=n[0].selected.user_id===null,m(d,"class","flex flex-col"),m(o,"class","flex flex-col items-center gap-4"),m(t,"class","bg-grad flex h-full flex-col border-slate-300 p-5 duration-200 dark:border-slate-800")},m(v,G){H&&H.m(v,G),w(v,e,G),w(v,t,G),y(t,o),y(o,l),y(o,i),y(o,a),y(o,u),C&&C.m(o,null),y(o,c),y(o,d),y(d,f),y(d,_),y(d,g),y(g,p),y(p,$);for(let q=0;q<x.length;q+=1)x[q]&&x[q].m(g,null);j&&j.m(g,null),_e(g,n[2]),L=!0,T||(B=[U(a,"click",n[9]),U(g,"change",n[6])],T=!0)},p(v,[G]){if(R.hasBoltPlugins&&H.p(v,G),N===(N=O(v))&&C?C.p(v,G):(C&&C.d(1),C=N&&N(v),C&&(C.c(),C.m(o,c))),G&8){S=le(v[3]);let q;for(q=0;q<S.length;q+=1){const ue=ht(v,S,q);x[q]?x[q].p(ue,G):(x[q]=wt(ue),x[q].c(),x[q].m(g,null))}for(;q<x.length;q+=1)x[q].d(1);x.length=S.length,!S.length&&j?j.p(v,G):S.length?j&&(j.d(1),j=null):(j=kt(),j.c(),j.m(g,null))}(!L||G&1&&h!==(h=v[0].selected.user_id===null))&&(g.disabled=h),(!L||G&12)&&_e(g,v[2])},i(v){L||(M(H),L=!0)},o(v){D(H),L=!1},d(v){v&&(k(e),k(t)),H&&H.d(v),C&&C.d(),Oe(x,v),j&&j.d(),T=!1,ne(B)}}}function Kn(n,e,t){let o,l,r,i,a,{config:u}=A;ae(n,u,$=>t(0,i=$));function c($,h){if(!o)return P.warn("Please log in or select a user to play.");if(!l)return P.warn("Please select a character from the select menu.");const L=X.findSession(i.selected.user_id);if(!L)return P.warn("Unable to launch game, session was not found.");const{session_id:T}=L,B=X.findAccount(L.accounts,l);if(!B)return P.warn("Unable to launch game, account was not found.");const{accountId:H,displayName:O}=B,N=R.platform===Pe.Windows,C=R.platform===Pe.Linux;switch($){case V.osrs:switch(h){case pe.official:rt(N,!0,T,H,O);break;case pe.runelite:Ht(T,H,O,!1);break;case pe.hdos:rn(T,H,O);break}break;case V.rs3:C?ln(T,H,O):rt(N,!1,T,H,O);break}}function d($){const h=$.target.value;if(!o)return;const L=i.userDetails[o];L?(L.account_id=h,Se(u,i.userDetails[o]=L,i)):Se(u,i.userDetails[o]={account_id:h},i)}function f($){fe[$?"unshift":"push"](()=>{a=$,t(1,a)})}const _=()=>c(i.selected.game,i.selected.client);function g(){i.selected.client=Qe(this),u.set(i)}const p=()=>{a.open()};return n.$$.update=()=>{var $,h;n.$$.dirty&1&&t(7,o=i.selected.user_id),n.$$.dirty&129&&t(2,l=($=i.userDetails[o??""])==null?void 0:$.account_id),n.$$.dirty&1&&t(3,r=((h=X.findSession(i.selected.user_id))==null?void 0:h.accounts)??[])},[i,a,l,r,u,c,d,o,f,_,g,p]}class Qn extends te{constructor(e){super(),ee(this,e,Kn,Yn,K,{})}}function yt(n,e,t){const o=n.slice();return o[1]=e[t].date,o[2]=e[t].severity,o[3]=e[t].content,o}function vt(n){var u;let e,t=((u=n[1])==null?void 0:u.toLocaleTimeString())+"",o,l,r=n[3]+"",i,a;return{c(){e=b("li"),o=J(t),l=J(`
				- `),i=J(r),a=I(),W(e,"text-rose-500",n[2]===Te.error),W(e,"text-orange-700",n[2]===Te.warn)},m(c,d){w(c,e,d),y(e,o),y(e,l),y(e,i),y(e,a)},p(c,d){var f;d&1&&t!==(t=((f=c[1])==null?void 0:f.toLocaleTimeString())+"")&&ce(o,t),d&1&&r!==(r=c[3]+"")&&ce(i,r),d&1&&W(e,"text-rose-500",c[2]===Te.error),d&1&&W(e,"text-orange-700",c[2]===Te.warn)},d(c){c&&k(e)}}}function es(n){let e,t,o,l,r=le(n[0]),i=[];for(let a=0;a<r.length;a+=1)i[a]=vt(yt(n,r,a));return{c(){e=b("div"),t=b("div"),t.innerHTML='<img src="svgs/circle-info-solid.svg" alt="Message list icon" class="h-7 w-7 rounded-full bg-blue-500 p-[3px] duration-200"/>',o=I(),l=b("ol");for(let a=0;a<i.length;a+=1)i[a].c();m(t,"class","absolute right-6 top-2"),m(l,"id","message_list"),m(l,"class","h-full list-inside list-disc overflow-y-auto pl-5 pt-1 marker:text-blue-500"),m(e,"class","fixed bottom-0 h-1/4 w-screen border-t-2 border-t-slate-300 bg-slate-100 duration-200 dark:border-t-slate-800 dark:bg-slate-900")},m(a,u){w(a,e,u),y(e,t),y(e,o),y(e,l);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(l,null)},p(a,[u]){if(u&1){r=le(a[0]);let c;for(c=0;c<r.length;c+=1){const d=yt(a,r,c);i[c]?i[c].p(d,u):(i[c]=vt(d),i[c].c(),i[c].m(l,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i:E,o:E,d(a){a&&k(e),Oe(i,a)}}}function ts(n,e,t){let{logs:o}=e;return n.$$set=l=>{"logs"in l&&t(0,o=l.logs)},[o]}class ns extends te{constructor(e){super(),ee(this,e,ts,es,K,{logs:0})}}function $t(n,e,t){const o=n.slice();return o[7]=e[t],o}function St(n,e){let t,o=e[7].user.displayName+"",l,r;return{key:n,first:null,c(){t=b("option"),l=J(o),t.__value=r=e[7].user.userId,Q(t,t.__value),m(t,"class","dark:bg-slate-900"),this.first=t},m(i,a){w(i,t,a),y(t,l)},p(i,a){e=i,a&2&&o!==(o=e[7].user.displayName+"")&&ce(l,o),a&2&&r!==(r=e[7].user.userId)&&(t.__value=r,Q(t,t.__value))},d(i){i&&k(t)}}}function ss(n){let e,t,o=[],l=new Map,r,i,a,u,c,d,f,_,g,p=le(n[1]);const $=h=>h[7].user.userId;for(let h=0;h<p.length;h+=1){let L=$t(n,p,h),T=$(L);l.set(T,o[h]=St(T,L))}return{c(){e=b("select"),t=b("option"),t.textContent="Select a user";for(let h=0;h<o.length;h+=1)o[h].c();r=I(),i=b("div"),a=b("button"),a.textContent="Log In",u=I(),c=b("button"),d=J("Log Out"),t.__value=null,Q(t,t.__value),t.disabled=!0,m(t,"class","dark:bg-slate-900"),m(e,"class","w-full cursor-pointer rounded-lg border-2 border-inherit bg-inherit p-2 text-center"),n[0].selected.user_id===void 0&&Ce(()=>n[4].call(e)),m(a,"class","mx-auto mr-2 rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),m(c,"class","mx-auto rounded-lg border-2 border-blue-500 p-2 font-bold duration-200 hover:opacity-75"),c.disabled=f=!n[0].selected.user_id,m(i,"class","mt-5 flex")},m(h,L){w(h,e,L),y(e,t);for(let T=0;T<o.length;T+=1)o[T]&&o[T].m(e,null);_e(e,n[0].selected.user_id,!0),w(h,r,L),w(h,i,L),y(i,a),y(i,u),y(i,c),y(c,d),_||(g=[U(e,"change",n[4]),U(a,"click",n[5]),U(c,"click",n[6])],_=!0)},p(h,[L]){L&2&&(p=le(h[1]),o=Kt(o,L,$,1,h,p,l,e,Yt,St,null,$t)),L&3&&_e(e,h[0].selected.user_id),L&3&&f!==(f=!h[0].selected.user_id)&&(c.disabled=f)},i:E,o:E,d(h){h&&(k(e),k(r),k(i));for(let L=0;L<o.length;L+=1)o[L].d();_=!1,ne(g)}}}function os(n,e,t){let o,l;const{sessions:r,config:i}=A;ae(n,r,d=>t(1,l=d)),ae(n,i,d=>t(0,o=d));function a(){o.selected.user_id=Qe(this),i.set(o)}return[o,l,r,i,a,()=>{const{origin:d,redirect:f,clientid:_}=R.env;oe.openLoginWindow(d,f,_)},async()=>{o.selected.user_id&&(await X.logout(o.selected.user_id),X.saveCredentials())}]}class ls extends te{constructor(e){super(),ee(this,e,os,ss,K,{})}}function rs(n,{callback:e,ignore:t=[]}){const o=l=>{const r=t.some(i=>i.contains(l.target));n&&!n.contains(l.target)&&!l.defaultPrevented&&!r&&e()};return document.addEventListener("click",o,!0),document.addEventListener("contextmenu",o,!0),{destroy(){document.removeEventListener("click",o,!0),document.removeEventListener("contextmenu",o,!0)}}}const is=n=>({}),Lt=n=>({});function Ct(n){let e,t,o,l,r,i;const a=n[9].content,u=Be(a,n,n[8],Lt);return{c(){e=b("div"),u&&u.c(),m(e,"class",t="dropdown-color absolute z-20 rounded-lg border-2 "+n[1]+" "+n[2]+" svelte-xifudk")},m(c,d){w(c,e,d),u&&u.m(e,null),l=!0,r||(i=qt(o=rs.call(null,e,{callback:n[3],ignore:[n[5]]})),r=!0)},p(c,d){u&&u.p&&(!l||d&256)&&Je(u,a,c,c[8],l?Ge(a,c[8],d,is):Xe(c[8]),Lt),(!l||d&6&&t!==(t="dropdown-color absolute z-20 rounded-lg border-2 "+c[1]+" "+c[2]+" svelte-xifudk"))&&m(e,"class",t),o&&qe(o.update)&&d&32&&o.update.call(null,{callback:c[3],ignore:[c[5]]})},i(c){l||(M(u,c),l=!0)},o(c){D(u,c),l=!1},d(c){c&&k(e),u&&u.d(c),r=!1,i()}}}function as(n){let e,t,o,l,r,i,a;const u=n[9].default,c=Be(u,n,n[8],null);let d=n[4]&&Ct(n);return{c(){e=b("div"),t=b("button"),c&&c.c(),o=I(),d&&d.c(),m(e,"class",l="relative h-fit w-fit "+n[0]+" svelte-xifudk")},m(f,_){w(f,e,_),y(e,t),c&&c.m(t,null),n[10](t),y(e,o),d&&d.m(e,null),r=!0,i||(a=U(t,"click",n[6]),i=!0)},p(f,[_]){c&&c.p&&(!r||_&256)&&Je(c,u,f,f[8],r?Ge(u,f[8],_,null):Xe(f[8]),null),f[4]?d?(d.p(f,_),_&16&&M(d,1)):(d=Ct(f),d.c(),M(d,1),d.m(e,null)):d&&(Ee(),D(d,1,1,()=>{d=null}),Ue()),(!r||_&1&&l!==(l="relative h-fit w-fit "+f[0]+" svelte-xifudk"))&&m(e,"class",l)},i(f){r||(M(c,f),M(d),r=!0)},o(f){D(c,f),D(d),r=!1},d(f){f&&k(e),c&&c.d(f),n[10](null),d&&d.d(),i=!1,a()}}}function cs(n,e,t){let{$$slots:o={},$$scope:l}=e,{class:r=""}=e,{position:i="bottom"}=e,{align:a="start"}=e,u=!1,c;function d(){t(4,u=!0)}function f(){t(4,u=!1)}function _(){u?f():d()}function g(p){fe[p?"unshift":"push"](()=>{c=p,t(5,c)})}return n.$$set=p=>{"class"in p&&t(0,r=p.class),"position"in p&&t(1,i=p.position),"align"in p&&t(2,a=p.align),"$$scope"in p&&t(8,l=p.$$scope)},[r,i,a,f,u,c,_,d,l,o,g]}class us extends te{constructor(e){super(),ee(this,e,cs,as,K,{class:0,position:1,align:2,open:7,close:3})}get open(){return this.$$.ctx[7]}get close(){return this.$$.ctx[3]}}function ds(n){let e,t,o;return{c(){e=b("button"),e.innerHTML=`<div class="flex"><img src="svgs/database-solid.svg" alt="Browse app data" class="mr-2 h-7 w-7 rounded-lg bg-violet-500 p-1"/>
		Browse App Data</div>`,m(e,"id","data_dir_button"),m(e,"class","p-2 hover:opacity-75")},m(l,r){w(l,e,r),t||(o=U(e,"click",n[1]),t=!0)},p:E,i:E,o:E,d(l){l&&k(e),t=!1,o()}}}function fs(n){function e(){var o=new XMLHttpRequest;o.open("GET","/browse-data"),o.onreadystatechange=()=>{o.readyState==4&&P.info(`Browse status: '${o.responseText.trim()}'`)},o.send()}return[e,()=>{e()}]}class ps extends te{constructor(e){super(),ee(this,e,fs,ds,K,{})}}function _s(n){let e,t,o,l,r,i,a,u,c,d,f,_,g,p,$,h,L,T,B;return{c(){var H,O;e=b("button"),t=b("div"),t.innerHTML=`<img src="svgs/wrench-solid.svg" alt="Configure RuneLite" class="mr-2 h-7 w-7 rounded-lg bg-pink-500 p-1"/>
		Configure RuneLite`,l=I(),r=b("div"),i=b("label"),i.textContent="Use custom RuneLite JAR:",a=I(),u=b("input"),c=I(),d=b("div"),f=b("textarea"),g=I(),p=b("br"),$=I(),h=b("button"),L=J("Select File"),m(t,"class","flex"),e.disabled=o=!((H=n[0])!=null&&H.session_id)||!((O=n[3])!=null&&O.accountId),m(e,"class","p-2 pb-5 hover:opacity-75"),m(i,"for","use_custom_jar"),m(u,"type","checkbox"),m(u,"class","ml-2"),m(r,"class","mx-auto border-t-2 border-slate-300 p-2 pt-5 dark:border-slate-800"),m(f,"class","h-10 rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),f.disabled=_=!n[1].runelite_use_custom_jar,m(h,"class","mt-1 rounded-lg border-2 border-blue-500 p-1 duration-200 hover:opacity-75"),h.disabled=n[2],m(d,"class","mx-auto p-2"),W(d,"opacity-25",!n[1].runelite_use_custom_jar)},m(H,O){w(H,e,O),y(e,t),w(H,l,O),w(H,r,O),y(r,i),y(r,a),y(r,u),u.checked=n[1].runelite_use_custom_jar,w(H,c,O),w(H,d,O),y(d,f),Q(f,n[1].runelite_custom_jar),y(d,g),y(d,p),y(d,$),y(d,h),y(h,L),T||(B=[U(e,"click",n[7]),U(u,"change",n[8]),U(f,"input",n[9]),U(h,"click",n[10])],T=!0)},p(H,[O]){var N,C;O&9&&o!==(o=!((N=H[0])!=null&&N.session_id)||!((C=H[3])!=null&&C.accountId))&&(e.disabled=o),O&2&&(u.checked=H[1].runelite_use_custom_jar),O&2&&_!==(_=!H[1].runelite_use_custom_jar)&&(f.disabled=_),O&2&&Q(f,H[1].runelite_custom_jar),O&4&&(h.disabled=H[2]),O&2&&W(d,"opacity-25",!H[1].runelite_use_custom_jar)},i:E,o:E,d(H){H&&(k(e),k(l),k(r),k(c),k(d)),T=!1,ne(B)}}}function gs(n,e,t){let o,l,r;const{config:i}=A;ae(n,i,p=>t(1,r=p));let a=!1;async function u(){t(2,a=!0),Se(i,r.runelite_custom_jar=await X.openFilePicker(),r),console.log("done picking"),t(2,a=!1)}function c(){!(o!=null&&o.session_id)||!(l!=null&&l.accountId)||!(l!=null&&l.displayName)||Ht(o.session_id,l.accountId,l.displayName,!0)}const d=()=>c();function f(){r.runelite_use_custom_jar=this.checked,i.set(r)}function _(){r.runelite_custom_jar=this.value,i.set(r)}const g=()=>{u()};return n.$$.update=()=>{var p;n.$$.dirty&2&&t(0,o=X.findSession(r.selected.user_id)),n.$$.dirty&3&&t(3,l=X.findAccount((o==null?void 0:o.accounts)??[],(p=r.userDetails[r.selected.user_id??""])==null?void 0:p.account_id))},[o,r,a,l,i,u,c,d,f,_,g]}class hs extends te{constructor(e){super(),ee(this,e,gs,_s,K,{})}}function ms(n){let e,t,o,l,r,i;return{c(){e=b("div"),t=b("label"),t.textContent="Enable Bolt plugin loader:",o=I(),l=b("input"),m(t,"for","enable_plugins"),m(l,"type","checkbox"),m(l,"name","enable_plugins"),m(l,"id","enable_plugins"),m(l,"class","ml-2"),m(e,"class","mx-auto p-2")},m(a,u){w(a,e,u),y(e,t),y(e,o),y(e,l),l.checked=n[0].rs_plugin_loader,r||(i=U(l,"change",n[2]),r=!0)},p(a,u){u&1&&(l.checked=a[0].rs_plugin_loader)},d(a){a&&k(e),r=!1,i()}}}function bs(n){let e,t,o,l,r,i,a,u,c,d,f,_=R.hasBoltPlugins&&ms(n);return{c(){_&&_.c(),e=I(),t=b("div"),o=b("label"),o.textContent="Use custom config URI:",l=I(),r=b("input"),i=I(),a=b("div"),u=b("textarea"),m(o,"for","use_custom_uri"),m(r,"type","checkbox"),m(r,"class","ml-2"),m(t,"class","mx-auto p-2"),m(u,"class","rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),u.disabled=c=!n[0].use_custom_rs_config_uri,m(u,"rows","4"),m(u,"placeholder",R.env.default_config_uri),m(a,"class","p-2")},m(g,p){_&&_.m(g,p),w(g,e,p),w(g,t,p),y(t,o),y(t,l),y(t,r),r.checked=n[0].use_custom_rs_config_uri,w(g,i,p),w(g,a,p),y(a,u),Q(u,n[0].rs_config_uri),d||(f=[U(r,"change",n[3]),U(u,"input",n[4])],d=!0)},p(g,[p]){R.hasBoltPlugins&&_.p(g,p),p&1&&(r.checked=g[0].use_custom_rs_config_uri),p&1&&c!==(c=!g[0].use_custom_rs_config_uri)&&(u.disabled=c),p&1&&Q(u,g[0].rs_config_uri)},i:E,o:E,d(g){g&&(k(e),k(t),k(i),k(a)),_&&_.d(g),d=!1,ne(f)}}}function ks(n,e,t){let o;const{config:l}=A;ae(n,l,u=>t(0,o=u));function r(){o.rs_plugin_loader=this.checked,l.set(o)}function i(){o.use_custom_rs_config_uri=this.checked,l.set(o)}function a(){o.rs_config_uri=this.value,l.set(o)}return[o,l,r,i,a]}class ws extends te{constructor(e){super(),ee(this,e,ks,bs,K,{})}}function ys(n){let e,t;return e=new ws({}),{c(){Y(e.$$.fragment)},m(o,l){z(e,o,l),t=!0},i(o){t||(M(e.$$.fragment,o),t=!0)},o(o){D(e.$$.fragment,o),t=!1},d(o){Z(e,o)}}}function vs(n){let e,t;return e=new hs({}),{c(){Y(e.$$.fragment)},m(o,l){z(e,o,l),t=!0},i(o){t||(M(e.$$.fragment,o),t=!0)},o(o){D(e.$$.fragment,o),t=!1},d(o){Z(e,o)}}}function $s(n){let e,t;return e=new ps({}),{c(){Y(e.$$.fragment)},m(o,l){z(e,o,l),t=!0},i(o){t||(M(e.$$.fragment,o),t=!0)},o(o){D(e.$$.fragment,o),t=!1},d(o){Z(e,o)}}}function Ss(n){let e,t,o,l,r,i,a,u,c,d,f,_,g,p,$,h,L,T,B,H;const O=[$s,vs,ys],N=[];function C(S,x){return S[1]==S[2].general?0:S[1]==S[2].osrs?1:S[1]==S[2].rs3?2:-1}return~(h=C(n))&&(L=N[h]=O[h](n)),{c(){e=b("div"),t=b("div"),o=b("button"),l=J("General"),i=I(),a=b("button"),u=J("OSRS"),d=I(),f=b("button"),_=J("RS3"),p=I(),$=b("div"),L&&L.c(),m(o,"class",r=n[1]===n[2].general?ke:we),m(a,"class",c=n[1]===n[2].osrs?ke:we),m(f,"class",g=n[1]===n[2].rs3?ke:we),m(t,"class","flex flex-col items-center gap-2 border-r-2 border-slate-300 pt-10 dark:border-slate-800"),m($,"class","col-span-3 p-5 pt-10 text-center"),m(e,"class","grid h-full grid-cols-4")},m(S,x){w(S,e,x),y(e,t),y(t,o),y(o,l),y(t,i),y(t,a),y(a,u),y(t,d),y(t,f),y(f,_),y(e,p),y(e,$),~h&&N[h].m($,null),T=!0,B||(H=[U(o,"click",n[4]),U(a,"click",n[5]),U(f,"click",n[6])],B=!0)},p(S,x){(!T||x&2&&r!==(r=S[1]===S[2].general?ke:we))&&m(o,"class",r),(!T||x&2&&c!==(c=S[1]===S[2].osrs?ke:we))&&m(a,"class",c),(!T||x&2&&g!==(g=S[1]===S[2].rs3?ke:we))&&m(f,"class",g);let j=h;h=C(S),h!==j&&(L&&(Ee(),D(N[j],1,1,()=>{N[j]=null}),Ue()),~h?(L=N[h],L||(L=N[h]=O[h](S),L.c()),M(L,1),L.m($,null)):L=null)},i(S){T||(M(L),T=!0)},o(S){D(L),T=!1},d(S){S&&k(e),~h&&N[h].d(),B=!1,ne(H)}}}function Ls(n){let e,t,o={class:"h-3/4 w-3/4",$$slots:{default:[Ss]},$$scope:{ctx:n}};return e=new nt({props:o}),n[7](e),{c(){Y(e.$$.fragment)},m(l,r){z(e,l,r),t=!0},p(l,[r]){const i={};r&258&&(i.$$scope={dirty:r,ctx:l}),e.$set(i)},i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){n[7](null),Z(e,l)}}}let ke="border-2 border-blue-500 bg-blue-500 hover:opacity-75 font-bold text-black duration-200 rounded-lg p-1 w-3/4",we="border-2 border-blue-500 hover:opacity-75 duration-200 rounded-lg p-1 w-3/4";function Cs(n,e,t){let o;function l(){o.open()}var r=(f=>(f[f.general=0]="general",f[f.osrs=1]="osrs",f[f.rs3=2]="rs3",f))(r||{});let i=1;const a=()=>{t(1,i=r.general)},u=()=>{t(1,i=r.osrs)},c=()=>{t(1,i=r.rs3)};function d(f){fe[f?"unshift":"push"](()=>{o=f,t(0,o)})}return[o,i,r,l,a,u,c,d]}class Rs extends te{constructor(e){super(),ee(this,e,Cs,Ls,K,{open:3})}get open(){return this.$$.ctx[3]}}function xs(n){const e=n.slice(),t=X.findSession(e[1].selected.user_id??"");return e[11]=t,e}function Ts(n){let e,t,o;return{c(){e=b("button"),e.textContent="Login",m(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit p-2 text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(l,r){w(l,e,r),t||(o=U(e,"click",n[10]),t=!0)},p:E,i:E,o:E,d(l){l&&k(e),t=!1,o()}}}function Ps(n){let e,t;return e=new us({props:{align:"center",$$slots:{content:[Hs],default:[Is]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},m(o,l){z(e,o,l),t=!0},p(o,l){const r={};l&4098&&(r.$$scope={dirty:l,ctx:o}),e.$set(r)},i(o){t||(M(e.$$.fragment,o),t=!0)},o(o){D(e.$$.fragment,o),t=!1},d(o){Z(e,o)}}}function Is(n){var l;let e,t=(((l=n[11])==null?void 0:l.user.displayName)??"No user selected")+"",o;return{c(){e=b("button"),o=J(t),m(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(r,i){w(r,e,i),y(e,o)},p(r,i){var a;i&2&&t!==(t=(((a=r[11])==null?void 0:a.user.displayName)??"No user selected")+"")&&ce(o,t)},d(r){r&&k(e)}}}function Hs(n){let e,t,o;return t=new ls({}),{c(){e=b("div"),Y(t.$$.fragment),m(e,"slot","content"),m(e,"class","w-40")},m(l,r){w(l,e,r),z(t,e,null),o=!0},p:E,i(l){o||(M(t.$$.fragment,l),o=!0)},o(l){D(t.$$.fragment,l),o=!1},d(l){l&&k(e),Z(t)}}}function Os(n){let e,t,o,l,r,i,a,u,c,d,f,_,g,p,$,h,L,T,B={};e=new Rs({props:B}),n[5](e);const H=[Ps,Ts],O=[];function N(S,x){return S[2].length>0?0:1}function C(S,x){return x===0?xs(S):S}return p=N(n),$=O[p]=H[p](C(n,p)),{c(){Y(e.$$.fragment),t=I(),o=b("div"),l=b("div"),r=b("button"),r.textContent="RS3",i=I(),a=b("button"),a.textContent="OSRS",u=I(),c=b("div"),d=b("button"),d.innerHTML='<img src="svgs/lightbulb-solid.svg" class="m-auto h-6 w-6" alt="Change Theme"/>',f=I(),_=b("button"),_.innerHTML='<img src="svgs/gear-solid.svg" class="m-auto h-6 w-6" alt="Settings"/>',g=I(),$.c(),m(r,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75"),W(r,"text-black",n[1].selected.game===V.rs3),W(r,"bg-blue-500",n[1].selected.game===V.rs3),m(a,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 bg-blue-500 p-2 text-black duration-200 hover:opacity-75"),W(a,"text-black",n[1].selected.game===V.osrs),W(a,"bg-blue-500",n[1].selected.game===V.osrs),m(l,"class","m-3 ml-9 font-bold"),m(d,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),m(_,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),m(c,"class","m-2 ml-auto flex gap-2"),m(o,"class","fixed top-0 flex h-16 w-screen border-b-2 border-slate-300 bg-slate-100 duration-200 dark:border-slate-800 dark:bg-slate-900")},m(S,x){z(e,S,x),w(S,t,x),w(S,o,x),y(o,l),y(l,r),y(l,i),y(l,a),y(o,u),y(o,c),y(c,d),y(c,f),y(c,_),y(c,g),O[p].m(c,null),h=!0,L||(T=[U(r,"click",n[6]),U(a,"click",n[7]),U(d,"click",n[8]),U(_,"click",n[9])],L=!0)},p(S,[x]){const j={};e.$set(j),(!h||x&2)&&W(r,"text-black",S[1].selected.game===V.rs3),(!h||x&2)&&W(r,"bg-blue-500",S[1].selected.game===V.rs3),(!h||x&2)&&W(a,"text-black",S[1].selected.game===V.osrs),(!h||x&2)&&W(a,"bg-blue-500",S[1].selected.game===V.osrs);let v=p;p=N(S),p===v?O[p].p(C(S,p),x):(Ee(),D(O[v],1,1,()=>{O[v]=null}),Ue(),$=O[p],$?$.p(C(S,p),x):($=O[p]=H[p](C(S,p)),$.c()),M($,1),$.m(c,null))},i(S){h||(M(e.$$.fragment,S),M($),h=!0)},o(S){D(e.$$.fragment,S),D($),h=!1},d(S){S&&(k(t),k(o)),n[5](null),Z(e,S),O[p].d(),L=!1,ne(T)}}}function Es(n,e,t){let o,l;const{config:r,sessions:i}=A;ae(n,r,p=>t(1,o=p)),ae(n,i,p=>t(2,l=p));let a;function u(p){fe[p?"unshift":"push"](()=>{a=p,t(0,a)})}return[a,o,l,r,i,u,()=>{Se(r,o.selected.game=V.rs3,o)},()=>{Se(r,o.selected.game=V.osrs,o)},()=>Se(r,o.use_dark_theme=!o.use_dark_theme,o),()=>a.open(),()=>{const{origin:p,redirect:$,clientid:h}=R.env;oe.openLoginWindow(p,$,h)}]}class Us extends te{constructor(e){super(),ee(this,e,Es,Os,K,{})}}function Ns(n){let e,t,o,l,r,i,a,u,c,d,f,_,g;return e=new wn({}),o=new Us({}),u=new Qn({}),_=new ns({props:{logs:n[0]}}),{c(){Y(e.$$.fragment),t=I(),Y(o.$$.fragment),l=I(),r=b("div"),i=b("div"),a=I(),Y(u.$$.fragment),c=I(),d=b("div"),f=I(),Y(_.$$.fragment),m(r,"class","mt-16 grid h-full grid-flow-col grid-cols-3")},m(p,$){z(e,p,$),w(p,t,$),z(o,p,$),w(p,l,$),w(p,r,$),y(r,i),y(r,a),z(u,r,null),y(r,c),y(r,d),w(p,f,$),z(_,p,$),g=!0},p(p,$){const h={};$&1&&(h.logs=p[0]),_.$set(h)},i(p){g||(M(e.$$.fragment,p),M(o.$$.fragment,p),M(u.$$.fragment,p),M(_.$$.fragment,p),g=!0)},o(p){D(e.$$.fragment,p),D(o.$$.fragment,p),D(u.$$.fragment,p),D(_.$$.fragment,p),g=!1},d(p){p&&(k(t),k(l),k(r),k(f)),Z(e,p),Z(o,p),Z(u),Z(_,p)}}}function js(n){let e,t,o,l;return e=new Et({props:{$$slots:{default:[Ns]},$$scope:{ctx:n}}}),{c(){Y(e.$$.fragment)},m(r,i){z(e,r,i),t=!0,o||(l=U(window,"beforeunload",n[2]),o=!0)},p(r,[i]){const a={};i&9&&(a.$$scope={dirty:i,ctx:r}),e.$set(a)},i(r){t||(M(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){Z(e,r),o=!1,l()}}}function Ms(n,e,t){let o;const l=P.logs;return ae(n,l,i=>t(0,o=i)),[o,l,()=>X.saveConfig()]}class As extends te{constructor(e){super(),ee(this,e,Ms,js,K,{})}}const Rt={target:document.getElementById("app")};window.opener||window.location.search.includes("&id_token")?new _n(Rt):(Ds(),on(),qs(),Bs(),new As(Rt));function Ds(){const n=new URLSearchParams(window.location.search);R.platform=n.get("platform"),R.isFlathub=n.get("flathub")==="1",R.rs3DebInstalledHash=n.get("rs3_deb_installed_hash"),R.rs3ExeInstalledHash=n.get("rs3_exe_installed_hash"),R.rs3AppInstalledHash=n.get("rs3_app_installed_hash"),R.osrsExeInstalledHash=n.get("osrs_exe_installed_hash"),R.osrsAppInstalledHash=n.get("osrs_app_installed_hash"),R.runeLiteInstalledId=n.get("runelite_installed_id"),R.hdosInstalledVersion=n.get("hdos_installed_version");const e=n.get("plugins");if(R.hasBoltPlugins=e!==null,e!==null)try{R.pluginList=JSON.parse(e)}catch{P.error("Unable to parse plugin list")}const t=n.get("credentials");if(t)try{const o=JSON.parse(t),l=o.every(r=>typeof r.session_id=="string"&&typeof r.tokens=="object"&&typeof r.accounts=="object"&&typeof r.user=="object");l?A.sessions.set(o):(A.sessions.set([]),X.saveCredentials(),P.warn("Credentials saved on disk are out of date. Please sign in again.")),A.sessions.set(l?o:[])}catch{A.sessions.set([]),X.saveCredentials(),P.error("Unable to parse saved credentials. Please sign in again.")}}function qs(){const{origin:n,origin_2fa:e}=R.env,t=[window.location.origin,n,e];let o=null;window.addEventListener("message",async l=>{var r;if(!t.includes(l.origin)){P.info(`discarding window message from origin ${l.origin}`);return}switch(l.data.type){case"authTokenUpdate":{o=l.data.tokens;break}case"authSessionUpdate":{if(o===null)return P.error("auth is null. Please try again.");const i=l.data.sessionId,a=await X.login(o,i);a.ok?P.info(`Added new user '${a.value.user.displayName}'`):P.error(`Unable to add new user. Please try again. ${a.error}`),X.saveCredentials(),oe.pendingLoginWindow=null,o=null;break}case"authFailed":{P.error(`Unable to authenticate: ${l.data.reason}`),oe.pendingLoginWindow=null,o=null;break}case"externalUrl":{const i=new XMLHttpRequest;i.onreadystatechange=()=>{i.readyState==4&&P.info(`External URL status: '${i.responseText.trim()}'`)},i.open("POST","/open-external-url",!0),i.send(l.data.url);break}case"gameClientListUpdate":Ke.set(Ot());break;default:{const i=((r=l.data)==null?void 0:r.type)??"no type provided";P.info(`Unknown message type: ${i}`);break}}})}async function Bs(){const n=ie(A.sessions),e=[];for(const t of n){const o=await oe.refreshOAuthToken(t.tokens);if(!o.ok){o.error===0?P.error(`Unable to verify saved login, status: ${o.error}. Do you have an internet connection? Please relaunch Bolt to try again.`):(P.error(`Discarding expired login, status: ${o.error}. Please sign in again.`),e.push(t.tokens.sub));continue}const l=o.value;t.tokens=l;const r=await X.login(l,t.session_id);r.ok?P.info(`Signed into saved user '${r.value.user.displayName}'`):(P.error(`Unable to sign into saved user '${t.user.displayName}' - please sign in again. ${r.error}`),e.push(t.tokens.sub))}e.forEach(t=>{X.logout(t)}),A.sessions.set(n),X.saveCredentials()}
