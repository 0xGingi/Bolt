var Wt=Object.defineProperty;var Vt=(n,e,t)=>e in n?Wt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var xe=(n,e,t)=>(Vt(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();var st=(n=>(n[n.SECOND=1e3]="SECOND",n[n.MINUTE=6e4]="MINUTE",n[n.HALF_HOUR=18e5]="HALF_HOUR",n[n.HOUR=36e5]="HOUR",n[n.DAY=864e5]="DAY",n[n.WEEK=6048e5]="WEEK",n[n.MONTH=2592e6]="MONTH",n))(st||{});class Re{static set(e,t,l,o){const r=new Date;r.setTime(r.getTime()+l*o);const i=`expires=${r.toUTCString()}`;document.cookie=`${e}=${t};${i};path=/`}static get(e){const t=`${e}=`,l=document.cookie.split(";");for(let o=0;o<l.length;o++){let r=l[o];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(t)===0)return r.substring(t.length,r.length)}return null}static remove(e){document.cookie=`${e}=; Max-Age=-99999999;`}}function fe(n){return{ok:!0,value:n}}function J(n){return{ok:!1,error:n}}var V=(n=>(n.rs3="rs3",n.osrs="osrs",n))(V||{}),me=(n=>(n.official="Official",n.runelite="RuneLite",n.hdos="HDOS",n))(me||{});const ct={rs3:["Official"],osrs:["Official","RuneLite","HDOS"]};class qe{static parseTokenResponse(e){try{const t=JSON.parse(e),l=t.id_token.split(".");if(l.length!==3){const i=`Malformed id_token: ${l.length} sections, expected 3`;return J(i)}const o=JSON.parse(atob(l[0]));if(o.typ!=="JWT"){const i=`Bad id_token header: typ ${o.typ}, expected JWT`;return J(i)}const r=JSON.parse(atob(l[1]));return fe({access_token:t.access_token,id_token:t.id_token,refresh_token:t.refresh_token,sub:r.sub,expiry:Date.now()+t.expires_in*1e3})}catch{return J("Unable to parse token response")}}static parseSessionResponse(e){try{const t=JSON.parse(e);return t.sessionId?fe(t.sessionId):J("sessionId does not exist on parsed object")}catch{return J("Unable to parse session response")}}static decodeBolt(e){const t={};for(const l in e){const o=l,r=e[o];typeof r=="string"?t[o]=atob(r):Array.isArray(r)&&r.every(i=>typeof i=="string")?t[o]=r.map(i=>atob(i)):t[o]=r}return t}}var Ue=(n=>(n.Windows="windows",n.Linux="linux",n.MacOS="mac",n))(Ue||{});const C={env:qe.decodeBolt(s()),platform:null,rs3DebInstalledHash:null,rs3ExeInstalledHash:null,rs3AppInstalledHash:null,osrsExeInstalledHash:null,osrsAppInstalledHash:null,runeLiteInstalledId:null,hdosInstalledVersion:null,isFlathub:!1,hasBoltPlugins:!1,pluginList:{}};class Ke{static async makeLoginUrl(e){const t=new TextEncoder().encode(e.pkceCodeVerifier),l=await crypto.subtle.digest("SHA-256",t);let o="";const r=new Uint8Array(l);for(let a=0;a<r.byteLength;a++)o+=String.fromCharCode(r[a]);const i=btoa(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return e.origin.concat("/oauth2/auth?").concat(new URLSearchParams({auth_method:e.authMethod,login_type:e.loginType,flow:e.flow,response_type:"code",client_id:e.clientid,redirect_uri:e.redirect,code_challenge:i,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:e.pkceState}).toString())}static makeRandomVerifier(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=new Uint32Array(43);return crypto.getRandomValues(t),Array.from(t,function(l){return e[l%e.length]}).join("")}static makeRandomState(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",l=t.length-1,o=crypto.getRandomValues(new Uint8Array(12));return Array.from(o).map(r=>Math.round(r*(l-0)/255+0)).map(r=>t[r]).join("")}}const Te=class Te{static async openLoginWindow(e,t,l){if(Te.pendingLoginWindow!==null)return Te.pendingLoginWindow.window.focus();const o=Ke.makeRandomState(),r=Ke.makeRandomVerifier(),i=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",i);let u="";const c=new Uint8Array(a);for(let g=0;g<c.byteLength;g++)u+=String.fromCharCode(c[g]);const d=btoa(u).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),f=new URLSearchParams({auth_method:"",login_type:"",flow:"launcher",response_type:"code",client_id:l,redirect_uri:t,code_challenge:d,code_challenge_method:"S256",prompt:"login",scope:"openid offline gamesso.token.create user.profile.read",state:o}),_=`${e}/oauth2/auth?${f.toString()}`;Re.set("auth_verifier",r,10,st.MINUTE),Te.pendingLoginWindow=window.open(_,"","width=480,height=720")}static navigateToAuthConsent(e,t,l){const o=Ke.makeRandomState(),r=new URLSearchParams({id_token_hint:t,nonce:l,prompt:"consent",redirect_uri:"http://localhost",response_type:"id_token code",state:o,client_id:"1fddee4e-b100-4f4e-b2b0-097f9088f9d2",scope:"openid offline"}),i=`${e}/oauth2/auth?${r.toString()}`;Re.set("auth_nonce",l,10,st.MINUTE),window.location.href=i}static async refreshOAuthToken(e){return new Promise(t=>{if(e.expiry-Date.now()<3e4){const l=new URLSearchParams({grant_type:"refresh_token",client_id:C.env.clientid,refresh_token:e.refresh_token}),o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const i=qe.parseTokenResponse(o.response);i.ok?t(fe(i.value)):t(J(0))}else t(J(o.status))},o.onerror=()=>{t(J(0))};const r=C.env.origin.concat("/oauth2/token");o.open("POST",r,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.setRequestHeader("Accept","application/json"),o.send(l)}else t(fe(e))})}static async getOAuthToken(e,t,l,o,r){const i=`${e}/oauth2/token`;return new Promise(a=>{const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(u.readyState==4)if(u.status==200){const d=qe.parseTokenResponse(u.response);return d.ok?a(fe(d.value)):a(J(d.error))}else return a(J(`Error: from ${i}: ${u.status}: ${u.response}`))},u.open("POST",i,!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.setRequestHeader("Accept","application/json");const c=new URLSearchParams({grant_type:"authorization_code",client_id:t,code:r,code_verifier:l,redirect_uri:o});u.send(c)})}static revokeOauthCreds(e){const t=`${C.env.origin}/oauth2/revoke`;return new Promise(l=>{const o=new XMLHttpRequest;o.open("POST",t,!0),o.onreadystatechange=()=>{o.readyState==4&&l(o.status)},o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");const r=new URLSearchParams({token:e,client_id:C.env.clientid});o.send(r)})}static async getSessionId(e,t){const l=`${e}/sessions`;return new Promise(o=>{const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const a=qe.parseSessionResponse(r.response);return a.ok?o(fe(a.value)):o(J(a.error))}else J(`Error: from ${l}: ${r.status}: ${r.response}`)},r.open("POST",l,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json");const i={idToken:t};r.send(JSON.stringify(i))})}static validateIdToken(e,t){const l=e.split(".");if(l.length!==3)return J(`Malformed id_token: ${l.length} sections, expected 3`);const o=JSON.parse(atob(l[0]));return o.typ!=="JWT"?J(`Bad id_token header: typ ${o.typ}, expected JWT`):JSON.parse(atob(l[1])).nonce!==t?J("Incorrect nonce in id_token"):fe(void 0)}};xe(Te,"pendingLoginWindow",null);let ce=Te;class Ge{static async buildSession(e,t){const l=await Ge.getUser(e.sub,e.access_token);if(!l.ok)return J(`Failed to fetch user. Status: ${l.error}`);const o=await Ge.getUserAccounts(t);return o.ok?fe({user:l.value,accounts:o.value,tokens:e,session_id:t}):J(`Failed to fetch game accounts. Status: ${o.error}`)}static getUser(e,t){return new Promise(l=>{const o=`${C.env.api}/users/${e}/displayName`,r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState==4)if(r.status==200){const i=JSON.parse(r.response);l(fe(i))}else l(J(r.status))},r.open("GET",o,!0),r.setRequestHeader("Authorization","Bearer ".concat(t)),r.send()})}static getUserAccounts(e){const t=`${C.env.auth_api}/accounts`;return new Promise(l=>{const o=new XMLHttpRequest;o.onreadystatechange=async()=>{if(o.readyState==4)if(o.status==200){const r=JSON.parse(o.response);l(fe(r))}else l(J(o.status))},o.open("GET",t,!0),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Authorization","Bearer ".concat(e)),o.send()})}}function N(){}function zt(n,e){for(const t in e)n[t]=e[t];return n}function Zt(n){return!!n&&(typeof n=="object"||typeof n=="function")&&typeof n.then=="function"}function At(n){return n()}function ut(){return Object.create(null)}function le(n){n.forEach(At)}function Je(n){return typeof n=="function"}function te(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let De;function Yt(n,e){return n===e?!0:(De||(De=document.createElement("a")),De.href=e,n===De.href)}function Kt(n){return Object.keys(n).length===0}function ot(n,...e){if(n==null){for(const l of e)l(void 0);return N}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function pe(n){let e;return ot(n,t=>e=t)(),e}function ue(n,e,t){n.$$.on_destroy.push(ot(e,t))}function We(n,e,t,l){if(n){const o=Dt(n,e,t,l);return n[0](o)}}function Dt(n,e,t,l){return n[1]&&l?zt(t.ctx.slice(),n[1](l(e))):t.ctx}function Ve(n,e,t,l){if(n[2]&&l){const o=n[2](l(t));if(e.dirty===void 0)return o;if(typeof o=="object"){const r=[],i=Math.max(e.dirty.length,o.length);for(let a=0;a<i;a+=1)r[a]=e.dirty[a]|o[a];return r}return e.dirty|o}return e.dirty}function ze(n,e,t,l,o,r){if(o){const i=Dt(e,t,l,r);n.p(i,o)}}function Ze(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let l=0;l<t;l++)e[l]=-1;return e}return-1}function Pe(n,e,t){return n.set(t),e}function Qt(n){return n&&Je(n.destroy)?n.destroy:N}function y(n,e){n.appendChild(e)}function w(n,e,t){n.insertBefore(e,t||null)}function k(n){n.parentNode&&n.parentNode.removeChild(n)}function we(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function b(n){return document.createElement(n)}function X(n){return document.createTextNode(n)}function P(){return X(" ")}function _e(){return X("")}function M(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function en(n){return function(e){e.target===this&&n.call(this,e)}}function m(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function tn(n){return Array.from(n.childNodes)}function ie(n,e){e=""+e,n.data!==e&&(n.data=e)}function se(n,e){n.value=e??""}function be(n,e,t){for(let l=0;l<n.options.length;l+=1){const o=n.options[l];if(o.__value===e){o.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function rt(n){const e=n.querySelector(":checked");return e&&e.__value}function z(n,e,t){n.classList.toggle(e,!!t)}function nn(n,e,{bubbles:t=!1,cancelable:l=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:l})}let Ne;function ge(n){Ne=n}function Ye(){if(!Ne)throw new Error("Function called outside component initialization");return Ne}function qt(n){Ye().$$.on_mount.push(n)}function sn(n){Ye().$$.on_destroy.push(n)}function ln(){const n=Ye();return(e,t,{cancelable:l=!1}={})=>{const o=n.$$.callbacks[e];if(o){const r=nn(e,t,{cancelable:l});return o.slice().forEach(i=>{i.call(n,r)}),!r.defaultPrevented}return!0}}const Ce=[],he=[];let Ie=[];const dt=[],on=Promise.resolve();let lt=!1;function rn(){lt||(lt=!0,on.then(it))}function He(n){Ie.push(n)}const Qe=new Set;let ve=0;function it(){if(ve!==0)return;const n=Ne;do{try{for(;ve<Ce.length;){const e=Ce[ve];ve++,ge(e),an(e.$$)}}catch(e){throw Ce.length=0,ve=0,e}for(ge(null),Ce.length=0,ve=0;he.length;)he.pop()();for(let e=0;e<Ie.length;e+=1){const t=Ie[e];Qe.has(t)||(Qe.add(t),t())}Ie.length=0}while(Ce.length);for(;dt.length;)dt.pop()();lt=!1,Qe.clear(),ge(n)}function an(n){if(n.fragment!==null){n.update(),le(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(He)}}function cn(n){const e=[],t=[];Ie.forEach(l=>n.indexOf(l)===-1?e.push(l):t.push(l)),t.forEach(l=>l()),Ie=e}const Be=new Set;let ke;function je(){ke={r:0,c:[],p:ke}}function Ae(){ke.r||le(ke.c),ke=ke.p}function A(n,e){n&&n.i&&(Be.delete(n),n.i(e))}function G(n,e,t,l){if(n&&n.o){if(Be.has(n))return;Be.add(n),ke.c.push(()=>{Be.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function Xe(n,e){const t=e.token={};function l(o,r,i,a){if(e.token!==t)return;e.resolved=a;let u=e.ctx;i!==void 0&&(u=u.slice(),u[i]=a);const c=o&&(e.current=o)(u);let d=!1;e.block&&(e.blocks?e.blocks.forEach((f,_)=>{_!==r&&f&&(je(),G(f,1,1,()=>{e.blocks[_]===f&&(e.blocks[_]=null)}),Ae())}):e.block.d(1),c.c(),A(c,1),c.m(e.mount(),e.anchor),d=!0),e.block=c,e.blocks&&(e.blocks[r]=c),d&&it()}if(Zt(n)){const o=Ye();if(n.then(r=>{ge(o),l(e.then,1,e.value,r),ge(null)},r=>{if(ge(o),l(e.catch,2,e.error,r),ge(null),!e.hasCatch)throw r}),e.current!==e.pending)return l(e.pending,0),!0}else{if(e.current!==e.then)return l(e.then,1,e.value,n),!0;e.resolved=n}}function Bt(n,e,t){const l=e.slice(),{resolved:o}=n;n.current===n.then&&(l[n.value]=o),n.current===n.catch&&(l[n.error]=o),n.block.p(l,t)}function ee(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function un(n,e){n.d(1),e.delete(n.key)}function dn(n,e,t,l,o,r,i,a,u,c,d,f){let _=n.length,g=r.length,p=_;const v={};for(;p--;)v[n[p].key]=p;const h=[],S=new Map,$=new Map,H=[];for(p=g;p--;){const E=f(o,r,p),L=t(E);let R=i.get(L);R?l&&H.push(()=>R.p(E,e)):(R=c(L,E),R.c()),S.set(L,h[p]=R),L in v&&$.set(L,Math.abs(p-v[L]))}const U=new Set,T=new Set;function x(E){A(E,1),E.m(a,d),i.set(E.key,E),d=E.first,g--}for(;_&&g;){const E=h[g-1],L=n[_-1],R=E.key,D=L.key;E===L?(d=E.first,_--,g--):S.has(D)?!i.has(R)||U.has(R)?x(E):T.has(D)?_--:$.get(R)>$.get(D)?(T.add(R),x(E)):(U.add(D),_--):(u(L,i),_--)}for(;_--;){const E=n[_];S.has(E.key)||u(E,i)}for(;g;)x(h[g-1]);return le(H),h}function Q(n){n&&n.c()}function Y(n,e,t){const{fragment:l,after_update:o}=n.$$;l&&l.m(e,t),He(()=>{const r=n.$$.on_mount.map(At).filter(Je);n.$$.on_destroy?n.$$.on_destroy.push(...r):le(r),n.$$.on_mount=[]}),o.forEach(He)}function K(n,e){const t=n.$$;t.fragment!==null&&(cn(t.after_update),le(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function fn(n,e){n.$$.dirty[0]===-1&&(Ce.push(n),rn(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function oe(n,e,t,l,o,r,i=null,a=[-1]){const u=Ne;ge(n);const c=n.$$={fragment:null,ctx:[],props:r,update:N,not_equal:o,bound:ut(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:ut(),dirty:a,skip_bound:!1,root:e.target||u.$$.root};i&&i(c.root);let d=!1;if(c.ctx=t?t(n,e.props||{},(f,_,...g)=>{const p=g.length?g[0]:_;return c.ctx&&o(c.ctx[f],c.ctx[f]=p)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](p),d&&fn(n,f)),_}):[],c.update(),d=!0,le(c.before_update),c.fragment=l?l(c.ctx):!1,e.target){if(e.hydrate){const f=tn(e.target);c.fragment&&c.fragment.l(f),f.forEach(k)}else c.fragment&&c.fragment.c();e.intro&&A(n.$$.fragment),Y(n,e.target,e.anchor),it()}ge(u)}class re{constructor(){xe(this,"$$");xe(this,"$$set")}$destroy(){K(this,1),this.$destroy=N}$on(e,t){if(!Je(t))return N;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const o=l.indexOf(t);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!Kt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const pn="4",$e=[];function Fe(n,e=N){let t;const l=new Set;function o(a){if(te(n,a)&&(n=a,t)){const u=!$e.length;for(const c of l)c[1](),$e.push(c,n);if(u){for(let c=0;c<$e.length;c+=2)$e[c][0]($e[c+1]);$e.length=0}}}function r(a){o(a(n))}function i(a,u=N){const c=[a,u];return l.add(c),l.size===1&&(t=e(o,r)||N),a(n),()=>{l.delete(c),l.size===0&&t&&(t(),t=null)}}return{set:o,update:r,subscribe:i}}var Ee=(n=>(n.info="info",n.warn="warn",n.error="error",n))(Ee||{});class _n{constructor(){xe(this,"logs",Fe([]))}_addLog(e,t){this.logs.update(l=>(l.unshift({date:new Date,severity:e,content:t}),l))}info(e){this._addLog("info",e)}warn(e){this._addLog("warn",e)}error(e){this._addLog("error",e)}updateLogAtIndex(e,t){this.logs.update(l=>(l[e]&&(l[e].content=t),l))}}const O=new _n;function gn(n,e){let t=!1;return n.subscribe(l=>{t?e(l):t=!0})}const hn={use_dark_theme:!0,rs_plugin_loader:!1,check_announcements:!0,flatpak_rich_presence:!1,runelite_use_custom_jar:!1,use_custom_rs_config_uri:!1,selected:{game:V.osrs,client:me.runelite,user_id:null},userDetails:{}};function mn(){const e=new URLSearchParams(window.location.search).get("config");function t(o){return typeof o=="object"&&typeof o.use_dark_theme=="boolean"&&typeof o.rs_plugin_loader=="boolean"&&typeof o.check_announcements=="boolean"&&typeof o.flatpak_rich_presence=="boolean"&&typeof o.runelite_use_custom_jar=="boolean"&&typeof o.selected=="object"&&Object.values(V).includes(o.selected.game)&&Object.values(me).includes(o.selected.client)&&(typeof o.selected.user_id=="string"||o.selected.user_id===null)&&typeof o.userDetails=="object"}const{config:l}=B;if(e)try{const o=JSON.parse(e);typeof o.check_announcements>"u"&&(o.check_announcements=!0,B.configHasPendingChanges=!0),t(o)?l.set(o):(O.error("The config saved on disk is not the correct format. It has been restored to default."),B.configHasPendingChanges=!0)}catch{O.error("Unable to parse config, restoring to default"),B.configHasPendingChanges=!0}else B.configHasPendingChanges=!0;gn(B.config,()=>{B.configHasPendingChanges=!0})}const B={configHasPendingChanges:!1,config:Fe(hn),sessions:Fe([])};let et=!1;class F{static async login(e,t){const l=await Ge.buildSession(e,t);if(!l.ok)return J(l.error);const{config:o,sessions:r}=B,i=l.value;return F.findSession(e.sub)||(r.update(u=>(u.push(i),u)),o.update(u=>(u.selected.user_id=i.user.userId,u))),!pe(o).selected.user_id===null&&i.user.userId,fe(i)}static async logout(e){const{sessions:t,config:l}=B;return t.update(o=>{const r=o.findIndex(i=>i.user.userId===e);return r>-1&&(ce.revokeOauthCreds(o[r].tokens.access_token),o.splice(r,1)),o}),l.update(o=>(typeof o.userDetails[e]<"u"&&delete o.userDetails[e],o.selected.user_id===e&&(o.selected.user_id=null),o)),pe(t)}static saveConfig(e=!0){if(et||e&&!B.configHasPendingChanges)return;et=!0;const t=new XMLHttpRequest;t.open("POST","/save-config",!0),t.onreadystatechange=()=>{t.readyState==4&&(O.info(`Save config status: '${t.responseText.trim()}'`),et=!1)},t.setRequestHeader("Content-Type","application/json");const l=pe(B.config);return t.send(JSON.stringify(l)),l}static async saveCredentials(){new Promise(e=>{const t=new XMLHttpRequest;t.open("POST","/save-credentials",!0),t.setRequestHeader("Content-Type","application/json"),t.onreadystatechange=()=>{t.readyState==4&&e(void 0)};const l=pe(B.sessions);t.send(JSON.stringify(l))})}static async openFilePicker(){return new Promise(e=>{const t=new XMLHttpRequest;t.onreadystatechange=()=>{if(t.readyState==4)return t.status==200?e(t.responseText):e(void 0)},t.open("GET","/jar-file-picker",!0),t.send()})}static findSession(e){return pe(B.sessions).find(l=>l.user.userId===e)}static findAccount(e,t){return e.find(l=>l.accountId==t)}}const Gt=Fe([]);typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(pn);function bn(n){let e,t;const l=n[4].default,o=We(l,n,n[3],null);return{c(){e=b("main"),o&&o.c(),m(e,"class","fixed top-0 h-screen w-screen bg-slate-100 text-xs text-slate-900 duration-200 sm:text-sm md:text-base dark:bg-slate-900 dark:text-slate-50"),z(e,"dark",n[0])},m(r,i){w(r,e,i),o&&o.m(e,null),t=!0},p(r,[i]){o&&o.p&&(!t||i&8)&&ze(o,l,r,r[3],t?Ve(l,r[3],i,null):Ze(r[3]),null),(!t||i&1)&&z(e,"dark",r[0])},i(r){t||(A(o,r),t=!0)},o(r){G(o,r),t=!1},d(r){r&&k(e),o&&o.d(r)}}}function kn(n,e,t){let l,o,{$$slots:r={},$$scope:i}=e;const{config:a}=B;return ue(n,a,u=>t(2,o=u)),n.$$set=u=>{"$$scope"in u&&t(3,i=u.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&t(0,l=o.use_dark_theme)},[l,a,o,i,r]}class Xt extends re{constructor(e){super(),oe(this,e,kn,bn,te,{})}}function wn(n){let e;return{c(){e=b("div"),e.innerHTML='<img class="h-60 w-60 animate-spin" src="svgs/circle-notch-solid.svg" alt="loading"/>',m(e,"class","flex h-full items-center justify-center")},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function yn(n){let e,t;return e=new Xt({props:{$$slots:{default:[wn]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},m(l,o){Y(e,l,o),t=!0},p(l,[o]){const r={};o&32&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){t||(A(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function vn(n){const e=window.opener;C.env==null&&o("BoltEnv is not defined. Please close and re-open Bolt to try again.");async function t(i){const a=Re.get("auth_verifier");if(!a)return o("Verifier token has expired. Please try signing in again."),null;const{clientid:u,redirect:c}=C.env,d=await ce.getOAuthToken(C.env.origin,u,a,c,i);return d.ok?d.value:(o(`Fetching OAuth token failed. ${d.error}`),null)}async function l(i){const a=Re.get("auth_nonce"),u=ce.validateIdToken(i,a??"");if(!u.ok)return o(u.error),null;const c=await ce.getSessionId(C.env.auth_api,i);return c.ok?c.value:(o(`Unable to retreive session id. ${c.error}`),null)}function o(i){r({type:"authFailed",reason:i}),window.close()}function r(i){e.postMessage(i,window.location.origin)}return qt(async()=>{const i=new URLSearchParams(window.location.search),a=i.get("code"),u=i.get("state"),c=i.get("id_token");if(c==null&&a&&u){const d=await t(a);if(!d)return o("tokens object is null.");r({type:"authTokenUpdate",tokens:d});const f=crypto.randomUUID();ce.navigateToAuthConsent(C.env.origin,d.id_token,f)}else if(c&&a&&u){const d=await l(c);if(!d)return o("sessionId is null");r({type:"authSessionUpdate",sessionId:d}),window.close()}else o("Authentication server did not response with the appropriate parameters. Please try again later.")}),sn(()=>{Re.remove("auth_verifier"),Re.remove("auth_nonce")}),[]}class $n extends re{constructor(e){super(),oe(this,e,vn,yn,te,{})}}function ft(n){let e,t,l;return{c(){e=b("button"),e.innerHTML='<img src="svgs/xmark-solid.svg" class="h-5 w-5" alt="Close"/>',m(e,"class","absolute right-3 top-3 rounded-full bg-rose-500 p-[2px] shadow-lg duration-200 hover:rotate-90 hover:opacity-75")},m(o,r){w(o,e,r),t||(l=M(e,"click",n[2]),t=!0)},p:N,d(o){o&&k(e),t=!1,l()}}}function pt(n){let e;const t=n[7].default,l=We(t,n,n[6],null);return{c(){l&&l.c()},m(o,r){l&&l.m(o,r),e=!0},p(o,r){l&&l.p&&(!e||r&64)&&ze(l,t,o,o[6],e?Ve(t,o[6],r,null):Ze(o[6]),null)},i(o){e||(A(l,o),e=!0)},o(o){G(l,o),e=!1},d(o){l&&l.d(o)}}}function Sn(n){let e,t,l,o,r,i,a=n[1]&&ft(n),u=n[4]&&pt(n);return{c(){e=b("dialog"),a&&a.c(),t=P(),u&&u.c(),m(e,"class",l=n[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"),z(e,"backdrop:cursor-pointer",n[1])},m(c,d){w(c,e,d),a&&a.m(e,null),y(e,t),u&&u.m(e,null),n[8](e),o=!0,r||(i=[M(e,"keydown",n[9]),M(e,"mousedown",en(n[10]))],r=!0)},p(c,[d]){c[1]?a?a.p(c,d):(a=ft(c),a.c(),a.m(e,t)):a&&(a.d(1),a=null),c[4]?u?(u.p(c,d),d&16&&A(u,1)):(u=pt(c),u.c(),A(u,1),u.m(e,null)):u&&(je(),G(u,1,1,()=>{u=null}),Ae()),(!o||d&1&&l!==(l=c[0]+" backdrop max-h-[90%] max-w-[90%] overflow-auto rounded-xl text-inherit focus-visible:outline-none svelte-csux1e"))&&m(e,"class",l),(!o||d&3)&&z(e,"backdrop:cursor-pointer",c[1])},i(c){o||(A(u),o=!0)},o(c){G(u),o=!1},d(c){c&&k(e),a&&a.d(),u&&u.d(),n[8](null),r=!1,le(i)}}}function Ln(n,e,t){let{$$slots:l={},$$scope:o}=e,{class:r=""}=e,{canSelfClose:i=!0}=e,a,u=!1;const c=ln();function d(){a.showModal(),t(4,u=!0)}function f(){c("close"),a.close(),t(4,u=!1)}function _(v){he[v?"unshift":"push"](()=>{a=v,t(3,a)})}const g=v=>{v.key==="Escape"&&(v.preventDefault(),i&&f())},p=()=>{i&&f()};return n.$$set=v=>{"class"in v&&t(0,r=v.class),"canSelfClose"in v&&t(1,i=v.canSelfClose),"$$scope"in v&&t(6,o=v.$$scope)},[r,i,f,a,u,d,o,l,_,g,p]}class at extends re{constructor(e){super(),oe(this,e,Ln,Sn,te,{class:0,canSelfClose:1,open:5,close:2})}get open(){return this.$$.ctx[5]}get close(){return this.$$.ctx[2]}}function Cn(n){let e,t,l,o,r,i,a;return{c(){e=b("p"),e.textContent=`${atob("Qm9sdCBpcyBhbiB1bm9mZmljaWFsIHRoaXJkLXBhcnR5IGxhdW5jaGVyLiBJdCdzIGZyZWUgYW5kIG9wZW4tc291cmNlIHNvZnR3YXJlIGxpY2Vuc2VkIHVuZGVyIEFHUEwgMy4wLg==")}`,t=P(),l=b("p"),l.textContent=`${atob("SmFnZXggaXMgbm90IHJlc3BvbnNpYmxlIGZvciBhbnkgcHJvYmxlbXMgb3IgZGFtYWdlIGNhdXNlZCBieSB1c2luZyB0aGlzIHByb2R1Y3Qu")}`,o=P(),r=b("button"),r.textContent="I Understand",m(e,"class","p-2"),m(l,"class","p-2"),m(r,"class","m-5 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75")},m(u,c){w(u,e,c),w(u,t,c),w(u,l,c),w(u,o,c),w(u,r,c),i||(a=M(r,"click",n[2]),i=!0)},p:N,d(u){u&&(k(e),k(t),k(l),k(o),k(r)),i=!1,a()}}}function Rn(n){let e,t,l={canSelfClose:!1,class:"w-1/2 text-center",$$slots:{default:[Cn]},$$scope:{ctx:n}};return e=new at({props:l}),n[3](e),{c(){Q(e.$$.fragment)},m(o,r){Y(e,o,r),t=!0},p(o,[r]){const i={};r&33&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(A(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){n[3](null),K(e,o)}}}function Tn(n,e,t){let l;const{sessions:o}=B;ue(n,o,u=>t(4,l=u));let r;qt(()=>{l.length==0&&r.open()});const i=()=>r.close();function a(u){he[u?"unshift":"push"](()=>{r=u,t(0,r)})}return[r,o,i,a]}class Pn extends re{constructor(e){super(),oe(this,e,Tn,Rn,te,{})}}function In(n,e,t){F.saveConfig();const l=(a,u)=>{const c=new XMLHttpRequest,d={},f=pe(B.config);a&&(d.hash=a),n&&(d.jx_session_id=n),e&&(d.jx_character_id=e),t&&(d.jx_display_name=t),f.rs_plugin_loader&&(d.plugin_loader="1"),f.use_custom_rs_config_uri&&f.rs_config_uri?d.config_uri=f.rs_config_uri:d.config_uri=C.env.default_config_uri,c.open("POST","/launch-rs3-deb?".concat(new URLSearchParams(d).toString()),!0),c.onreadystatechange=()=>{c.readyState==4&&(O.info(`Game launch status: '${c.responseText.trim()}'`),c.status==200&&a&&(C.rs3DebInstalledHash=a))},c.send(u)},o=new XMLHttpRequest,r=C.env.content_url,i=r.concat("dists/trusty/non-free/binary-amd64/Packages");o.open("GET",i,!0),o.onreadystatechange=()=>{if(o.readyState==4&&o.status==200){const a=Object.fromEntries(o.response.split(`
`).map(u=>u.split(": ")));if(!a.Filename||!a.Size){O.error(`Could not parse package data from URL: ${i}`),l();return}if(a.SHA256!==C.rs3DebInstalledHash){O.info("Downloading RS3 client...");const u=new XMLHttpRequest;u.open("GET",r.concat(a.Filename),!0),u.responseType="arraybuffer",u.onprogress=c=>{if(c.loaded){const d=(Math.round(1e3*c.loaded/c.total)/10).toFixed(1);O.updateLogAtIndex(0,`Downloading RS3 client... ${d}%`)}},u.onreadystatechange=()=>{u.readyState==4&&u.status==200&&l(a.SHA256,u.response)},u.onerror=()=>{O.error(`Error downloading game client: from ${i}: non-http error`),l()},u.send()}else O.info("Latest client is already installed"),l()}},o.onerror=()=>{O.error(`Error: from ${i}: non-http error`),l()},o.send()}function Ft(n,e,t,l){F.saveConfig();const o=l?"/launch-runelite-jar-configure?":"/launch-runelite-jar?",r=(u,c,d)=>{const f=new XMLHttpRequest,_={};u&&(_.id=u),d&&(_.jar_path=d),n&&(_.jx_session_id=n),e&&(_.jx_character_id=e),t&&(_.jx_display_name=t),pe(B.config).flatpak_rich_presence&&(_.flatpak_rich_presence=""),f.open(c?"POST":"GET",o.concat(new URLSearchParams(_).toString()),!0),f.onreadystatechange=()=>{f.readyState==4&&(O.info(`Game launch status: '${f.responseText.trim()}'`),f.status==200&&u&&(C.runeLiteInstalledId=u))},f.send(c)};if(pe(B.config).runelite_use_custom_jar){r(null,null,pe(B.config).runelite_custom_jar);return}const i=new XMLHttpRequest,a="https://api.github.com/repos/runelite/launcher/releases";i.open("GET",a,!0),i.onreadystatechange=()=>{if(i.readyState==4)if(i.status==200){const u=JSON.parse(i.responseText).map(c=>c.assets).flat().find(c=>c.name.toLowerCase()=="runelite.jar");if(u.id!=C.runeLiteInstalledId){O.info("Downloading RuneLite...");const c=new XMLHttpRequest;c.open("GET",u.browser_download_url,!0),c.responseType="arraybuffer",c.onreadystatechange=()=>{c.readyState==4&&(c.status==200?r(u.id,c.response):O.error(`Error downloading from ${u.url}: ${c.status}: ${c.responseText}`))},c.onprogress=d=>{if(d.loaded&&d.lengthComputable){const f=(Math.round(1e3*d.loaded/d.total)/10).toFixed(1);O.updateLogAtIndex(0,`Downloading RuneLite... ${f}%`)}},c.send()}else O.info("Latest JAR is already installed"),r()}else O.error(`Error from ${a}: ${i.status}: ${i.responseText}`)},i.send()}function Hn(n,e,t){F.saveConfig();const l=(i,a)=>{const u=new XMLHttpRequest,c={};i&&(c.version=i),n&&(c.jx_session_id=n),e&&(c.jx_character_id=e),t&&(c.jx_display_name=t),u.open("POST","/launch-hdos-jar?".concat(new URLSearchParams(c).toString()),!0),u.onreadystatechange=()=>{u.readyState==4&&(O.info(`Game launch status: '${u.responseText.trim()}'`),u.status==200&&i&&(C.hdosInstalledVersion=i))},u.send(a)},o=new XMLHttpRequest,r="https://cdn.hdos.dev/client/getdown.txt";o.open("GET",r,!0),o.onreadystatechange=()=>{if(o.readyState==4)if(o.status==200){const i=o.responseText.match(/^launcher\.version *= *(.*?)$/m);if(i&&i.length>=2){const a=i[1];if(a!==C.hdosInstalledVersion){const u=`https://cdn.hdos.dev/launcher/v${a}/hdos-launcher.jar`;O.info("Downloading HDOS...");const c=new XMLHttpRequest;c.open("GET",u,!0),c.responseType="arraybuffer",c.onreadystatechange=()=>{if(c.readyState==4)if(c.status==200)l(a,c.response);else{const d=JSON.parse(o.responseText).map(f=>f.assets).flat().find(f=>f.name.toLowerCase()=="runelite.jar");O.error(`Error downloading from ${d.url}: ${c.status}: ${c.responseText}`)}},c.onprogress=d=>{if(d.loaded&&d.lengthComputable){const f=(Math.round(1e3*d.loaded/d.total)/10).toFixed(1);O.updateLogAtIndex(0,`Downloading HDOS... ${f}%`)}},c.send()}else O.info("Latest JAR is already installed"),l()}else O.info("Couldn't parse latest launcher version"),l()}else O.error(`Error from ${r}: ${o.status}: ${o.responseText}`)},o.send()}function tt(){const n=new XMLHttpRequest;n.open("GET","/list-game-clients",!0),n.onreadystatechange=()=>{n.readyState==4&&n.status!=200&&O.error(`Error requesting client list: ${n.status}: ${n.responseText}`)},n.send()}function On(){const n=new XMLHttpRequest;n.open("POST","/save-plugin-config",!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=()=>{n.readyState==4&&O.info(`Save-plugin-config status: ${n.responseText.trim()}`)},n.send(JSON.stringify(C.pluginList))}async function _t(n,e,t,l,o){F.saveConfig();const r=`${e?"osrs":C.env.provider}-${n?"win":"mac"}`;let i=n?e?C.osrsExeInstalledHash:C.rs3ExeInstalledHash:e?C.osrsAppInstalledHash:C.rs3AppInstalledHash;const a=async(E,L)=>{const R={};if(E&&(R.hash=E),t&&(R.jx_session_id=t),l&&(R.jx_character_id=l),o&&(R.jx_display_name=o),!e){const q=pe(B.config);q.rs_plugin_loader&&(R.plugin_loader="1"),R.config_uri=q.use_custom_rs_config_uri&&q.rs_config_uri?q.rs_config_uri:C.env.default_config_uri}const D=await fetch(`/launch-${e?"osrs":"rs3"}-${n?"exe":"app"}?${new URLSearchParams(R).toString()}`,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:await L});D.text().then(q=>O.info(`Game launch status: '${q.trim()}'`)),D.status==200&&E&&(i=E)},u=`${C.env.direct6_url}${r}/${r}.json`,c=await fetch(u,{method:"GET"}),d=await c.text();if(c.status!==200){O.error(`Error from ${u}: ${c.status}: ${d}`);return}const f=JSON.parse(atob(d.split(".")[1])).environments.production;if(i===f.id){O.info("Latest client is already installed"),a();return}O.info(`Downloading client version ${f.version}`);const _=`${C.env.direct6_url}${r}/catalog/${f.id}/catalog.json`,g=await fetch(_,{method:"GET"}),p=await g.text();if(g.status!==200){O.error(`Error from ${_}: ${g.status}: ${p}`);return}const v=JSON.parse(atob(p.split(".")[1])),h=v.metafile.replace(/^http:/i,"https:"),S=await fetch(h,{method:"GET"}),$=await S.text();if(S.status!==200){O.error(`Error from ${h}: ${S.status}: ${$}`);return}const H=JSON.parse(atob($.split(".")[1])),U=H.pieces.digests.map(E=>{const L=atob(E).split("").map(D=>D.charCodeAt(0).toString(16).padStart(2,"0")).join(""),R=v.config.remote.baseUrl.replace(/^http:/i,"https:").concat(v.config.remote.pieceFormat.replace("{SubString:0,2,{TargetDigest}}",L.substring(0,2)).replace("{TargetDigest}",L));return fetch(R,{method:"GET"}).then(D=>D.blob().then(q=>{const W=new DecompressionStream("gzip");return new Response(q.slice(6).stream().pipeThrough(W)).blob()}))});let T=0,x=null;for(let E=0;E<H.files.length;E+=1)if(n?H.files[E].name.endsWith(".exe"):H.files[E].name.includes(".app/Contents/MacOS/"))if(x!==null){O.error(`Error parsing ${h}: file list has multiple possibilities for main exe`);return}else x=H.files[E].size;else x===null&&(T+=H.files[E].size);if(x===null){O.error(`Error parsing ${h}: file list has no possibilities for main exe`);return}Promise.all(U).then(E=>{const L=new Blob(E).slice(T,T+x);a(H.id,L.arrayBuffer())})}function gt(n,e,t){const l=n.slice();return l[30]=e[t],l}function ht(n,e,t){const l=n.slice();return l[33]=e[t],l}function mt(n,e,t){const l=n.slice();return l[36]=e[t][0],l[29]=e[t][1],l}function bt(n,e,t){const l=n.slice();return l[30]=e[t],l}function xn(n){let e,t=ee(n[3]),l=[];for(let o=0;o<t.length;o+=1)l[o]=kt(bt(n,t,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=_e()},m(o,r){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(o,r);w(o,e,r)},p(o,r){if(r[0]&76){t=ee(o[3]);let i;for(i=0;i<t.length;i+=1){const a=bt(o,t,i);l[i]?l[i].p(a,r):(l[i]=kt(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},d(o){o&&k(e),we(l,o)}}}function En(n){let e;return{c(){e=b("p"),e.textContent="(start an RS3 game client with plugins enabled and it will be listed here.)"},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function kt(n){let e,t=(n[30].identity||Lt)+"",l,o,r,i,a,u;function c(){return n[17](n[30])}return{c(){e=b("button"),l=X(t),r=P(),i=b("br"),m(e,"class",o="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(n[6]&&n[2]===n[30].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")},m(d,f){w(d,e,f),y(e,l),w(d,r,f),w(d,i,f),a||(u=M(e,"click",c),a=!0)},p(d,f){n=d,f[0]&8&&t!==(t=(n[30].identity||Lt)+"")&&ie(l,t),f[0]&76&&o!==(o="m-1 h-[28px] w-[95%] rounded-lg border-2 "+(n[6]&&n[2]===n[30].uid?"border-black bg-blue-500 text-black":"border-blue-500 text-black dark:text-white")+" hover:opacity-75")&&m(e,"class",o)},d(d){d&&(k(e),k(r),k(i)),a=!1,u()}}}function Un(n){let e;return{c(){e=b("p"),e.textContent="error"},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function Nn(n){let e,t,l,o,r,i=ee(Object.entries(n[0].pluginList)),a=[];for(let f=0;f<i.length;f+=1)a[f]=wt(mt(n,i,f));function u(f,_){return f[6]?Mn:jn}let c=u(n),d=c(n);return{c(){e=b("select");for(let f=0;f<a.length;f+=1)a[f].c();t=P(),d.c(),l=_e(),m(e,"class","mx-auto mb-4 w-[min(280px,_45%)] cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),n[1]===void 0&&He(()=>n[18].call(e))},m(f,_){w(f,e,_);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(e,null);be(e,n[1],!0),w(f,t,_),d.m(f,_),w(f,l,_),o||(r=M(e,"change",n[18]),o=!0)},p(f,_){if(_[0]&1){i=ee(Object.entries(f[0].pluginList));let g;for(g=0;g<i.length;g+=1){const p=mt(f,i,g);a[g]?a[g].p(p,_):(a[g]=wt(p),a[g].c(),a[g].m(e,null))}for(;g<a.length;g+=1)a[g].d(1);a.length=i.length}_[0]&3&&be(e,f[1]),c===(c=u(f))&&d?d.p(f,_):(d.d(1),d=c(f),d&&(d.c(),d.m(l.parentNode,l)))},d(f){f&&(k(e),k(t),k(l)),we(a,f),d.d(f),o=!1,r()}}}function wt(n){let e,t=(n[29].name??Me)+"",l,o;return{c(){e=b("option"),l=X(t),m(e,"class","dark:bg-slate-900"),e.__value=o=n[36],se(e,e.__value)},m(r,i){w(r,e,i),y(e,l)},p(r,i){i[0]&1&&t!==(t=(r[29].name??Me)+"")&&ie(l,t),i[0]&1&&o!==(o=r[36])&&(e.__value=o,se(e,e.__value))},d(r){r&&k(e)}}}function Mn(n){let e,t,l,o,r={ctx:n,current:null,token:null,hasCatch:!0,pending:Vn,then:Dn,catch:An,value:29};return Xe(o=n[8],r),{c(){e=b("br"),t=P(),l=_e(),r.block.c()},m(i,a){w(i,e,a),w(i,t,a),w(i,l,a),r.block.m(i,r.anchor=a),r.mount=()=>l.parentNode,r.anchor=l},p(i,a){n=i,r.ctx=n,a[0]&256&&o!==(o=n[8])&&Xe(o,r)||Bt(r,n,a)},d(i){i&&(k(e),k(t),k(l)),r.block.d(i),r.token=null,r=null}}}function jn(n){let e,t,l,o,r,i,a,u,c;function d(g,p){return p[0]&1&&(i=null),i==null&&(i=Object.entries(g[0].pluginList).length!==0),i?Zn:zn}let f=d(n,[-1,-1]),_=f(n);return{c(){e=b("button"),t=X("+"),l=P(),o=b("br"),r=P(),_.c(),a=_e(),m(e,"class","aspect-square w-8 rounded-lg border-2 border-blue-500 text-[20px] font-bold duration-200 enabled:hover:opacity-75 disabled:border-gray-500"),e.disabled=n[5]},m(g,p){w(g,e,p),y(e,t),w(g,l,p),w(g,o,p),w(g,r,p),_.m(g,p),w(g,a,p),u||(c=M(e,"click",n[11]),u=!0)},p(g,p){p[0]&32&&(e.disabled=g[5]),f===(f=d(g,p))&&_?_.p(g,p):(_.d(1),_=f(g),_&&(_.c(),_.m(a.parentNode,a)))},d(g){g&&(k(e),k(l),k(o),k(r),k(a)),_.d(g),u=!1,c()}}}function An(n){let e;return{c(){e=b("p"),e.textContent="error"},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function Dn(n){let e,t,l,o,r,i,a,u,c,d;function f(h,S){return S[0]&259&&(e=null),S[0]&1&&(t=null),e==null&&(e=!!(h[29]&&h[29].main&&Object.keys(h[0].pluginList).includes(h[1]))),e?Gn:(t==null&&(t=Object.entries(h[0].pluginList).length===0),t?Bn:qn)}let _=f(n,[-1,-1]),g=_(n),p=ee(n[3]),v=[];for(let h=0;h<p.length;h+=1)v[h]=$t(gt(n,p,h));return{c(){g.c(),l=P(),o=b("br"),r=P(),i=b("br"),a=P(),u=b("hr"),c=P();for(let h=0;h<v.length;h+=1)v[h].c();d=_e(),m(u,"class","p-1 dark:border-slate-700")},m(h,S){g.m(h,S),w(h,l,S),w(h,o,S),w(h,r,S),w(h,i,S),w(h,a,S),w(h,u,S),w(h,c,S);for(let $=0;$<v.length;$+=1)v[$]&&v[$].m(h,S);w(h,d,S)},p(h,S){if(_===(_=f(h,S))&&g?g.p(h,S):(g.d(1),g=_(h),g&&(g.c(),g.m(l.parentNode,l))),S[0]&8205){p=ee(h[3]);let $;for($=0;$<p.length;$+=1){const H=gt(h,p,$);v[$]?v[$].p(H,S):(v[$]=$t(H),v[$].c(),v[$].m(d.parentNode,d))}for(;$<v.length;$+=1)v[$].d(1);v.length=p.length}},d(h){h&&(k(l),k(o),k(r),k(i),k(a),k(u),k(c),k(d)),g.d(h),we(v,h)}}}function qn(n){let e;return{c(){e=b("p"),e.textContent="can't start plugin: does not appear to be configured"},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function Bn(n){let e;return{c(){e=b("p"),e.textContent="(no plugins installed)"},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function Gn(n){let e;function t(r,i){return r[9]?Fn:Xn}let l=t(n),o=l(n);return{c(){o.c(),e=_e()},m(r,i){o.m(r,i),w(r,e,i)},p(r,i){l===(l=t(r))&&o?o.p(r,i):(o.d(1),o=l(r),o&&(o.c(),o.m(e.parentNode,e)))},d(r){r&&k(e),o.d(r)}}}function Xn(n){let e;return{c(){e=b("p"),e.textContent="can't start plugin: no path is configured"},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function Fn(n){let e,t,l=n[29].name+"",o,r,i;function a(){return n[21](n[29])}return{c(){e=b("button"),t=X("Start "),o=X(l),m(e,"class","mx-auto mb-1 w-auto rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75")},m(u,c){w(u,e,c),y(e,t),y(e,o),r||(i=M(e,"click",a),r=!0)},p(u,c){n=u,c[0]&256&&l!==(l=n[29].name+"")&&ie(o,l)},d(u){u&&k(e),r=!1,i()}}}function yt(n){let e,t=ee(n[30].plugins),l=[];for(let o=0;o<t.length;o+=1)l[o]=vt(ht(n,t,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=_e()},m(o,r){for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(o,r);w(o,e,r)},p(o,r){if(r[0]&8205){t=ee(o[30].plugins);let i;for(i=0;i<t.length;i+=1){const a=ht(o,t,i);l[i]?l[i].p(a,r):(l[i]=vt(a),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},d(o){o&&k(e),we(l,o)}}}function Jn(n){let e,t=n[33].id+"",l;return{c(){e=b("p"),l=X(t)},m(o,r){w(o,e,r),y(e,l)},p(o,r){r[0]&8&&t!==(t=o[33].id+"")&&ie(l,t)},d(o){o&&k(e)}}}function Wn(n){let e,t=(n[0].pluginList[n[33].id].name??n[33].id)+"",l,o,r,i,a,u;function c(){return n[22](n[33])}return{c(){e=b("p"),l=X(t),o=P(),r=b("button"),r.innerHTML='<img src="svgs/xmark-solid.svg" class="h-4 w-4" alt="Close"/>',i=P(),m(r,"class","rounded-sm bg-rose-500 shadow-lg hover:opacity-75")},m(d,f){w(d,e,f),y(e,l),y(e,o),y(e,r),y(e,i),a||(u=M(r,"click",c),a=!0)},p(d,f){n=d,f[0]&9&&t!==(t=(n[0].pluginList[n[33].id].name??n[33].id)+"")&&ie(l,t)},d(d){d&&k(e),a=!1,u()}}}function vt(n){let e,t;function l(i,a){return a[0]&9&&(e=null),e==null&&(e=!!Object.keys(i[0].pluginList).includes(i[33].id)),e?Wn:Jn}let o=l(n,[-1,-1]),r=o(n);return{c(){r.c(),t=_e()},m(i,a){r.m(i,a),w(i,t,a)},p(i,a){o===(o=l(i,a))&&r?r.p(i,a):(r.d(1),r=o(i),r&&(r.c(),r.m(t.parentNode,t)))},d(i){i&&k(t),r.d(i)}}}function $t(n){let e,t=n[30].uid===n[2]&&yt(n);return{c(){t&&t.c(),e=_e()},m(l,o){t&&t.m(l,o),w(l,e,o)},p(l,o){l[30].uid===l[2]?t?t.p(l,o):(t=yt(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&k(e),t&&t.d(l)}}}function Vn(n){let e;return{c(){e=b("p"),e.textContent="loading..."},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function zn(n){let e;return{c(){e=b("p"),e.textContent=`You have no plugins installed. Click the + button and select a plugin's bolt.json file
						to add it.`},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function Zn(n){let e=Object.keys(n[0].pluginList).includes(n[1])&&n[8]!==null,t,l=e&&St(n);return{c(){l&&l.c(),t=_e()},m(o,r){l&&l.m(o,r),w(o,t,r)},p(o,r){r[0]&259&&(e=Object.keys(o[0].pluginList).includes(o[1])&&o[8]!==null),e?l?l.p(o,r):(l=St(o),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(o){o&&k(t),l&&l.d(o)}}}function St(n){let e,t,l,o,r,i,a,u={ctx:n,current:null,token:null,hasCatch:!0,pending:Qn,then:Kn,catch:Yn,value:29};return Xe(e=n[8],u),{c(){u.block.c(),t=P(),l=b("button"),l.textContent="Remove",o=P(),r=b("button"),r.textContent="Reload",m(l,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-rose-500 enabled:hover:opacity-75 disabled:bg-gray-500"),m(r,"class","mx-auto mb-1 w-[min(144px,_25%)] rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(c,d){u.block.m(c,u.anchor=d),u.mount=()=>t.parentNode,u.anchor=t,w(c,t,d),w(c,l,d),w(c,o,d),w(c,r,d),i||(a=[M(l,"click",n[19]),M(r,"click",n[20])],i=!0)},p(c,d){n=c,u.ctx=n,d[0]&256&&e!==(e=n[8])&&Xe(e,u)||Bt(u,n,d)},d(c){c&&(k(t),k(l),k(o),k(r)),u.block.d(c),u.token=null,u=null,i=!1,le(a)}}}function Yn(n){let e,t,l;return{c(){e=b("p"),e.textContent="error",t=P(),l=b("br")},m(o,r){w(o,e,r),w(o,t,r),w(o,l,r)},p:N,d(o){o&&(k(e),k(t),k(l))}}}function Kn(n){let e,t=(n[29].name??Me)+"",l,o,r,i=(n[29].description??"no description")+"",a,u,c,d;return{c(){e=b("p"),l=X(t),o=P(),r=b("p"),a=X(i),c=P(),d=b("br"),m(e,"class","pb-4 text-xl font-bold"),m(r,"class",u=n[29].description?null:"italic")},m(f,_){w(f,e,_),y(e,l),w(f,o,_),w(f,r,_),y(r,a),w(f,c,_),w(f,d,_)},p(f,_){_[0]&256&&t!==(t=(f[29].name??Me)+"")&&ie(l,t),_[0]&256&&i!==(i=(f[29].description??"no description")+"")&&ie(a,i),_[0]&256&&u!==(u=f[29].description?null:"italic")&&m(r,"class",u)},d(f){f&&(k(e),k(o),k(r),k(c),k(d))}}}function Qn(n){let e;return{c(){e=b("p"),e.textContent="loading..."},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function es(n){let e,t,l,o,r,i,a,u,c,d,f;function _($,H){return $[3].length==0?En:xn}let g=_(n),p=g(n);function v($,H){return $[0].hasBoltPlugins?Nn:Un}let h=v(n),S=h(n);return{c(){e=b("div"),t=b("button"),l=X("Manage Plugins"),r=P(),i=b("hr"),a=P(),p.c(),u=P(),c=b("div"),S.c(),m(t,"class",o="mx-auto mb-2 w-[95%] rounded-lg border-2 "+(n[6]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75"),m(i,"class","p-1 dark:border-slate-700"),m(e,"class","left-0 float-left h-full w-[min(180px,_50%)] overflow-hidden border-r-2 border-slate-300 pt-2 dark:border-slate-800"),m(c,"class","h-full pt-10")},m($,H){w($,e,H),y(e,t),y(t,l),y(e,r),y(e,i),y(e,a),p.m(e,null),w($,u,H),w($,c,H),S.m(c,null),d||(f=M(t,"click",n[16]),d=!0)},p($,H){H[0]&64&&o!==(o="mx-auto mb-2 w-[95%] rounded-lg border-2 "+($[6]?"border-blue-500 text-black dark:text-white":"border-black bg-blue-500 text-black")+" p-2 font-bold hover:opacity-75")&&m(t,"class",o),g===(g=_($))&&p?p.p($,H):(p.d(1),p=g($),p&&(p.c(),p.m(e,null))),h===(h=v($))&&S?S.p($,H):(S.d(1),S=h($),S&&(S.c(),S.m(c,null)))},d($){$&&(k(e),k(u),k(c)),p.d(),S.d(),d=!1,f()}}}function ts(n){let e,t,l={class:"h-[90%] w-[90%] text-center",$$slots:{default:[es]},$$scope:{ctx:n}};return e=new at({props:l}),n[23](e),e.$on("close",n[24]),{c(){Q(e.$$.fragment)},m(o,r){Y(e,o,r),t=!0},p(o,r){const i={};r[0]&1007|r[1]&1024&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(A(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){n[23](null),K(e,o)}}}const nt="bolt.json",ns="main.lua",Me="(unnamed)",Lt="(new character)";function ss(n,e,t){let l,o,r,i;ue(n,Gt,I=>t(3,i=I));let a;const u=C.platform==="windows"?"\\":"/",c=u.concat(nt);function d(){a.open()}const f=I=>new Promise((ae,Z)=>{const ye=I.concat(I.endsWith(u)?nt:c);var de=new XMLHttpRequest;de.onreadystatechange=()=>{de.readyState==4&&(de.status==200?ae(JSON.parse(de.responseText)):Z(de.responseText))},de.open("GET","/read-json-file?".concat(new URLSearchParams({path:ye}).toString()),!0),de.send()}),_=I=>{const Z=C.pluginList[I];if(!Z)return null;const ye=Z.path;return ye?f(ye):null},g=(I,ae)=>{f(I).then(Z=>{do t(1,$=crypto.randomUUID());while(Object.keys(C.pluginList).includes($));t(0,C.pluginList[$]={name:Z.name??Me,path:I},C),t(7,T=!0)}).catch(Z=>{console.error(`Config file '${ae}' couldn't be fetched, reason: ${Z}`)})};let p=!1;const v=()=>{t(5,p=!0);var I=new XMLHttpRequest;I.onreadystatechange=()=>{if(I.readyState==4&&(t(5,p=!1),I.status==200))if(I.responseText.endsWith(c)){const ae=I.responseText.substring(0,I.responseText.length-nt.length);g(ae,I.responseText)}else console.log(`Selection '${I.responseText}' is not named bolt.json; ignored`)},I.open("GET","/json-file-picker",!0),I.send()};tt();const h=(I,ae,Z,ye)=>{const de=C.platform==="windows"?Z.replaceAll("\\","/"):Z,Jt=de.endsWith(u)?de:de.concat("/");var Oe=new XMLHttpRequest;Oe.onreadystatechange=()=>{Oe.readyState==4&&(tt(),O.info(`Start-plugin status: ${Oe.statusText.trim()}`))},Oe.open("GET","/start-plugin?".concat(new URLSearchParams({client:I.toString(),id:ae,path:Jt,main:ye}).toString()),!0),Oe.send()},S=(I,ae)=>{var Z=new XMLHttpRequest;Z.onreadystatechange=()=>{Z.readyState==4&&(tt(),O.info(`Stop-plugin status: ${Z.statusText.trim()}`))},Z.open("GET","/stop-plugin?".concat(new URLSearchParams({client:I.toString(),uid:ae.toString()}).toString()),!0),Z.send()};var $,H=!1,U;let T=!1;const x=()=>t(6,H=!1),E=I=>{t(2,U=I.uid),t(6,H=!0)};function L(){$=rt(this),t(1,$),t(0,C)}const R=()=>{t(8,r=null),t(7,T=!0);let I=C.pluginList;delete I[$],t(0,C.pluginList=I,C)},D=()=>t(8,r=_($)),q=I=>h(U,$,o,I.main??ns),W=I=>{S(U,I.uid)};function j(I){he[I?"unshift":"push"](()=>{a=I,t(4,a)})}const ne=()=>{T&&On()};return n.$$.update=()=>{n.$$.dirty[0]&12&&(i.some(I=>I.uid===U)||t(6,H=!1)),n.$$.dirty[0]&3&&t(15,l=C.pluginList[$]),n.$$.dirty[0]&32768&&t(9,o=l?l.path:null),n.$$.dirty[0]&2&&t(8,r=_($))},[C,$,U,i,a,p,H,T,r,o,_,v,h,S,d,l,x,E,L,R,D,q,W,j,ne]}class ls extends re{constructor(e){super(),oe(this,e,ss,ts,te,{open:14},null,[-1,-1])}get open(){return this.$$.ctx[14]}}function Ct(n,e,t){const l=n.slice();return l[15]=e[t],l}function Rt(n,e,t){const l=n.slice();return l[18]=e[t],l}function os(n){let e,t,l={};return e=new ls({props:l}),n[10](e),{c(){Q(e.$$.fragment)},m(o,r){Y(e,o,r),t=!0},p(o,r){const i={};e.$set(i)},i(o){t||(A(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){n[10](null),K(e,o)}}}function Tt(n){let e,t;return{c(){e=b("div"),t=X(n[5]),m(e,"class","absolute left-[2%] w-[96%] rounded-lg rounded-lg bg-blue-400 px-2 text-black")},m(l,o){w(l,e,o),y(e,t)},p(l,o){o&32&&ie(t,l[5])},d(l){l&&k(e)}}}function rs(n){let e,t,l;return{c(){e=b("button"),e.textContent="Plugin menu",e.disabled=!C.hasBoltPlugins,m(e,"title",C.hasBoltPlugins?null:"Coming soon..."),m(e,"class","w-52 rounded-lg p-2 font-bold text-black duration-200 enabled:bg-blue-500 enabled:hover:opacity-75 disabled:bg-gray-500")},m(o,r){w(o,e,r),t||(l=M(e,"click",n[13]),t=!0)},p:N,d(o){o&&k(e),t=!1,l()}}}function is(n){let e,t,l,o,r,i,a=ee(ct[n[0].selected.game]),u=[];for(let c=0;c<a.length;c+=1)u[c]=Pt(Rt(n,a,c));return{c(){e=b("label"),t=b("span"),t.textContent="Game Client",l=P(),o=b("select");for(let c=0;c<u.length;c+=1)u[c].c();m(t,"class","text-sm"),m(o,"id","game_client_select"),m(o,"class","w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),n[0].selected.client===void 0&&He(()=>n[12].call(o)),m(e,"class","flex flex-col")},m(c,d){w(c,e,d),y(e,t),y(e,l),y(e,o);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(o,null);be(o,n[0].selected.client,!0),r||(i=M(o,"change",n[12]),r=!0)},p(c,d){if(d&1){a=ee(ct[c[0].selected.game]);let f;for(f=0;f<a.length;f+=1){const _=Rt(c,a,f);u[f]?u[f].p(_,d):(u[f]=Pt(_),u[f].c(),u[f].m(o,null))}for(;f<u.length;f+=1)u[f].d(1);u.length=a.length}d&1&&be(o,c[0].selected.client)},d(c){c&&k(e),we(u,c),r=!1,i()}}}function Pt(n){let e,t=n[18]+"",l,o,r;return{c(){e=b("option"),l=X(t),m(e,"class","dark:bg-slate-900"),e.disabled=o=n[18]===me.official&&C.platform==Ue.Linux,e.__value=r=n[18],se(e,e.__value)},m(i,a){w(i,e,a),y(e,l)},p(i,a){a&1&&t!==(t=i[18]+"")&&ie(l,t),a&1&&o!==(o=i[18]===me.official&&C.platform==Ue.Linux)&&(e.disabled=o),a&1&&r!==(r=i[18])&&(e.__value=r,se(e,e.__value))},d(i){i&&k(e)}}}function It(n){let e;return{c(){e=b("option"),e.textContent="No characters",m(e,"class","dark:bg-slate-900"),e.disabled=!0,e.selected=!0,e.__value="No characters",se(e,e.__value)},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function as(n){let e;return{c(){e=X("New Character")},m(t,l){w(t,e,l)},p:N,d(t){t&&k(e)}}}function cs(n){let e=n[15].displayName+"",t;return{c(){t=X(e)},m(l,o){w(l,t,o)},p(l,o){o&16&&e!==(e=l[15].displayName+"")&&ie(t,e)},d(l){l&&k(t)}}}function Ht(n){let e,t,l;function o(a,u){return a[15].displayName?cs:as}let r=o(n),i=r(n);return{c(){e=b("option"),i.c(),t=P(),e.__value=l=n[15].accountId,se(e,e.__value),m(e,"class","dark:bg-slate-900")},m(a,u){w(a,e,u),i.m(e,null),y(e,t)},p(a,u){r===(r=o(a))&&i?i.p(a,u):(i.d(1),i=r(a),i&&(i.c(),i.m(e,t))),u&16&&l!==(l=a[15].accountId)&&(e.__value=l,se(e,e.__value))},d(a){a&&k(e),i.d()}}}function us(n){let e,t,l,o,r,i,a,u,c,d,f,_,g,p,v,h,S,$,H,U,T=C.hasBoltPlugins&&os(n),x=n[5]&&Tt(n);function E(j,ne){if(j[0].selected.game==V.osrs)return is;if(j[0].selected.game===V.rs3)return rs}let L=E(n),R=L&&L(n),D=ee(n[4]),q=[];for(let j=0;j<D.length;j+=1)q[j]=Ht(Ct(n,D,j));let W=null;return D.length||(W=It()),{c(){T&&T.c(),e=P(),t=b("div"),x&&x.c(),l=P(),o=b("div"),r=b("img"),a=P(),u=b("button"),u.textContent="Play",c=P(),R&&R.c(),d=P(),f=b("label"),_=b("span"),_.textContent="Character",g=P(),p=b("select"),v=b("option"),h=X("Select an account");for(let j=0;j<q.length;j+=1)q[j].c();W&&W.c(),Yt(r.src,i="svgs/rocket-solid.svg")||m(r,"src",i),m(r,"alt","Launch icon"),m(r,"class","mb-3 w-24 rounded-3xl bg-gradient-to-br from-rose-500 to-violet-500 p-5"),m(u,"class","w-52 rounded-lg bg-emerald-500 p-2 font-bold text-black duration-200 hover:opacity-75"),m(_,"class","text-sm"),v.__value=void 0,se(v,v.__value),v.disabled=!0,m(v,"class","dark:bg-slate-900"),m(p,"id","character_select"),m(p,"class","mx-auto w-52 cursor-pointer rounded-lg border-2 border-slate-300 bg-inherit p-2 text-inherit duration-200 hover:opacity-75 dark:border-slate-800"),p.disabled=S=n[0].selected.user_id===null,m(f,"class","flex flex-col"),m(o,"class","flex flex-col items-center gap-4"),m(t,"class","bg-grad flex h-full flex-col border-slate-300 p-5 duration-200 dark:border-slate-800")},m(j,ne){T&&T.m(j,ne),w(j,e,ne),w(j,t,ne),x&&x.m(t,null),y(t,l),y(t,o),y(o,r),y(o,a),y(o,u),y(o,c),R&&R.m(o,null),y(o,d),y(o,f),y(f,_),y(f,g),y(f,p),y(p,v),y(v,h);for(let I=0;I<q.length;I+=1)q[I]&&q[I].m(p,null);W&&W.m(p,null),be(p,n[3]),$=!0,H||(U=[M(u,"click",n[11]),M(p,"change",n[8])],H=!0)},p(j,[ne]){if(C.hasBoltPlugins&&T.p(j,ne),j[5]?x?x.p(j,ne):(x=Tt(j),x.c(),x.m(t,l)):x&&(x.d(1),x=null),L===(L=E(j))&&R?R.p(j,ne):(R&&R.d(1),R=L&&L(j),R&&(R.c(),R.m(o,d))),ne&16){D=ee(j[4]);let I;for(I=0;I<D.length;I+=1){const ae=Ct(j,D,I);q[I]?q[I].p(ae,ne):(q[I]=Ht(ae),q[I].c(),q[I].m(p,null))}for(;I<q.length;I+=1)q[I].d(1);q.length=D.length,!D.length&&W?W.p(j,ne):D.length?W&&(W.d(1),W=null):(W=It(),W.c(),W.m(p,null))}(!$||ne&1&&S!==(S=j[0].selected.user_id===null))&&(p.disabled=S),(!$||ne&24)&&be(p,j[3])},i(j){$||(A(T),$=!0)},o(j){G(T),$=!1},d(j){j&&(k(e),k(t)),T&&T.d(j),x&&x.d(),R&&R.d(),we(q,j),W&&W.d(),H=!1,le(U)}}}function ds(n,e,t){let l,o,r,i,a,u=N,c=()=>(u(),u=ot(_,H=>t(5,a=H)),_);n.$$.on_destroy.push(()=>u());let d,{config:f}=B;ue(n,f,H=>t(0,i=H));let _=null;c();function g(H,U){if(!l)return O.warn("Please log in or select a user to play.");if(!o)return O.warn("Please select a character from the select menu.");const T=F.findSession(i.selected.user_id);if(!T)return O.warn("Unable to launch game, session was not found.");const{session_id:x}=T,E=F.findAccount(T.accounts,o);if(!E)return O.warn("Unable to launch game, account was not found.");const{accountId:L,displayName:R}=E,D=C.platform===Ue.Windows,q=C.platform===Ue.Linux;switch(H){case V.osrs:switch(U){case me.official:_t(D,!0,x,L,R);break;case me.runelite:Ft(x,L,R,!1);break;case me.hdos:Hn(x,L,R);break}break;case V.rs3:q?In(x,L,R):_t(D,!1,x,L,R);break}}function p(H){const U=H.target.value;if(!l)return;const T=i.userDetails[l];T?(T.account_id=U,Pe(f,i.userDetails[l]=T,i)):Pe(f,i.userDetails[l]={account_id:U},i)}function v(H){he[H?"unshift":"push"](()=>{d=H,t(1,d)})}const h=()=>g(i.selected.game,i.selected.client);function S(){i.selected.client=rt(this),f.set(i)}const $=()=>{d.open()};return n.$$.update=()=>{var H,U;if(n.$$.dirty&1&&t(9,l=i.selected.user_id),n.$$.dirty&513&&t(3,o=(H=i.userDetails[l??""])==null?void 0:H.account_id),n.$$.dirty&1&&t(4,r=((U=F.findSession(i.selected.user_id))==null?void 0:U.accounts)??[]),n.$$.dirty&1)if(i.check_announcements){const T=`${C.env.psa_url}${i.selected.game==V.osrs?"osrs":C.env.provider}.json`;fetch(T,{method:"GET"}).then(x=>x.json()).then(x=>{c(t(2,_=x.psa&&x.psa.length>0?x.psa:null)),x.isDisabled})}else c(t(2,_=null))},[i,d,_,o,r,a,f,g,p,l,v,h,S,$]}class fs extends re{constructor(e){super(),oe(this,e,ds,us,te,{})}}function Ot(n,e,t){const l=n.slice();return l[1]=e[t].date,l[2]=e[t].severity,l[3]=e[t].content,l}function xt(n){var u;let e,t=((u=n[1])==null?void 0:u.toLocaleTimeString())+"",l,o,r=n[3]+"",i,a;return{c(){e=b("li"),l=X(t),o=X(`
				- `),i=X(r),a=P(),z(e,"text-rose-500",n[2]===Ee.error),z(e,"text-orange-700",n[2]===Ee.warn)},m(c,d){w(c,e,d),y(e,l),y(e,o),y(e,i),y(e,a)},p(c,d){var f;d&1&&t!==(t=((f=c[1])==null?void 0:f.toLocaleTimeString())+"")&&ie(l,t),d&1&&r!==(r=c[3]+"")&&ie(i,r),d&1&&z(e,"text-rose-500",c[2]===Ee.error),d&1&&z(e,"text-orange-700",c[2]===Ee.warn)},d(c){c&&k(e)}}}function ps(n){let e,t,l,o,r=ee(n[0]),i=[];for(let a=0;a<r.length;a+=1)i[a]=xt(Ot(n,r,a));return{c(){e=b("div"),t=b("div"),t.innerHTML='<img src="svgs/circle-info-solid.svg" alt="Message list icon" class="h-7 w-7 rounded-full bg-blue-500 p-[3px] duration-200"/>',l=P(),o=b("ol");for(let a=0;a<i.length;a+=1)i[a].c();m(t,"class","absolute right-6 top-2"),m(o,"id","message_list"),m(o,"class","h-full list-inside list-disc overflow-y-auto pl-5 pt-1 marker:text-blue-500"),m(e,"class","fixed bottom-0 h-1/4 w-screen border-t-2 border-t-slate-300 bg-slate-100 duration-200 dark:border-t-slate-800 dark:bg-slate-900")},m(a,u){w(a,e,u),y(e,t),y(e,l),y(e,o);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(o,null)},p(a,[u]){if(u&1){r=ee(a[0]);let c;for(c=0;c<r.length;c+=1){const d=Ot(a,r,c);i[c]?i[c].p(d,u):(i[c]=xt(d),i[c].c(),i[c].m(o,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i:N,o:N,d(a){a&&k(e),we(i,a)}}}function _s(n,e,t){let{logs:l}=e;return n.$$set=o=>{"logs"in o&&t(0,l=o.logs)},[l]}class gs extends re{constructor(e){super(),oe(this,e,_s,ps,te,{logs:0})}}function Et(n,e,t){const l=n.slice();return l[7]=e[t],l}function Ut(n,e){let t,l=e[7].user.displayName+"",o,r;return{key:n,first:null,c(){t=b("option"),o=X(l),t.__value=r=e[7].user.userId,se(t,t.__value),m(t,"class","dark:bg-slate-900"),this.first=t},m(i,a){w(i,t,a),y(t,o)},p(i,a){e=i,a&2&&l!==(l=e[7].user.displayName+"")&&ie(o,l),a&2&&r!==(r=e[7].user.userId)&&(t.__value=r,se(t,t.__value))},d(i){i&&k(t)}}}function hs(n){let e,t,l=[],o=new Map,r,i,a,u,c,d,f,_,g,p=ee(n[1]);const v=h=>h[7].user.userId;for(let h=0;h<p.length;h+=1){let S=Et(n,p,h),$=v(S);o.set($,l[h]=Ut($,S))}return{c(){e=b("select"),t=b("option"),t.textContent="Select a user";for(let h=0;h<l.length;h+=1)l[h].c();r=P(),i=b("div"),a=b("button"),a.textContent="Log In",u=P(),c=b("button"),d=X("Log Out"),t.__value=null,se(t,t.__value),t.disabled=!0,m(t,"class","dark:bg-slate-900"),m(e,"class","w-full cursor-pointer rounded-lg border-2 border-inherit bg-inherit p-2 text-center"),n[0].selected.user_id===void 0&&He(()=>n[4].call(e)),m(a,"class","mx-auto mr-2 rounded-lg bg-blue-500 p-2 font-bold text-black duration-200 hover:opacity-75"),m(c,"class","mx-auto rounded-lg border-2 border-blue-500 p-2 font-bold duration-200 hover:opacity-75"),c.disabled=f=!n[0].selected.user_id,m(i,"class","mt-5 flex")},m(h,S){w(h,e,S),y(e,t);for(let $=0;$<l.length;$+=1)l[$]&&l[$].m(e,null);be(e,n[0].selected.user_id,!0),w(h,r,S),w(h,i,S),y(i,a),y(i,u),y(i,c),y(c,d),_||(g=[M(e,"change",n[4]),M(a,"click",n[5]),M(c,"click",n[6])],_=!0)},p(h,[S]){S&2&&(p=ee(h[1]),l=dn(l,S,v,1,h,p,o,e,un,Ut,null,Et)),S&3&&be(e,h[0].selected.user_id),S&3&&f!==(f=!h[0].selected.user_id)&&(c.disabled=f)},i:N,o:N,d(h){h&&(k(e),k(r),k(i));for(let S=0;S<l.length;S+=1)l[S].d();_=!1,le(g)}}}function ms(n,e,t){let l,o;const{sessions:r,config:i}=B;ue(n,r,d=>t(1,o=d)),ue(n,i,d=>t(0,l=d));function a(){l.selected.user_id=rt(this),i.set(l)}return[l,o,r,i,a,()=>{const{origin:d,redirect:f,clientid:_}=C.env;ce.openLoginWindow(d,f,_)},async()=>{l.selected.user_id&&(await F.logout(l.selected.user_id),F.saveCredentials())}]}class bs extends re{constructor(e){super(),oe(this,e,ms,hs,te,{})}}function ks(n,{callback:e,ignore:t=[]}){const l=o=>{const r=t.some(i=>i.contains(o.target));n&&!n.contains(o.target)&&!o.defaultPrevented&&!r&&e()};return document.addEventListener("click",l,!0),document.addEventListener("contextmenu",l,!0),{destroy(){document.removeEventListener("click",l,!0),document.removeEventListener("contextmenu",l,!0)}}}const ws=n=>({}),Nt=n=>({});function Mt(n){let e,t,l,o,r,i;const a=n[9].content,u=We(a,n,n[8],Nt);return{c(){e=b("div"),u&&u.c(),m(e,"class",t="dropdown-color absolute z-20 rounded-lg border-2 "+n[1]+" "+n[2]+" svelte-xifudk")},m(c,d){w(c,e,d),u&&u.m(e,null),o=!0,r||(i=Qt(l=ks.call(null,e,{callback:n[3],ignore:[n[5]]})),r=!0)},p(c,d){u&&u.p&&(!o||d&256)&&ze(u,a,c,c[8],o?Ve(a,c[8],d,ws):Ze(c[8]),Nt),(!o||d&6&&t!==(t="dropdown-color absolute z-20 rounded-lg border-2 "+c[1]+" "+c[2]+" svelte-xifudk"))&&m(e,"class",t),l&&Je(l.update)&&d&32&&l.update.call(null,{callback:c[3],ignore:[c[5]]})},i(c){o||(A(u,c),o=!0)},o(c){G(u,c),o=!1},d(c){c&&k(e),u&&u.d(c),r=!1,i()}}}function ys(n){let e,t,l,o,r,i,a;const u=n[9].default,c=We(u,n,n[8],null);let d=n[4]&&Mt(n);return{c(){e=b("div"),t=b("button"),c&&c.c(),l=P(),d&&d.c(),m(e,"class",o="relative h-fit w-fit "+n[0]+" svelte-xifudk")},m(f,_){w(f,e,_),y(e,t),c&&c.m(t,null),n[10](t),y(e,l),d&&d.m(e,null),r=!0,i||(a=M(t,"click",n[6]),i=!0)},p(f,[_]){c&&c.p&&(!r||_&256)&&ze(c,u,f,f[8],r?Ve(u,f[8],_,null):Ze(f[8]),null),f[4]?d?(d.p(f,_),_&16&&A(d,1)):(d=Mt(f),d.c(),A(d,1),d.m(e,null)):d&&(je(),G(d,1,1,()=>{d=null}),Ae()),(!r||_&1&&o!==(o="relative h-fit w-fit "+f[0]+" svelte-xifudk"))&&m(e,"class",o)},i(f){r||(A(c,f),A(d),r=!0)},o(f){G(c,f),G(d),r=!1},d(f){f&&k(e),c&&c.d(f),n[10](null),d&&d.d(),i=!1,a()}}}function vs(n,e,t){let{$$slots:l={},$$scope:o}=e,{class:r=""}=e,{position:i="bottom"}=e,{align:a="start"}=e,u=!1,c;function d(){t(4,u=!0)}function f(){t(4,u=!1)}function _(){u?f():d()}function g(p){he[p?"unshift":"push"](()=>{c=p,t(5,c)})}return n.$$set=p=>{"class"in p&&t(0,r=p.class),"position"in p&&t(1,i=p.position),"align"in p&&t(2,a=p.align),"$$scope"in p&&t(8,o=p.$$scope)},[r,i,a,f,u,c,_,d,o,l,g]}class $s extends re{constructor(e){super(),oe(this,e,vs,ys,te,{class:0,position:1,align:2,open:7,close:3})}get open(){return this.$$.ctx[7]}get close(){return this.$$.ctx[3]}}function Ss(n){let e,t,l,o,r,i,a,u;return{c(){e=b("button"),e.innerHTML=`<div class="flex"><img src="svgs/database-solid.svg" alt="Browse app data" class="mr-2 h-7 w-7 rounded-lg bg-violet-500 p-1"/>
		Browse App Data</div>`,t=P(),l=b("div"),o=b("label"),o.textContent="Check game announcements:",r=P(),i=b("input"),m(e,"id","data_dir_button"),m(e,"class","p-2 hover:opacity-75"),m(o,"for","check_announcements"),m(i,"id","check_announcements"),m(i,"type","checkbox"),m(i,"class","ml-2"),m(l,"class","mx-auto p-2")},m(c,d){w(c,e,d),w(c,t,d),w(c,l,d),y(l,o),y(l,r),y(l,i),i.checked=n[0].check_announcements,a||(u=[M(e,"click",n[3]),M(i,"change",n[4])],a=!0)},p(c,[d]){d&1&&(i.checked=c[0].check_announcements)},i:N,o:N,d(c){c&&(k(e),k(t),k(l)),a=!1,le(u)}}}function Ls(n,e,t){let l;function o(){var u=new XMLHttpRequest;u.open("GET","/browse-data"),u.onreadystatechange=()=>{u.readyState==4&&O.info(`Browse status: '${u.responseText.trim()}'`)},u.send()}const{config:r}=B;ue(n,r,u=>t(0,l=u));const i=()=>{o()};function a(){l.check_announcements=this.checked,r.set(l)}return[l,o,r,i,a]}class Cs extends re{constructor(e){super(),oe(this,e,Ls,Ss,te,{})}}function Rs(n){let e,t,l,o,r,i,a,u,c,d,f,_,g,p,v,h,S,$,H;return{c(){var U,T;e=b("button"),t=b("div"),t.innerHTML=`<img src="svgs/wrench-solid.svg" alt="Configure RuneLite" class="mr-2 h-7 w-7 rounded-lg bg-pink-500 p-1"/>
		Configure RuneLite`,o=P(),r=b("div"),i=b("label"),i.textContent="Use custom RuneLite JAR:",a=P(),u=b("input"),c=P(),d=b("div"),f=b("textarea"),g=P(),p=b("br"),v=P(),h=b("button"),S=X("Select File"),m(t,"class","flex"),e.disabled=l=!((U=n[0])!=null&&U.session_id)||!((T=n[3])!=null&&T.accountId),m(e,"class","p-2 pb-5 hover:opacity-75"),m(i,"for","use_custom_jar"),m(u,"id","use_custom_jar"),m(u,"type","checkbox"),m(u,"class","ml-2"),m(r,"class","mx-auto border-t-2 border-slate-300 p-2 pt-5 dark:border-slate-800"),m(f,"class","h-10 rounded border-2 border-slate-300 bg-slate-100 text-slate-950 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),f.disabled=_=!n[1].runelite_use_custom_jar,m(h,"class","mt-1 rounded-lg border-2 border-blue-500 p-1 duration-200 hover:opacity-75"),h.disabled=n[2],m(d,"class","mx-auto p-2"),z(d,"opacity-25",!n[1].runelite_use_custom_jar)},m(U,T){w(U,e,T),y(e,t),w(U,o,T),w(U,r,T),y(r,i),y(r,a),y(r,u),u.checked=n[1].runelite_use_custom_jar,w(U,c,T),w(U,d,T),y(d,f),se(f,n[1].runelite_custom_jar),y(d,g),y(d,p),y(d,v),y(d,h),y(h,S),$||(H=[M(e,"click",n[7]),M(u,"change",n[8]),M(f,"input",n[9]),M(h,"click",n[10])],$=!0)},p(U,[T]){var x,E;T&9&&l!==(l=!((x=U[0])!=null&&x.session_id)||!((E=U[3])!=null&&E.accountId))&&(e.disabled=l),T&2&&(u.checked=U[1].runelite_use_custom_jar),T&2&&_!==(_=!U[1].runelite_use_custom_jar)&&(f.disabled=_),T&2&&se(f,U[1].runelite_custom_jar),T&4&&(h.disabled=U[2]),T&2&&z(d,"opacity-25",!U[1].runelite_use_custom_jar)},i:N,o:N,d(U){U&&(k(e),k(o),k(r),k(c),k(d)),$=!1,le(H)}}}function Ts(n,e,t){let l,o,r;const{config:i}=B;ue(n,i,p=>t(1,r=p));let a=!1;async function u(){t(2,a=!0),Pe(i,r.runelite_custom_jar=await F.openFilePicker(),r),console.log("done picking"),t(2,a=!1)}function c(){!(l!=null&&l.session_id)||!(o!=null&&o.accountId)||!(o!=null&&o.displayName)||Ft(l.session_id,o.accountId,o.displayName,!0)}const d=()=>c();function f(){r.runelite_use_custom_jar=this.checked,i.set(r)}function _(){r.runelite_custom_jar=this.value,i.set(r)}const g=()=>{u()};return n.$$.update=()=>{var p;n.$$.dirty&2&&t(0,l=F.findSession(r.selected.user_id)),n.$$.dirty&3&&t(3,o=F.findAccount((l==null?void 0:l.accounts)??[],(p=r.userDetails[r.selected.user_id??""])==null?void 0:p.account_id))},[l,r,a,o,i,u,c,d,f,_,g]}class Ps extends re{constructor(e){super(),oe(this,e,Ts,Rs,te,{})}}function Is(n){let e,t,l,o,r,i;return{c(){e=b("div"),t=b("label"),t.textContent="Enable Bolt plugin loader:",l=P(),o=b("input"),m(t,"for","enable_plugins"),m(o,"type","checkbox"),m(o,"name","enable_plugins"),m(o,"id","enable_plugins"),m(o,"class","ml-2"),m(e,"class","mx-auto p-2")},m(a,u){w(a,e,u),y(e,t),y(e,l),y(e,o),o.checked=n[0].rs_plugin_loader,r||(i=M(o,"change",n[2]),r=!0)},p(a,u){u&1&&(o.checked=a[0].rs_plugin_loader)},d(a){a&&k(e),r=!1,i()}}}function Hs(n){let e,t,l,o,r,i,a,u,c,d,f,_=C.hasBoltPlugins&&Is(n);return{c(){_&&_.c(),e=P(),t=b("div"),l=b("label"),l.textContent="Use custom config URI:",o=P(),r=b("input"),i=P(),a=b("div"),u=b("textarea"),m(l,"for","use_custom_uri"),m(r,"id","use_custom_uri"),m(r,"type","checkbox"),m(r,"class","ml-2"),m(t,"class","mx-auto p-2"),m(u,"class","rounded border-2 border-slate-300 bg-slate-100 text-slate-950 disabled:opacity-50 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-50"),u.disabled=c=!n[0].use_custom_rs_config_uri,m(u,"rows","4"),m(u,"placeholder",C.env.default_config_uri),m(a,"class","p-2")},m(g,p){_&&_.m(g,p),w(g,e,p),w(g,t,p),y(t,l),y(t,o),y(t,r),r.checked=n[0].use_custom_rs_config_uri,w(g,i,p),w(g,a,p),y(a,u),se(u,n[0].rs_config_uri),d||(f=[M(r,"change",n[3]),M(u,"input",n[4])],d=!0)},p(g,[p]){C.hasBoltPlugins&&_.p(g,p),p&1&&(r.checked=g[0].use_custom_rs_config_uri),p&1&&c!==(c=!g[0].use_custom_rs_config_uri)&&(u.disabled=c),p&1&&se(u,g[0].rs_config_uri)},i:N,o:N,d(g){g&&(k(e),k(t),k(i),k(a)),_&&_.d(g),d=!1,le(f)}}}function Os(n,e,t){let l;const{config:o}=B;ue(n,o,u=>t(0,l=u));function r(){l.rs_plugin_loader=this.checked,o.set(l)}function i(){l.use_custom_rs_config_uri=this.checked,o.set(l)}function a(){l.rs_config_uri=this.value,o.set(l)}return[l,o,r,i,a]}class xs extends re{constructor(e){super(),oe(this,e,Os,Hs,te,{})}}function Es(n){let e,t;return e=new xs({}),{c(){Q(e.$$.fragment)},m(l,o){Y(e,l,o),t=!0},i(l){t||(A(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function Us(n){let e,t;return e=new Ps({}),{c(){Q(e.$$.fragment)},m(l,o){Y(e,l,o),t=!0},i(l){t||(A(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function Ns(n){let e,t;return e=new Cs({}),{c(){Q(e.$$.fragment)},m(l,o){Y(e,l,o),t=!0},i(l){t||(A(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function Ms(n){let e,t,l,o,r,i,a,u,c,d,f,_,g,p,v,h,S,$,H,U;const T=[Ns,Us,Es],x=[];function E(L,R){return L[1]==L[2].general?0:L[1]==L[2].osrs?1:L[1]==L[2].rs3?2:-1}return~(h=E(n))&&(S=x[h]=T[h](n)),{c(){e=b("div"),t=b("div"),l=b("button"),o=X("General"),i=P(),a=b("button"),u=X("OSRS"),d=P(),f=b("button"),_=X("RS3"),p=P(),v=b("div"),S&&S.c(),m(l,"class",r=n[1]===n[2].general?Se:Le),m(a,"class",c=n[1]===n[2].osrs?Se:Le),m(f,"class",g=n[1]===n[2].rs3?Se:Le),m(t,"class","flex flex-col items-center gap-2 border-r-2 border-slate-300 pt-10 dark:border-slate-800"),m(v,"class","col-span-3 p-5 pt-10 text-center"),m(e,"class","grid h-full grid-cols-4")},m(L,R){w(L,e,R),y(e,t),y(t,l),y(l,o),y(t,i),y(t,a),y(a,u),y(t,d),y(t,f),y(f,_),y(e,p),y(e,v),~h&&x[h].m(v,null),$=!0,H||(U=[M(l,"click",n[4]),M(a,"click",n[5]),M(f,"click",n[6])],H=!0)},p(L,R){(!$||R&2&&r!==(r=L[1]===L[2].general?Se:Le))&&m(l,"class",r),(!$||R&2&&c!==(c=L[1]===L[2].osrs?Se:Le))&&m(a,"class",c),(!$||R&2&&g!==(g=L[1]===L[2].rs3?Se:Le))&&m(f,"class",g);let D=h;h=E(L),h!==D&&(S&&(je(),G(x[D],1,1,()=>{x[D]=null}),Ae()),~h?(S=x[h],S||(S=x[h]=T[h](L),S.c()),A(S,1),S.m(v,null)):S=null)},i(L){$||(A(S),$=!0)},o(L){G(S),$=!1},d(L){L&&k(e),~h&&x[h].d(),H=!1,le(U)}}}function js(n){let e,t,l={class:"h-3/4 w-3/4 select-none",$$slots:{default:[Ms]},$$scope:{ctx:n}};return e=new at({props:l}),n[7](e),{c(){Q(e.$$.fragment)},m(o,r){Y(e,o,r),t=!0},p(o,[r]){const i={};r&258&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(A(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){n[7](null),K(e,o)}}}let Se="border-2 border-blue-500 bg-blue-500 hover:opacity-75 font-bold text-black duration-200 rounded-lg p-1 w-3/4",Le="border-2 border-blue-500 hover:opacity-75 duration-200 rounded-lg p-1 w-3/4";function As(n,e,t){let l;function o(){l.open()}var r=(f=>(f[f.general=0]="general",f[f.osrs=1]="osrs",f[f.rs3=2]="rs3",f))(r||{});let i=1;const a=()=>{t(1,i=r.general)},u=()=>{t(1,i=r.osrs)},c=()=>{t(1,i=r.rs3)};function d(f){he[f?"unshift":"push"](()=>{l=f,t(0,l)})}return[l,i,r,o,a,u,c,d]}class Ds extends re{constructor(e){super(),oe(this,e,As,js,te,{open:3})}get open(){return this.$$.ctx[3]}}function qs(n){const e=n.slice(),t=F.findSession(e[1].selected.user_id??"");return e[11]=t,e}function Bs(n){let e,t,l;return{c(){e=b("button"),e.textContent="Login",m(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit p-2 text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(o,r){w(o,e,r),t||(l=M(e,"click",n[10]),t=!0)},p:N,i:N,o:N,d(o){o&&k(e),t=!1,l()}}}function Gs(n){let e,t;return e=new $s({props:{align:"center",$$slots:{content:[Fs],default:[Xs]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},m(l,o){Y(e,l,o),t=!0},p(l,o){const r={};o&4098&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){t||(A(e.$$.fragment,l),t=!0)},o(l){G(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function Xs(n){var o;let e,t=(((o=n[11])==null?void 0:o.user.displayName)??"No user selected")+"",l;return{c(){e=b("button"),l=X(t),m(e,"class","h-11 w-48 rounded-lg border-2 border-slate-300 bg-inherit text-center font-bold text-black duration-200 hover:opacity-75 dark:border-slate-800 dark:text-slate-50")},m(r,i){w(r,e,i),y(e,l)},p(r,i){var a;i&2&&t!==(t=(((a=r[11])==null?void 0:a.user.displayName)??"No user selected")+"")&&ie(l,t)},d(r){r&&k(e)}}}function Fs(n){let e,t,l;return t=new bs({}),{c(){e=b("div"),Q(t.$$.fragment),m(e,"slot","content"),m(e,"class","w-40")},m(o,r){w(o,e,r),Y(t,e,null),l=!0},p:N,i(o){l||(A(t.$$.fragment,o),l=!0)},o(o){G(t.$$.fragment,o),l=!1},d(o){o&&k(e),K(t)}}}function Js(n){let e,t,l,o,r,i,a,u,c,d,f,_,g,p,v,h,S,$,H={};e=new Ds({props:H}),n[5](e);const U=[Gs,Bs],T=[];function x(L,R){return L[2].length>0?0:1}function E(L,R){return R===0?qs(L):L}return p=x(n),v=T[p]=U[p](E(n,p)),{c(){Q(e.$$.fragment),t=P(),l=b("div"),o=b("div"),r=b("button"),r.textContent="RS3",i=P(),a=b("button"),a.textContent="OSRS",u=P(),c=b("div"),d=b("button"),d.innerHTML='<img src="svgs/lightbulb-solid.svg" class="m-auto h-6 w-6" alt="Change Theme"/>',f=P(),_=b("button"),_.innerHTML='<img src="svgs/gear-solid.svg" class="m-auto h-6 w-6" alt="Settings"/>',g=P(),v.c(),m(r,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 p-2 duration-200 hover:opacity-75"),z(r,"text-black",n[1].selected.game===V.rs3),z(r,"bg-blue-500",n[1].selected.game===V.rs3),m(a,"class","mx-1 w-20 rounded-lg border-2 border-blue-500 bg-blue-500 p-2 text-black duration-200 hover:opacity-75"),z(a,"text-black",n[1].selected.game===V.osrs),z(a,"bg-blue-500",n[1].selected.game===V.osrs),m(o,"class","m-3 ml-9 font-bold"),m(d,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),m(_,"class","h-10 w-10 rounded-full bg-blue-500 text-center duration-200 hover:rotate-45 hover:opacity-75"),m(c,"class","m-2 ml-auto flex gap-2"),m(l,"class","fixed top-0 flex h-16 w-screen border-b-2 border-slate-300 bg-slate-100 duration-200 dark:border-slate-800 dark:bg-slate-900")},m(L,R){Y(e,L,R),w(L,t,R),w(L,l,R),y(l,o),y(o,r),y(o,i),y(o,a),y(l,u),y(l,c),y(c,d),y(c,f),y(c,_),y(c,g),T[p].m(c,null),h=!0,S||($=[M(r,"click",n[6]),M(a,"click",n[7]),M(d,"click",n[8]),M(_,"click",n[9])],S=!0)},p(L,[R]){const D={};e.$set(D),(!h||R&2)&&z(r,"text-black",L[1].selected.game===V.rs3),(!h||R&2)&&z(r,"bg-blue-500",L[1].selected.game===V.rs3),(!h||R&2)&&z(a,"text-black",L[1].selected.game===V.osrs),(!h||R&2)&&z(a,"bg-blue-500",L[1].selected.game===V.osrs);let q=p;p=x(L),p===q?T[p].p(E(L,p),R):(je(),G(T[q],1,1,()=>{T[q]=null}),Ae(),v=T[p],v?v.p(E(L,p),R):(v=T[p]=U[p](E(L,p)),v.c()),A(v,1),v.m(c,null))},i(L){h||(A(e.$$.fragment,L),A(v),h=!0)},o(L){G(e.$$.fragment,L),G(v),h=!1},d(L){L&&(k(t),k(l)),n[5](null),K(e,L),T[p].d(),S=!1,le($)}}}function Ws(n,e,t){let l,o;const{config:r,sessions:i}=B;ue(n,r,p=>t(1,l=p)),ue(n,i,p=>t(2,o=p));let a;function u(p){he[p?"unshift":"push"](()=>{a=p,t(0,a)})}return[a,l,o,r,i,u,()=>{Pe(r,l.selected.game=V.rs3,l)},()=>{Pe(r,l.selected.game=V.osrs,l)},()=>Pe(r,l.use_dark_theme=!l.use_dark_theme,l),()=>a.open(),()=>{const{origin:p,redirect:v,clientid:h}=C.env;ce.openLoginWindow(p,v,h)}]}class Vs extends re{constructor(e){super(),oe(this,e,Ws,Js,te,{})}}function zs(n){let e,t,l,o,r,i,a,u,c,d,f,_,g;return e=new Pn({}),l=new Vs({}),u=new fs({}),_=new gs({props:{logs:n[0]}}),{c(){Q(e.$$.fragment),t=P(),Q(l.$$.fragment),o=P(),r=b("div"),i=b("div"),a=P(),Q(u.$$.fragment),c=P(),d=b("div"),f=P(),Q(_.$$.fragment),m(r,"class","mt-16 grid h-full grid-flow-col grid-cols-3")},m(p,v){Y(e,p,v),w(p,t,v),Y(l,p,v),w(p,o,v),w(p,r,v),y(r,i),y(r,a),Y(u,r,null),y(r,c),y(r,d),w(p,f,v),Y(_,p,v),g=!0},p(p,v){const h={};v&1&&(h.logs=p[0]),_.$set(h)},i(p){g||(A(e.$$.fragment,p),A(l.$$.fragment,p),A(u.$$.fragment,p),A(_.$$.fragment,p),g=!0)},o(p){G(e.$$.fragment,p),G(l.$$.fragment,p),G(u.$$.fragment,p),G(_.$$.fragment,p),g=!1},d(p){p&&(k(t),k(o),k(r),k(f)),K(e,p),K(l,p),K(u),K(_,p)}}}function Zs(n){let e,t,l,o;return e=new Xt({props:{$$slots:{default:[zs]},$$scope:{ctx:n}}}),{c(){Q(e.$$.fragment)},m(r,i){Y(e,r,i),t=!0,l||(o=M(window,"beforeunload",n[2]),l=!0)},p(r,[i]){const a={};i&9&&(a.$$scope={dirty:i,ctx:r}),e.$set(a)},i(r){t||(A(e.$$.fragment,r),t=!0)},o(r){G(e.$$.fragment,r),t=!1},d(r){K(e,r),l=!1,o()}}}function Ys(n,e,t){let l;const o=O.logs;return ue(n,o,i=>t(0,l=i)),[l,o,()=>F.saveConfig()]}class Ks extends re{constructor(e){super(),oe(this,e,Ys,Zs,te,{})}}const jt={target:document.getElementById("app")};window.opener||window.location.search.includes("&id_token")?new $n(jt):(Qs(),mn(),el(),tl(),new Ks(jt));function Qs(){const n=new URLSearchParams(window.location.search);C.platform=n.get("platform"),C.isFlathub=n.get("flathub")==="1",C.rs3DebInstalledHash=n.get("rs3_deb_installed_hash"),C.rs3ExeInstalledHash=n.get("rs3_exe_installed_hash"),C.rs3AppInstalledHash=n.get("rs3_app_installed_hash"),C.osrsExeInstalledHash=n.get("osrs_exe_installed_hash"),C.osrsAppInstalledHash=n.get("osrs_app_installed_hash"),C.runeLiteInstalledId=n.get("runelite_installed_id"),C.hdosInstalledVersion=n.get("hdos_installed_version");const e=n.get("plugins");if(C.hasBoltPlugins=e!==null,e!==null)try{C.pluginList=JSON.parse(e)}catch{O.error("Unable to parse plugin list")}const t=n.get("credentials");if(t)try{const l=JSON.parse(t),o=l.every(r=>typeof r.session_id=="string"&&typeof r.tokens=="object"&&typeof r.accounts=="object"&&typeof r.user=="object");o?B.sessions.set(l):(B.sessions.set([]),F.saveCredentials(),O.warn("Credentials saved on disk are out of date. Please sign in again.")),B.sessions.set(o?l:[])}catch{B.sessions.set([]),F.saveCredentials(),O.error("Unable to parse saved credentials. Please sign in again.")}}function el(){const{origin:n,origin_2fa:e}=C.env,t=[window.location.origin,n,e];let l=null;window.addEventListener("message",async o=>{var r;if(!t.includes(o.origin)){O.info(`discarding window message from origin ${o.origin}`);return}switch(o.data.type){case"authTokenUpdate":{l=o.data.tokens;break}case"authSessionUpdate":{if(l===null)return O.error("auth is null. Please try again.");const i=o.data.sessionId,a=await F.login(l,i);a.ok?O.info(`Added new user '${a.value.user.displayName}'`):O.error(`Unable to add new user. Please try again. ${a.error}`),F.saveCredentials(),ce.pendingLoginWindow=null,l=null;break}case"authFailed":{O.error(`Unable to authenticate: ${o.data.reason}`),ce.pendingLoginWindow=null,l=null;break}case"externalUrl":{const i=new XMLHttpRequest;i.onreadystatechange=()=>{i.readyState==4&&O.info(`External URL status: '${i.responseText.trim()}'`)},i.open("POST","/open-external-url",!0),i.send(o.data.url);break}case"gameClientList":Gt.set(o.data.clients);break;default:{const i=((r=o.data)==null?void 0:r.type)??"no type provided";O.info(`Unknown message type: ${i}`);break}}})}async function tl(){const n=pe(B.sessions),e=[];for(const t of n){const l=await ce.refreshOAuthToken(t.tokens);if(!l.ok){l.error===0?O.error(`Unable to verify saved login, status: ${l.error}. Do you have an internet connection? Please relaunch Bolt to try again.`):(O.error(`Discarding expired login, status: ${l.error}. Please sign in again.`),e.push(t.tokens.sub));continue}const o=l.value;t.tokens=o;const r=await F.login(o,t.session_id);r.ok?O.info(`Signed into saved user '${r.value.user.displayName}'`):(O.error(`Unable to sign into saved user '${t.user.displayName}' - please sign in again. ${r.error}`),e.push(t.tokens.sub))}e.forEach(t=>{F.logout(t)}),B.sessions.set(n),F.saveCredentials()}
